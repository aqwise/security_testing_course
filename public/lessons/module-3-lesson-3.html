<a id="header"></a><a id="content"></a><a id="Xbf608adcdc9284e4ffc03aa8f282e5eb3d091e9"></a><h1>Модуль III, Урок 3: Атаки на контроль доступа</h1><a id="оглавление"></a><h2>Оглавление</h2><ul><li><a href="#теория">Теория</a></li><li><a href="#демонстрация">Демонстрация</a></li><li><a href="#практика-с-portswigger">Практика с PortSwigger</a></li><li><a href="#тест">Тест</a></li></ul><a id="теория"></a><h2>Теория</h2><p><strong>Контроль доступа</strong> – это механизм, определяющий, какие действия и ресурсы разрешены для конкретных пользователей. Он работает на основе аутентификации (определения личности пользователя) и управления сессиями (отслеживания пользователя между запросами). После того как приложение <em>знает</em>, кто вы, и поддерживает вашу сессию, задача контроля доступа – решить, <strong>что вам позволено делать</strong> и <strong>к чему вы можете обращаться</strong>.</p><a id="типы-уязвимостей-контроля-доступа"></a><h3>Типы уязвимостей контроля доступа</h3><p>Контроль доступа делится на три категории: <strong>вертикальный</strong>, <strong>горизонтальный</strong> и <strong>контекстно-зависимый</strong> (бизнес-логический):</p><ul><li><strong>Вертикальный контроль доступа</strong> разделяет права между разными уровнями пользователей (например, обычный пользователь vs. администратор). Вертикальное нарушение – это <em>повышение привилегий</em>: ситуация, когда пользователь получает доступ к функциям, не предназначенным для его роли. Например, если обычный пользователь может открыть административную страницу и удалить учетные записи, это вертикальное повышение привилегий.</li><li><strong>Горизонтальный контроль доступа</strong> ограничивает каждого пользователя набором объектов одного типа. Пользователю разрешено работать только со <em>своими</em> данными (письмами, счетами, заказами и т.п.). Горизонтальное нарушение – это <em>обход ограничений по горизонтали</em>: когда пользователь получает доступ к ресурсам <em>другого</em> пользователя на том же уровне. Например, если клиент банка может видеть баланс чужого счета, или пользователь почты читает чужие письма – это горизонтальное повышение привилегий.</li><li><strong>Контекстно-зависимый (бизнес-логический) контроль доступа</strong> учитывает состояние приложения или последовательность действий. Он гарантирует правильный <em>порядок</em> операций. Нарушение здесь позволяет обойти бизнес-логику приложения – например, пройти шаги процесса не в том порядке или пропустить важный этап. Классический пример: злоумышленник обходит этап оплаты в интернет-магазине и получает товар бесплатно.</li></ul><p><strong>Замечание:</strong> Все три типа уязвимостей сводятся к одному: <strong>пользователь делает то, что не должен иметь возможности сделать</strong>. Различаются только сценарии и методы эксплуатации.</p><p>Нарушение контроля доступа может иметь каскадный эффект. Например, удачная <em>горизонтальная</em> атака часто ведет к <em>вертикальной</em>: получив доступ к чужой учетной записи, злоумышленник может взять на прицел аккаунт с повышенными правами. Классический случай – сначала через уязвимость доступа сменить пароль другого пользователя, а затем захватить учетную запись администратора.</p><p>Наихудшая ситуация – когда <strong>неаутентифицированный</strong> (гость) может получить доступ к привилегированным функциям. Такие критические сбои контроля доступа встречаются реже, но приводят к полному компромету системы.</p><a id="X1c624917fae3daf2f32d30c85f6c1521df17b93"></a><h3>Распространённые уязвимости и ошибки реализации</h3><p>Большинство проблем с контролем доступа возникают из-за ошибок разработчиков при внедрении проверок. Ниже перечислены распространённые уязвимости контроля доступа:</p><ul><li><strong>Полностью незащищённая функциональность.</strong> В приложении есть <em>скрытые</em> разделы (например, админ-панель), которые не отображаются обычным пользователям, но <em>никак не защищены</em> на сервере. Например, административные страницы доступны по прямому URL всем желающим. Если злоумышленник узнает или угадает адрес (/admin, /administrator-panel и т.п.), он получит к ним доступ. Разработчики могут попытаться <em>спрятать</em> такие страницы (security through obscurity), например дать им нестандартный URL и не показывать ссылки. Однако это слабая мера: URL можно обнаружить в коде (например, в файлах robots.txt или скриптах интерфейса) или подобрать перебором. <strong>Пример:</strong> Файл robots.txt может содержать строку Disallow: /admin – этот запрет для поисковых ботов невольно раскрывает путь к админ-разделу<a href="https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality#:~:text=">[1]</a>.</li><li><strong>Функции, основанные на идентификаторах.</strong> Сюда относятся уязвимости типа <strong>IDOR (Insecure Direct Object Reference)</strong> – когда приложение использует переданный от клиента идентификатор ресурса (ID объекта) без надлежащей проверки прав. Если идентификатор предсказуемый или известный, злоумышленник может подставить чужой ID и получить доступ к чужим данным. <strong>Пример:</strong> Пользователь переходит по адресу /profile?user_id=123 для просмотра своего профиля. Если заменить 123 на 124, приложение покажет профиль другого пользователя – значит, горизонтальный контроль отсутствует. Подобные уязвимости часто встречаются в API и URL, принимающих номера счетов, id документов, имена файлов и т.д.</li><li><strong>Многоэтапные процессы без полноценных проверок.</strong> Многие ключевые действия реализованы через несколько шагов (пошаговые мастера, процедуры с подтверждением). Уязвимость возникает, если разработчики проверяют права <em>только на одних шагах</em>, предположив, что до завершающего шага пользователь дойдет легитимно. Злоумышленник может пропустить начальные шаги и отправить запрос непосредственно на финальный URL, минуя проверки. <strong>Пример:</strong> В приложении есть админ-функция «Повысить права пользователя», которая реализована в 2 шага: (1) выбрать пользователя и (2) подтвердить действие. Если проверка «администратор ли это?» сделана только на шаге 1, но не дублируется на шаге 2, то обычный пользователь может напрямую вызвать запрос подтверждения с нужными параметрами и повысить себе роль<a href="https://portswigger.net/web-security/access-control#:~:text=Sometimes%2C%20a%20website%20will%20implement,step%20with%20the%20required%20parameters">[2]</a><a href="https://portswigger.net/web-security/access-control#:~:text=administrative%20page%20at%20,then%20the%20request%20is%20allowed">[3]</a>.</li><li><strong>Незащищённые статические ресурсы.</strong> Статичные файлы (документы, изображения, отчёты и пр.), лежащие на сервере, зачастую отдаются веб-сервером напрямую, обходя логику приложения. Если URL статического контента угадываемый, злоумышленник может скачать чужой ресурс без проверки доступа. <strong>Пример:</strong> После покупки книги приложение перенаправляет пользователя на https://site.com/download/9780123456789.pdf. Если сервер не проверяет права доступа, зная шаблон (например, ISBN книги), атакующий может перебором скачать все книги издательства<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BA%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%20%D0%BA%D0%BD%D0%B8%D0%B3%20%D0%B8%20%D0%BF%D0%BE%D0%BA%D1%83%D0%BF%D0%B0%D1%82%D1%8C%20%D1%8D%D0%BB%D0%B5%D0%BA%D1%82%D1%80%D0%BE%D0%BD%D0%BD%D1%8B%D0%B5,%D0%92%20%D0%B4%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B5%20%D0%B8%D0%BC%D1%8F%20%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0">[4]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%2C%20%D0%B8%20%D1%87%D1%82%D0%BE%20%D0%BB%D1%8E%D0%B1%D0%BE%D0%B9%2C%20%D0%BA%D1%82%D0%BE,%D1%84%D0%B0%D0%B9%D0%BB%D0%B0%D0%BC%20%D0%B8%20%D0%B4%D1%80%D1%83%D0%B3%D0%B8%D0%BC%20%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%BC">[5]</a>. Решение – либо перенести выдачу файла в код приложения с проверкой, либо настроить веб-сервер так, чтобы защищать папку с файлами (напр. с помощью авторизации или привязки к сессии).</li><li><strong>Ошибки конфигурации платформы.</strong> Некоторые приложения полагаются на средства веб-сервера или фреймворка для контроля доступа (например, настроены правила, какие URL доступны ролям). Если эти правила неполны или несовершенны, их можно обойти. Возможные ошибки:</li><li><em>Неполный учет HTTP-методов.</em> Например, запретить метод POST на /admin/deleteUser для неролей, но не запретить GET. Если приложение (или платформа) не различает методы, то отправив запрос как GET /admin/deleteUser?..., злоумышленник обойдет запрет<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9A%D0%B0%D0%BA%20%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BE%20%D0%B2%20%D0%93%D0%BB%D0%B0%D0%B2%D0%B5%203%2C,%D1%8D%D1%82%D0%BE%D1%82%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%2C%20%D0%BE%D1%82%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%B2%20%D1%82%D0%BE%D1%82%20%D0%B6%D0%B5">[6]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BD%D0%B5%D1%81%D0%B0%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC%D1%83%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D1%83,%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B5%20%D0%B4%D0%BB%D1%8F%20%D0%BD%D0%B5%D1%81%D0%B0%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8">[7]</a>. Более того, HEAD-запросы часто обрабатываются так же, как GET (но без тела ответа). Злоумышленник может воспользоваться методами HEAD или даже выдуманным методом (POSTX) – некоторые сервера в ответ на неизвестный метод все равно вызовут обработчик GET. Таким образом можно обойти ограничения на методы<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%A7%D1%82%D0%BE%20%D0%BD%D0%B0%20%D0%BF%D0%B5%D1%80%D0%B2%D1%8B%D0%B9%20%D0%B2%D0%B7%D0%B3%D0%BB%D1%8F%D0%B4%20%D0%B5%D1%89%D0%B5,%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D1%8B%20%D1%87%D0%B0%D1%81%D1%82%D0%BE">[8]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%92%20%D0%BD%D0%B5%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D1%85%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D1%8F%D1%85%20%D0%BF%D0%BB%D0%B0%D1%82%D1%84%D0%BE%D1%80%D0%BC%D1%8B%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D1%8E%D1%82,%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B5%20%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%BD%D0%B5%D0%B4%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%20HTTP">[9]</a>.</li><li><em>Несоответствие правил и реальных URL.</em> Если механизм контроля сопоставляет URL строго, а приложение принимает разные варианты, возможны расхождения. Например, приложение может считать /Admin/Panel эквивалентом /admin/panel (игнорируя регистр или слэш на конце), а модуль контроля – нет. Тогда запрос с нестандартным написанием может миновать защиту<a href="https://portswigger.net/web-security/access-control#:~:text=,matching%20discrepancies">[10]</a><a href="https://portswigger.net/web-security/access-control#:~:text=enabled%20the%20,option%20is%20enabled%20by%20default">[11]</a>.</li><li><em>Специальные заголовки.</em> Некоторые веб-серверы/фреймворки поддерживают нестандартные заголовки (X-Original-URL, X-Rewrite-URL), позволяющие переопределить URL запроса. Если контроль доступа смотрит только на исходный путь, а приложение реально обрабатывает путь из заголовка, атакующий добавит заголовок и обойдет правило<a href="https://portswigger.net/web-security/access-control#:~:text=leading%20to%20access%20control%20bypasses">[12]</a><a href="https://portswigger.net/web-security/access-control#:~:text=Some%20application%20frameworks%20support%20various,a%20request%20like%20the%20following">[13]</a>.</li><li><strong>Небезопасные методы контроля доступа.</strong> Существуют заведомо уязвимые подходы к проверке прав, от которых следует отказаться:</li><li><em>Контроль доступа на основе параметра, отправляемого клиентом.</em> Приложение решает, админ пользователь или нет, на основании <em>данных от самого пользователя</em> – например, скрытого поля формы, куки или параметра URL вроде role=admin или Admin=true. Такое значение легко подделать и получить доступ к запрещенным функциям<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9A%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%20%D0%BD%D0%B0%20%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5%20%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2,%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%20%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D1%8E%D1%89%D0%B5%D0%B3%D0%BE%20%D0%B2%D0%B8%D0%B4%D0%B0">[14]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=https%3A%2F%2Fwahh,%D0%B2%20%D1%80%D0%B0%D1%81%D0%BA%D1%80%D1%8B%D1%82%D0%B8%D0%B8%20%D1%8D%D1%82%D0%BE%D0%B3%D0%BE%20%D0%BC%D0%B5%D1%85%D0%B0%D0%BD%D0%B8%D0%B7%D0%BC%D0%B0%20%D0%BF%D1%80%D0%B8">[15]</a>. Поскольку параметр находится под контролем клиента, злоумышленник просто установит admin=true в своих запросах и станет администратором.</li><li><em>Контроль доступа на основе заголовка Referer.</em> Приложение проверяет, откуда пришел запрос, и на этом основании решает, разрешать ли действие. Например, прямой переход на админ-страницу /admin/deleteUser разрешается только если Referer содержит /admin (то есть запрос инициирован из админского меню). Такой подход неэффективен: заголовок Referer полностью контролируется пользователем и может быть отправлен с любым нужным значением<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9A%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%20%D0%BD%D0%B0%20%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5%20Referer,%D0%AD%D1%82%D0%B0%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D1%8C">[16]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%84%D1%83%D0%BD%D0%B4%D0%B0%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%20%D0%BF%D0%BE%D1%80%D0%BE%D1%87%D0%BD%D0%B0%2C%20%D0%BA%D0%BE%D0%BD%D0%B5%D1%87%D0%BD%D0%BE%20%D0%B6%D0%B5%2C%20%D0%BF%D0%BE%D1%82%D0%BE%D0%BC%D1%83,%D0%B1%D1%8B%D1%82%D1%8C%20%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%20%D0%B2%20%D0%BB%D1%8E%D0%B1%D0%BE%D0%B5%20%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D0%B5">[17]</a>.</li><li><em>Контроль доступа на основе местоположения.</em> Ограничение функций по геолокации пользователя (IP-адресу или GPS) легко обходится с помощью прокси или VPN. Если бизнес-логика требует гео-ограничений, их следует воспринимать лишь как <em>дополнительный</em> фактор, но не как надежную защиту от злоумышленника<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9C%D0%BD%D0%BE%D0%B3%D0%B8%D0%B5%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B8%D0%BC%D0%B5%D1%8E%D1%82%20%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BB%D0%B8,%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8%2C%20%D1%80%D0%B0%D1%81%D0%BF%D0%BE%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%B2%20%D1%82%D1%80%D0%B5%D0%B1%D1%83%D0%B5%D0%BC%D0%BE%D0%BC%20%D0%BC%D0%B5%D1%81%D1%82%D0%B5">[18]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%97%D0%BB%D0%BE%D1%83%D0%BC%D1%8B%D1%88%D0%BB%D0%B5%D0%BD%D0%BD%D0%B8%D0%BA%D1%83%20%D0%BE%D1%82%D0%BD%D0%BE%D1%81%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%20%D0%BB%D0%B5%D0%B3%D0%BA%D0%BE%20%D0%BE%D0%B1%D0%BE%D0%B9%D1%82%D0%B8%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C,%D0%9F%D1%80%D1%8F%D0%BC%D0%BE%D0%B5%20%D0%BC%D0%B0%D0%BD%D0%B8%D0%BF%D1%83%D0%BB%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D1%81%D0%BA%D0%B8%D0%BC%D0%B8%20%D0%BC%D0%B5%D1%85%D0%B0%D0%BD%D0%B8%D0%B7%D0%BC%D0%B0%D0%BC%D0%B8%20%D0%B3%D0%B5%D0%BE%D0%BB%D0%BE%D0%BA%D0%B0%D1%86%D0%B8%D0%B8">[19]</a>.</li></ul><a id="X01b80c497b20b48217ca728677495e17197495a"></a><h3>Методики атак и тестирования контроля доступа</h3><p>Тестирование контроля доступа – трудоемкий процесс, ведь <strong>каждый запрос</strong> в приложении потенциально требует проверки прав. Ниже представлены методы, которые помогают выявлять уязвимости контроля доступа:</p><ul><li><strong>Тестирование с разными учетными записями.</strong> Самый наглядный подход – получить несколько аккаунтов разного уровня и сравнить их возможности. Зайдите под администратором или пользователем с расширенными правами, изучите все доступные функции (разделы меню, страницы). Затем войдите под обычной учетной записью и <em>попробуйте открыть</em> те URL или выполнить действия, которые вы видели у привилегированного пользователя. Если «низший» пользователь получает доступ к тому, что предназначено только для «высшего», – налицо вертикальное повышение привилегий<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9F%D0%A0%D0%90%D0%9A%D0%A2%D0%98%D0%A7%D0%95%D0%A1%D0%9A%D0%98%D0%95%20%D0%A8%D0%90%D0%93%D0%98%20%D0%92%D0%BE%D1%82%20%D0%BD%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE%20%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D0%BE%D0%B2%2C,%D0%B4%D0%BB%D1%8F%20%D0%B5%D0%B3%D0%BE%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B8%20%D0%B8%20%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3%D0%B0">[20]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%BC%D1%83%20%D0%BF%D0%BE%D0%B4%D0%BC%D0%BD%D0%BE%D0%B6%D0%B5%D1%81%D1%82%D0%B2%D1%83%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%2C%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D0%BE%D0%B5%20%D0%BF%D1%80%D0%B8%D0%BD%D0%B0%D0%B4%D0%BB%D0%B5%D0%B6%D0%B8%D1%82,%D1%82%D0%BE%D0%BC%2C%20%D1%87%D1%82%D0%BE%20%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D1%82%D1%81%D1%8F%20%D0%B4%D0%BB%D1%8F">[21]</a>. Аналогично, если два обычных пользователя имеют доступ каждый к своим данным, попробуйте под одним пользователем обратиться к ресурсам другого – проверяя горизонтальное разделение. Это можно делать вручную, копируя ссылки и ID, или автоматизировать. Инструмент <strong>Burp Suite</strong> обладает функцией <em>сравнения карты сайта</em> для двух разных сессий, что значительно ускоряет поиск расхождений в контенте для разных пользователей<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%87%D0%B5%D0%BB%D0%BE%D0%B2%D0%B5%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE%20%D0%B8%D0%BD%D1%82%D0%B5%D0%BB%D0%BB%D0%B5%D0%BA%D1%82%D0%B0%20%D0%B4%D0%BB%D1%8F%20%D1%8D%D1%84%D1%84%D0%B5%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F,%D0%BA%D0%B0%D0%B6%D0%B4%D0%BE%D0%BC%D1%83%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8E%2C%20%D1%81%D0%BE%D0%B2%D0%BF%D0%B0%D0%B4%D0%B0%D0%B5%D1%82%20%D0%B8%D0%BB%D0%B8%20%D1%80%D0%B0%D0%B7%D0%BB%D0%B8%D1%87%D0%B0%D0%B5%D1%82%D1%81%D1%8F">[22]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=2,%D1%84%D0%B0%D0%B9%D0%BB%20%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F%2C%20%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9%20%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%20%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F">[23]</a>. Автоматическое сравнение подсвечивает отличия, но <strong>требует анализа эксперта</strong>: не каждое отличие – уязвимость, и не каждый одинаковый ответ – безопасен<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B5%20%D0%BD%D0%B5%D1%82%20%D0%BD%D0%B0%20%D0%BD%D0%B5%D0%B5%20%D1%81%D1%81%D1%8B%D0%BB%D0%BE%D0%BA,%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8E%20%D0%BF%D1%80%D0%BE%D1%84%D0%B8%D0%BB%D1%8F%20%D0%B4%D0%BB%D1%8F%20%D1%82%D0%B5%D0%BA%D1%83%D1%89%D0%B5%D0%B3%D0%BE%20%D0%B2%D0%BE%D1%88%D0%B5%D0%B4%D1%88%D0%B5%D0%B3%D0%BE">[24]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BD%D0%B5%D0%B4%D0%BE%D1%81%D1%82%D0%B0%D1%82%D0%BE%D1%87%D0%BD%D0%BE%20%D0%B4%D0%BB%D1%8F%20%D0%BE%D1%86%D0%B5%D0%BD%D0%BA%D0%B8%20%D1%8D%D1%84%D1%84%D0%B5%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D1%81%D1%82%D0%B8%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8F,%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D1%8F">[25]</a>. Тем не менее, этот метод помогает быстро сузить область поиска потенциальных проблем.</li><li><strong>Тестирование многоэтапных процессов.</strong> Пошаговые процедуры (создание заказа, изменение роли, перевод денег и т.д.) нужно проверять, атакуя <em>каждый этап отдельно</em>. Даже если первые шаги требуют определенных прав или определенной последовательности, убедитесь, что <em>на каждом запросе</em> есть проверка. Попробуйте отправить запросы финальных шагов без выполнения начальных, изменить параметры, которые передаются через клиент между шагами, и т.п. Цель – выяснить, не предполагает ли приложение ошибочно, что раз пользователь дошел до финала через UI, то он авторизован. Любое подобное предположение дает лазейку: злоумышленник может эмулировать последний шаг и обойти предыдущие проверки<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BF%D1%80%D0%B8%D1%87%D0%B8%D0%BD%D0%B0%D0%BC%2C%20%D0%BD%D0%B5%20%D1%81%D0%B2%D1%8F%D0%B7%D0%B0%D0%BD%D0%BD%D1%8B%D0%BC%20%D1%81%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%B5%D0%BC,%D0%9A%D0%B0%D0%B6%D0%B4%D1%8B%D0%B9%20%D1%88%D0%B0%D0%B3%20%D1%8D%D1%82%D0%BE%D0%B3%D0%BE%20%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D0%B0">[26]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BD%D0%B5%D0%BE%D0%B1%D1%85%D0%BE%D0%B4%D0%B8%D0%BC%D0%BE%20%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C%20%D0%B8%D0%BD%D0%B4%D0%B8%D0%B2%D0%B8%D0%B4%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%2C%20%D1%87%D1%82%D0%BE%D0%B1%D1%8B%20%D1%83%D0%B1%D0%B5%D0%B4%D0%B8%D1%82%D1%8C%D1%81%D1%8F%2C,net%2Fauth%2F471">[27]</a>.</li><li><strong>Тестирование с ограниченным доступом (одна учетная запись).</strong> Если у вас в распоряжении только обычный пользователь (или даже доступ без входа), придется действовать изобретательно:</li><li>Проведите <strong>инвентаризацию функциональности</strong>: используя техники обнаружения скрытого контента (сканирование путей, перебор типичных имен файлов и директорий, просмотр публичных файлов вроде /robots.txt и /sitemap.xml). Цель – найти страницы, которые <strong>не видны</strong> текущему пользователю, но могут существовать (устаревшие разделы, новые фичи, админские панели). Часто даже низкопривилегированный аккаунт может напрямую перечислить некоторые чувствительные функции, если знать где искать<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%B2%D1%81%D0%B5%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D0%BD%D0%B5%D0%B3%D0%BE%20%D1%82%D0%B5%D1%81%D1%82%D0%B0%20%D0%B2%20%D0%BB%D1%8E%D0%B1%D0%BE%D0%BC%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B5,%D0%BD%D0%B8%D0%B7%D0%BA%D0%BE%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F%20%D1%87%D0%B0%D1%81%D1%82%D0%BE%20%D0%B1%D1%8B%D0%B2%D0%B0%D0%B5%D1%82%20%D0%B4%D0%BE%D1%81%D1%82%D0%B0%D1%82%D0%BE%D1%87%D0%BD%D0%BE">[28]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%81%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D0%BE%D0%B2%D0%B0%D1%82%D1%8C%20%D0%BF%D0%BB%D0%BE%D1%85%D0%BE%20%D0%B7%D0%B0%D1%89%D0%B8%D1%89%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F%20%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C%2C%20%D0%BD%D0%B0,%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BF%D1%80%D1%8F%D0%BC%D0%BE%D0%B3%D0%BE%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%20%D0%BA%20%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9">[29]</a>.</li><li>На подозрительных страницах попробуйте добавлять параметры типа admin=true или role=admin в URL и формы – вдруг приложение использует их (см. выше про небезопасные методы). Также удаление или модификация заголовка <strong>Referer</strong> в важных запросах: если запрос без Referer отклоняется, вероятно приложение доверяет этому заголовку<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=3,%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D1%8B%20%D0%B2%20%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%D0%B5%20%D1%81%D1%81%D1%8B%D0%BB%D0%BE%D0%BA%20%D0%BD%D0%B0">[30]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%B4%D0%BB%D1%8F%20%D0%BF%D1%80%D0%B8%D0%BD%D1%8F%D1%82%D0%B8%D1%8F%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9%20%D0%BE%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%B5,%D0%B7%D0%BD%D0%B0%D1%87%D0%B8%D0%BC%D0%BE%D0%BC%D1%83%20%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D1%8E%20%D0%B2%20%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D0%B5%20%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F">[31]</a>.</li><li>Анализируйте весь получаемый HTML/JavaScript. Иногда в коде интерфейса присутствуют <em>скрытые ссылки</em> или фрагменты, рассчитанные на другой уровень прав (например, скрипт, который добавляет кнопку админа, если isAdmin=true – такой код выдаст название секретного URL<a href="https://portswigger.net/web-security/access-control#:~:text=This%20might%20not%20be%20directly,based%20on%20the%20user%27s%20role">[32]</a><a href="https://portswigger.net/web-security/access-control#:~:text=%60,script">[33]</a>). Исследуйте также исходники подключаемых файлов, скриптов, сторонних плагинов – там могут быть прямые ссылки на защищенные ресурсы.</li><li>Проводите <strong>фаззинг идентификаторов</strong>. Если приложение использует числовые ID, попробуйте подбирать разные значения. Сгенерируйте несколько объектов (записей) под своей учеткой, посмотрите, какие ID им присвоены, и попытайтесь угадать или перебрать близкие ID, принадлежащие другим. Если ID выглядят случайными (например GUID), атака перебором вряд ли успешна. Но если они предсказуемы или последовательны – горизонтальная атака очень вероятна. Инструменты вроде <strong>Burp Intruder</strong> помогут автоматизировать перебор ID и сбор ответов. В случае удачи можно выгрузить много данных сразу (например, все счета клиентов, все переписки и т.д.)<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9F%D0%A0%D0%90%D0%9A%D0%A2%D0%98%D0%A7%D0%95%D0%A1%D0%9A%D0%98%D0%95%20%D0%A8%D0%90%D0%93%D0%98%201,%D0%B2%20%D0%B8%D0%B4%D0%B5%D0%BD%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80%D0%B0%D1%85%2C%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B5%20%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B5%D1%82%20%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5">[34]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=3,%D0%BA%D0%B0%D1%81%D1%82%D0%BE%D0%BC%D0%BD%D0%BE%D0%B9%20%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B9%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B8%20%D1%81%20%D1%86%D0%B5%D0%BB%D1%8C%D1%8E">[35]</a>.</li></ul><p><strong>Совет:</strong> Обнаружив уязвимость горизонтального контроля доступа, сразу подумайте о дальнейшем повышении привилегий. Если вы смогли собрать данные о чужих учетных записях (например, список пользователей и хэши паролей), попробуйте найти среди них административную учетку. Часто администраторы имеют ID 1, 2 или другие крайние значения – проверьте их первыми. Либо используйте скрипт перебора: автоматически входите под каждым украденным логином и проверяйте что-то, доступное только администратору (например, чужую домашнюю страницу). Так вы быстро вычислите, какой аккаунт обладает правами администратора<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=http%3A%2F%2Fmdsec,%D1%87%D1%82%D0%BE%20%D1%81%D0%B0%D0%BC%D1%8B%D0%B5%20%D0%BD%D0%B8%D0%B7%D0%BA%D0%B8%D0%B5%20%D0%BD%D0%BE%D0%BC%D0%B5%D1%80%D0%B0%20%D0%BF%D1%80%D0%B8%D1%81%D0%B2%D0%BE%D0%B5%D0%BD%D1%8B">[36]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BD%D0%B5%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B4%D1%83%D0%B5%D1%82,%D0%92%D0%B5%D1%80%D0%BE%D1%8F%D1%82%D0%BD%D0%BE%2C%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B%20%D0%BC%D0%BE%D0%B3%D1%83%D1%82">[37]</a>.</p><ul><li><strong>Прямой вызов серверных методов.</strong> В некоторых архитектурах веб-приложение может предоставлять точку входа для удаленных вызовов (например, общий servlet или API-метод, которому передается имя функции и параметры). Такие бэкэнд-методы тоже нужно проверять. Используйте перечисление, чтобы выявить скрытые методы, и попытайтесь вызывать их напрямую. Особенно опасны известные унаследованные методы, которые могут быть оставлены «по умолчанию». <strong>Пример:</strong> В Java-сервлетах существует диагностический метод IBMTrackerDebug – вызвав POST /svc с параметром servlet=com.ibm.ws.webcontainer.httpsession.IBMTrackerDebug, можно получить чувствительную отладочную информацию из сессий<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%A2%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%BF%D1%80%D1%8F%D0%BC%D0%BE%D0%B3%D0%BE%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%20%D0%BA%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D0%B0%D0%BC,Encoding%3A%20gzip%2C%20deflate">[38]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=servlet%3Dcom,%D1%81%D0%BC%D0%BE%D0%B6%D0%B5%D1%82%D0%B5%20%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B8%D1%82%D1%8C%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%20%D0%B8%20%D0%BA">[39]</a>. Если такие вызовы не требуют авторизации, это брешь.</li><li><strong>Проверка доступа к статическим ресурсам.</strong> Как отмечалось, прямые запросы к файлам могут обходить проверки. Поэтому:</li><li>Выполните легитимный сценарий скачивания защищенного файла под <em>правильным</em> пользователем, посмотрите конечный URL (например, ссылка на PDF отчет после авторизации).</li><li>Затем, не будучи авторизованным или под другим аккаунтом, попробуйте перейти напрямую по этому URL. Если удалось – налицо уязвимость.</li><li>Попытайтесь понять систему именования файлов и, возможно, автоматизировать скачивание множества файлов (например, всех отчетов за разные периоды) путём перебора имен<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9F%D0%A0%D0%90%D0%9A%D0%A2%D0%98%D0%A7%D0%95%D0%A1%D0%9A%D0%98%D0%95%20%D0%A8%D0%90%D0%93%D0%98%201,%D0%95%D1%81%D0%BB%D0%B8%20%D0%B2%D0%BE%D0%B7%D0%BC%D0%BE%D0%B6%D0%BD%D0%BE%2C%20%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9%D1%82%D0%B5">[40]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%82%D1%80%D0%B5%D0%B1%D1%83%D0%B5%D0%BC%D1%83%D1%8E%20%D0%BF%D0%BE%D0%BA%D1%83%D0%BF%D0%BA%D1%83,%D0%93%D0%BB%D0%B0%D0%B2%D1%83%2014">[41]</a>.</li><li><strong>Тестирование ограничений на HTTP-методы.</strong> Если подозреваете, что приложение или веб-сервер ограничивает доступ на уровне методов (например, POST запрещен, а GET – нет), проведите такую проверку:</li><li>Под привилегированным пользователем найдите несколько действий, которые выполняются POST-запросами (создание пользователя, изменение настроек и т.д.).</li><li>Если эти запросы не защищены CSRF-токенами или другими привязками, попробуйте выполнить их, <strong>сменив метод</strong>: отправьте тот же запрос как GET, HEAD или даже с фальшивым методом (X-HTTP-Method-Override или просто произвольное слово вместо POST).</li><li>Если приложение принимает альтернативные методы и выполняет действие – значит, ограничение по методам на сервере можно обойти<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%BE%D0%B2%2C%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B5%20%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D1%8F%D1%8E%D1%82%20%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5,%D0%9F%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%BD%D0%B5%D0%B4%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%20HTTP">[42]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=,">[43]</a>.</li></ul><a id="рекомендации-по-обеспечению-безопасности"></a><h3>Рекомендации по обеспечению безопасности</h3><p>Контроль доступа, с одной стороны, прост для понимания, с другой – требует очень дисциплинированной реализации. Чтобы защитить приложение от этих уязвимостей, придерживайтесь следующих принципов:</p><ul><li><strong>Не полагайтесь на скрытность.</strong> Предполагается, что злоумышленнику известны все URL, ID и переменные вашего приложения. Не рассчитывайте защититься только тем, что «никто не догадается о таком адресе». Всегда реализуйте проверку прав на сервере.</li><li><strong>Не доверяйте данным от клиента для принятия решений о доступе.</strong> Любые параметры типа isAdmin, userRole и т.д., поступающие от пользователя (даже в куки или скрытых полях), могут быть изменены. Решения об авторизации должны основываться на достоверной серверной информации (например, сохранённой роли в сессии или БД, а не переданной обратно от клиента).</li><li><strong>Не делайте предположений о порядке действий пользователя.</strong> Пользователь вовсе не обязан переходить по вашим страницам в задуманной последовательности. Прямые запросы к внутренним шагам, обход ссылок через адресную строку – это нормально, и злоумышленник активно пользуется такими приемами. Поэтому каждая страница/эндпоинт должна <em>сама</em> решать, можно ли этому пользователю её просматривать или использовать, независимо от того, откуда он пришёл.</li><li><strong>Повторно валидируйте чувствительные данные.</strong> Если на шаге 1 вы проверили, что пользователь может редактировать объект X, а на шаге 2 этот же ID X передается через форму, <em>не доверяйте</em> тому, что пришло на шаг 2. Повторно проверьте на сервере, что X принадлежит этому же пользователю и он имеет право на операцию. Никогда не рассчитывайте, что раз вы один раз проверили и запомнили, то можно принимать данные из клиента без повторной проверки.</li><li><strong>“Запрещать по умолчанию”.</strong> При проектировании системы контроля доступа используйте подход <strong>deny by default</strong> – если явно не разрешено, то запрещено. Это касается как кода приложения, так и возможных правил на уровне веб-сервера или брандмауэра. Лучше сперва заблокировать всё, а затем открывать нужное, чем наоборот.</li><li><strong>Централизуйте и унифицируйте контроль доступа.</strong> Разрозненные проверки по всему коду сложно сопровождать и легко пропустить. Реализуйте единый <em>центральный компонент</em>, который на основе сессии пользователя принимает решение, можно ли выполнять запрос. Пропускайте каждый запрос через эту прослойку. Удобный подход – заставить каждого разработчика объявлять на странице требуемый уровень доступа (например, класс контроллера указывает нужную роль). Так ни одна страница не будет забыта.</li><li><strong>Документируйте права для каждой функции.</strong> На этапе разработки определите, какие роли или пользователи имеют доступ к каждой странице и каждому типу данных. Эта матрица поможет и при реализации, и при тестировании. В ней же заложите принцип наименьших привилегий – у каждого пользователя должны быть только те права, которые необходимы для его задач.</li><li><strong>Многоуровневая модель привилегий (Defense-in-Depth).</strong> Реализуйте контроль доступа на <em>нескольких уровнях системы</em>, чтобы подстраховать приложение. Например, помимо проверок в коде приложения, имеет смысл:</li><li>Настроить <em>веб-сервер/app-сервер</em> на ограничение доступа к определённым URL по ролям (например, к /admin/* только группе админов). Это отсечёт часть нелегитимных запросов ещё до обработки логикой.</li><li>Использовать разные <strong>учетные записи БД</strong> при обращении к базе от имени разных пользователей. Например, запросы от пользователей-членов можно выполнять под аккаунтом БД, которому разрешено <em>только SELECT</em>, а админские действия – под аккаунтом с правами <em>UPDATE/DELETE</em>. Таким образом, даже если кто-то обойдёт проверки в приложении, запрос на повышение привилегий может не выполниться из-за отсутствия прав у SQL-пользователя<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=,%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D1%8F%D0%BC%D0%B8%2C%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B5%20%D0%B4%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%20%D1%82%D1%80%D0%B5%D0%B1%D1%83%D1%8E%D1%82%D1%81%D1%8F%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D1%83">[44]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%92%20%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BA%20%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8%20%D1%8D%D1%84%D1%84%D0%B5%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D0%B3%D0%BE,%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D0%B5%D1%82%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D1%8C">[45]</a>.</li><li>Ограничить привилегии учетных записей ОС, под которыми работают компоненты приложения. Каждый сервис (веб-сервер, сервер приложений, СУБД) должен запускаться от отдельного пользователя ОС с минимальными правами, нужными ему для работы<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=,6%20%D0%BF%D1%80%D0%B8%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%20%D1%87%D0%B0%D1%81%D1%82%D0%B8%D1%87%D0%BD%D1%8B%D0%B9%20%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80">[46]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=,%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D1%8B%20%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D0%B9%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%BB%D0%BE%D0%B6%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F">[47]</a>. Это предотвратит эскалацию привилегий на уровне сервера, если уязвимость позволит выполнить произвольный код.</li><li>Грамотно использовать <strong>роли (RBAC)</strong> внутри приложения. Вводите такое количество ролей, которое позволит точно разделить доступ, но не делайте слишком много тонких ролей – это усложняет администрирование. Слишком мало ролей – риск, что у пользователей появляются лишние права<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%BC%20%D0%BC%D0%BE%D0%B3%D1%83%D1%82%20%D0%BE%D0%B1%D1%80%D0%B0%D1%89%D0%B0%D1%82%D1%8C%D1%81%D1%8F%20%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D1%82%D0%B8%D0%BF%D1%8B,%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D0%B5%20%D0%BF%D0%BB%D0%B0%D1%82%D1%84%D0%BE%D1%80%D0%BC%D1%8B%20%D0%B4%D0%BB%D1%8F%20%D0%BE%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0">[48]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%81%D0%B1%D0%B0%D0%BB%D0%B0%D0%BD%D1%81%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C%20%D0%BA%D0%BE%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%BE%20%D1%80%D0%BE%D0%BB%D0%B5%D0%B9%2C%20%D1%87%D1%82%D0%BE%D0%B1%D1%8B%20%D0%BE%D0%BD%D0%B8,deny">[49]</a>. Найдите баланс и используйте роли для первичного отбора доступа (быстрая проверка: если роль не подходит – сразу отказ).</li><li>Если применяются декларативные (вне кода) механизмы контроля доступа, также проектируйте их по принципу «запрет по умолчанию» с явным перечислением разрешений и финальным блокирующим правилом<a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%95%D1%81%D0%BB%D0%B8%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D1%8E%D1%82%D1%81%D1%8F%20%D1%81%D1%80%D0%B5%D0%B4%D1%81%D1%82%D0%B2%D0%B0%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8F%20%D0%BD%D0%B0,%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%8F%D0%B5%D1%82%20%D1%80%D0%B0%D0%B7%D0%BD%D1%8B%D0%B5%20%D1%83%D1%87%D0%B5%D1%82%D0%BD%D1%8B%D0%B5%20%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8%20%D0%B4%D0%BB%D1%8F">[50]</a><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%81%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D1%8B%20%D1%81%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%C2%AB%D0%B7%D0%B0%D0%BF%D1%80%D0%B5%D1%89%D0%B5%D0%BD%D0%BE,%D0%BD%D0%B8%20%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC%D1%83%20%D0%B8%D0%B7%20%D0%BF%D1%80%D0%B5%D0%B4%D1%8B%D0%B4%D1%83%D1%89%D0%B8%D1%85%20%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB">[51]</a>.</li><li><strong>Дополнительные меры для критических функций.</strong> Для особо чувствительных операций (финансовые транзакции, изменение важных настроек) внедряйте <em>дополнительную аутентификацию</em> или <em>двойное подтверждение</em>. Например, подтверждение паролем или кодом 2FA при добавлении нового платежного получателя, или требование, чтобы действие подтвердил второй пользователь с соответствующими правами. Эти меры усложняют жизнь злоумышленнику, даже если он взломал сессию или частично обошел контроль доступа.</li><li><strong>Логирование и мониторинг.</strong> Каждое обращение к защищенному ресурсу и отказ в доступе должны логироваться. По журналам администраторы безопасности могут заметить подозрительную активность: повторные обращения к запрещенным URL, попытки перебора идентификаторов, доступ к админке с неизвестного IP и т.д. Своевременное обнаружение атаки – половина успеха в ее пресечении.</li></ul><p>Следуя этим рекомендациям и тщательно тестируя приложение на этапах разработки и пенетестинга, можно значительно снизить риск уязвимостей контроля доступа.</p><a id="демонстрация"></a><h2>Демонстрация</h2><p>Рассмотрим пару практических примеров атак на контроль доступа из реального мира веб-приложений:</p><p><strong>Кейс 1: Вертикальное повышение привилегий (доступ к скрытой админ-панели).</strong> Пусть в приложении имеется административный раздел по адресу /admin для управления пользователями. Ссылку на него видят только администраторы, а обычным пользователям она не отображается. Однако разработчики <em>не внедрили проверку прав</em> при открытии этой страницы – они полагались на то, что «если нет ссылки, никто не найдет». Злоумышленник, обладая обычным аккаунтом, вручную переходит по URL /admin и неожиданно обнаруживает, что страница загружается без авторизации. Он получает полный доступ к админ-интерфейсу и выполняет запрещенные действия – например, создает себе учетную запись администратора или удаляет чужие. <strong>Почему так произошло?</strong> Админ-панель была <em>полностью незащищена</em> на уровне сервера. Только UI скрывал ее, что не является защитой. <strong>Как предотвратить?</strong> Всегда проверять роль пользователя на сервере при обращении к админским URL, независимо от того, есть ссылка в интерфейсе или нет.</p><p><strong>Кейс 2: Горизонтальное повышение привилегий (чтение чужих данных).</strong> Представим простое почтовое веб-приложение. У каждого пользователя есть страница вида /mailbox?user_id=XXX, где XXX – его уникальный ID. Обычно этот параметр берется из сессии и ссылок в профиле, но приложение также принимает user_id из URL. Пользователь с ID 1001, войдя в свою почту, замечает в адресной строке user_id=1001 и экспериментирует: меняет значение на 1002. Если проверка доступа не реализована, сервер возвратит содержимое почтового ящика пользователя 1002. Так наш герой читает чужие письма. Это классический пример <strong>небезопасного прямого обращения к объектам (IDOR)</strong>. <strong>Почему это стало возможным?</strong> Приложение доверяет параметру user_id и не удостоверяется, что запрошенный ящик принадлежит текущему вошедшему пользователю. <strong>Развитие атаки:</strong> Злоумышленник может автоматизировать перебор user_id и скачать переписку многих пользователей. А если повезет найти ID администратора, то прочитает и его почту, возможно обнаружив там пароли или ссылки для входа – что уже приведет к вертикальному захвату привилегий. <strong>Как предотвратить?</strong> Никогда не полагаться на идентификатор ресурса от клиента. Сервер должен извлечь ID пользователя из сессии и использовать <em>только его</em> для выборки писем, либо хотя бы сверять: запрашиваемый user_id должен совпадать с текущим пользователем (если только это не админ, которому позволено читать чужое).</p><p>Оба примера демонстрируют, что ошибки контроля доступа часто очень просты по сути – забыли проверить важный условный оператор или доверились входному параметру. Тем не менее, последствия таких ошибок крайне серьезны. Поэтому тестирование должно быть тщательным: проверяйте каждый чувствительный URL, каждый параметр, каждый шаг процессов с точки зрения "а мог ли простой пользователь сюда прорваться?" и "может ли пользователь А получить данные пользователя Б?".</p><a id="практика-с-portswigger"></a><h2>Практика с PortSwigger</h2><p>Для отработки навыков поиска уязвимостей контроля доступа отлично подходят интерактивные лабораторные работы из <strong>PortSwigger Web Security Academy</strong>. Эти лаборатории предоставляют готовое окружение (уязвимое приложение, доступное через браузер), поэтому вам <strong>не нужно настраивать</strong> сервер или устанавливать что-либо локально – вы сразу приступаете к экспериментации. Ниже представлены ключевые задачи по теме контроля доступа (Broken Access Control) с ссылками на соответствующие лаборатории и подсказками:</p><ul><li><a href="https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality"><strong>Lab: Unprotected admin functionality</strong></a> – <em>Незащищённая админ-панель</em>. В этой базе вам дается веб-приложение с административным разделом, куда случайно открыт прямой доступ. <strong>Задача:</strong> найти путь к админ-панели и удалить пользователя carlos. Подсказка: всегда проверяйте файлы вроде robots.txt – там может скрываться указание на закрытые разделы. В решении этой лабораторной выясняется, что robots.txt выдаёт путь /administrator-panel, который и нужно открыть, будучи авторизованным под обычным пользователем, чтобы получить доступ к функциям админа (удалить carlos).</li><li><a href="https://portswigger.net/web-security/access-control/lab-user-role-controlled-by-request-parameter"><strong>Lab: User role controlled by request parameter</strong></a> – <em>Повышение привилегий через подконтрольный параметр</em>. В приложении роль пользователя определяется на этапе входа и передается клиенту (через куки). <strong>Задача:</strong> получить доступ к админ-панели и удалить carlos, не зная админских учетных данных. Подсказка: обратившись к /admin, вы увидите отказ. Попробуйте залогиниться под обычным пользователем и перехватить ответ сервера: он выставляет куку Admin=false. Если изменить ее на Admin=true и повторно зайти на /admin, приложение пустит вас как администратора. Этот лаб наглядно демонстрирует, почему нельзя доверять флагам админа, хранящимся у пользователя.</li><li><a href="https://portswigger.net/web-security/access-control/lab-referer-based-access-control"><strong>Lab: Referer-based access control</strong></a> – <em>Контроль на основе Referer</em>. Приложение проверяет заголовок Referer для доступа к некоторым админ-действиям. <strong>Задача:</strong> повысить свою роль до администратора (через уязвимость контроля доступа) и удалить пользователя. Подсказка: сначала войдите под админом (учетку дают) и изучите, как происходит, скажем, повышение прав другого пользователя – такой запрос содержит определенный путь (/admin-roles?...) и, возможно, заголовок Referer. Затем, зайдя под обычным пользователем, попробуйте повторить этот запрос: он сначала отвергнется (нет Referer). Решение – использовать инструмент (Burp Repeater) и отправить запрос повышения привилегий <strong>с вашим пользовательским cookie</strong>, но <strong>с тем же Referer</strong>, что был у админа. Таким образом, приложение решит, что запрос исходно шел из админ-панели, и выполнит его. Вы получите права администратора.</li><li><a href="https://portswigger.net/web-security/access-control/lab-method-based-access-control-can-be-circumvented"><strong>Lab: Method-based access control can be circumvented</strong></a> – <em>Обход контроля доступа по HTTP-методу</em>. В этом сценарии доступ к админ-функциям ограничен на уровне платформы: например, только POST запросы разрешены админам. <strong>Задача:</strong> став обычным пользователем, сделать себя администратором. Подсказка: анализируя трафик администратора (опять же, демонстрационная учетка administrator:admin позволяет увидеть работу админки), вы узнаете, какой запрос меняет роли. Под обычным пользователем попробуйте выполнить тот же запрос, но изменяя HTTP-метод. Здесь трюк в том, что запрос с некорректным методом (например POSTX) частично проходит в приложение (возникает ошибка "missing parameter"), а перевод его в метод GET позволяет обойти правило платформы. В итоге, отправив запрос на повышение своей роли методом GET, вы добиваетесь успеха. Вывод: если контроль завязан только на метод, всегда проверяйте альтернативные методы (GET, HEAD и прочие) – возможно, приложение их не ожидает, но обработает.</li><li><a href="https://portswigger.net/web-security/access-control/lab-multi-step-process-with-no-access-control-on-one-step"><strong>Lab: Multi-step process with no access control on one step</strong></a> – <em>Многошаговый процесс с отсутствующей проверкой на одном из шагов</em>. Приложение содержит админ-панель, где изменение роли пользователя реализовано через последовательность запросов (например, сначала действие, потом подтверждение). <strong>Задача:</strong> стать администратором, эксплуатируя пробел в контроле доступа на этапе подтверждения. Подсказка: изучите, как процесс работает у настоящего администратора (учетные данные даны). Заметьте, какие параметры передаются при подтверждении действия (например, confirmed=true). Затем, под обычным пользователем, попробуйте выполнить <em>только финальный шаг</em> – отправив запрос подтверждения с нужными параметрами (и, возможно, сессионным ID обычного пользователя). Если один из шагов не проверяет права, приложение выполнит административное действие (повысит вам роль) без прохождения предыдущих этапов. Этот лаб учит: <strong>каждый этап</strong> должен контролироваться, нельзя "верить" тому, что пользователь прошел правильный путь.</li><li><a href="https://portswigger.net/web-security/access-control/lab-insecure-direct-object-references"><strong>Lab: Insecure direct object references</strong></a> – <em>Небезопасные прямые ссылки на объекты (горизонтальный доступ)</em>. Сценарий: на сервере хранятся файлы (например, логи чата пользователей) с предсказуемыми именами. Приложение никак не проверяет, кто запрашивает файл – нужно лишь знать правильный URL. <strong>Задача:</strong> найти пароль пользователя carlos в одном из таких файлов и войти под его учетной записью. Подсказка: начните чат от своего имени, получите ссылку на сгенерированный transcript (например, transcript/5.txt). Видно, что номер 5 – это ID вашего чата. Попробуйте открыть transcript/1.txt, 2.txt и т.д. – скорее всего, наткнетесь на чужие записи. Один из первых транскриптов содержит пароль carlos. Таким образом, вы воспользовались IDOR: известен шаблон имени файла и нет проверки авторства. Решение таких проблем – делать файлы недоступными напрямую или включать контроль (например, требовать скачивания через авторизованный запрос).</li></ul><p>Все приведённые лабораторные работы работают прямо в браузере, что очень удобно: вы фокусируетесь на поиске уязвимости и эксплуатации, а не на настройке окружения. Рекомендуется последовательно пройти эти задания. Они охватывают разные аспекты контроля доступа – от тривиальных просчетов (как отсутствие проверок) до нетривиальных атак (подмена метода, обход Referer, эксплойт бизнес-логики). Выполняя их, обращайте внимание на методологию: PortSwigger снабжает каждый лаб детальными объяснениями. После практики вы будете лучше вооружены знаниями для тестирования реальных приложений.</p><a id="тест"></a><h2>Тест</h2><p>Ответьте на следующие вопросы, чтобы проверить усвоение материала урока и практических упражнений. Вопросы разных типов: с одним или несколькими вариантами ответа, утверждения «верно/неверно», а также открытые вопросы, на которые нужно ответить самостоятельно.</p><ol><li>Какое из ниже перечисленного наиболее точно описывает <strong>вертикальное повышение привилегий</strong>?</li><li>A. Обычный пользователь получает доступ к функциям администратора.</li><li>B. Пользователь читает или изменяет данные другого равноправного пользователя.</li><li>C. Атакующий перехватывает трафик другого пользователя.</li><li>D. Пользователь проходит аутентификацию под чужими учетными данными.</li><li><strong>Верно или неверно?</strong> Уязвимости контроля доступа возникают только после аутентификации (то есть <em>только</em> для уже вошедших пользователей).</li><li>Какое из утверждений про <strong>горизонтальный контроль доступа</strong> верно?</li><li>A. Определяет, какие разные роли существуют в системе (например, пользователь, модератор, админ).</li><li>B. Ограничивает пользователя набором объектов, к которым он имеет индивидуальные права.</li><li>C. Разрешает пользователям одного уровня видеть данные друг друга.</li><li>D. Выполняет проверку только на уровне базы данных.</li><li>Укажите <strong>пример горизонтального нарушения</strong> контроля доступа:</li><li>A. Клиент интернет-банка смог просмотреть баланс счета другого клиента.</li><li>B. Заблокированный пользователь смог войти в систему.</li><li>C. Пользователь получил доступ к странице настроек админ-панели.</li><li>D. Злоумышленник обнаружил резервную копию базы данных через прямой URL.</li><li><strong>Верно или неверно?</strong> Если приложение использует GUID (случайные глобальные идентификаторы) вместо последовательных числовых ID, то горизонтальные атаки (типа IDOR) полностью невозможны.</li><li>Что из перечисленного <strong>не является хорошей практикой</strong> при реализации контроля доступа?</li><li>A. Проверять права доступа на каждый запрос на стороне сервера.</li><li>B. Хранить роли пользователей в сессии на сервере, а не доверять данным клиента.</li><li>C. Скрывать чувствительные URL (например, админские) и не документировать их.</li><li>D. Следовать принципу «запрещено по умолчанию», явно разрешая только нужное.</li><li>В чем основная опасность уязвимости типа <strong>IDOR (Insecure Direct Object Reference)</strong>?</li><li>A. SQL-инъекция при прямом обращении к объекту базы данных.</li><li>B. Обход аутентификации через уязвимость в токенах сессии.</li><li>C. Доступ к чужим данным или ресурсам путем подставления чужого идентификатора.</li><li>D. Выполнение привилегированных команд на сервере через уязвимый API.</li><li><strong>Верно или неверно?</strong> Если на странице нет ссылки на админский раздел, обычный пользователь никак не сможет туда попасть.</li><li>Выберите <strong>лучшее описание</strong> контекстно-зависимого контроля доступа:</li><li>A. Контроль, основанный на контенте (содержимом) просматриваемых данных.</li><li>B. Контроль, учитывающий состояние приложения или последовательность действий пользователя.</li><li>C. Синоним горизонтального контроля доступа.</li><li>D. Модель, при которой администратор сам определяет, кому дать доступ к своим ресурсам.</li><li>Какой пример отражает <strong>нарушение бизнес-логики</strong> в контроле доступа?<ul><li>A. Пользователь вызывает API метод, предназначенный только для администраторов, и получает ответ.</li><li>B. Пользователь пропускает этап оплаты товара и получает товар бесплатно.</li><li>C. Пользователь авторизуется без ввода пароля из-за уязвимости.</li><li>D. Пользователь подделывает JWT-токен, повышая себе роль.</li></ul></li><li><strong>Верно или неверно?</strong> Отсутствие ошибки «Доступ запрещен» при попытке открыть неизвестный URL означает, что контроля доступа нет и ресурс точно доступен злоумышленнику.</li><li>Что из перечисленного чаще всего является <strong>причиной распространенности</strong> уязвимостей контроля доступа?<ul><li>A. Разработчики часто не понимают принципов аутентификации.</li><li>B. Решения о доступе сложны и принимаются людьми, из-за чего возможны ошибки проектирования.</li><li>C. Сложность внедрения HTTPS для защиты каналов связи.</li><li>D. Слабое шифрование паролей в базе данных пользователей.</li></ul></li><li>Какой подход разработчика <strong>наиболее опасен</strong> с точки зрения безопасности контроля доступа?<ul><li>A. Использование фреймворка, предоставляющего встроенные механизмы авторизации.</li><li>B. Применение нескольких уровней проверки (в приложении и на уровне БД).</li><li>C. Полагаться исключительно на то, что пользователи не будут вручную менять URL или параметры.</li><li>D. Разделение пользователей на группы ролей с четко определенными правами.</li></ul></li><li><strong>Верно или неверно?</strong> Если функция повышения привилегий пользователя (например, выдача роли модератора) реализована в два шага – сначала запрос, потом подтверждение – то достаточно проверять права на первом шаге, ведь ко второму шагу пользователь не сможет перейти без прохождения первого.</li><li>Какое из приведенных ниже утверждений <strong>наиболее точно описывает принцип "наименьших привилегий"</strong>?<ul><li>A. Назначать пользователю как можно меньше ролей при регистрации.</li><li>B. Пользователь должен иметь минимально необходимый набор прав для выполнения своих задач, и не более.</li><li>C. У всех новых пользователей сначала нет никаких прав, пока администратор явно не выдаст.</li><li>D. Раз в месяц автоматически понижать привилегии всех пользователей на один уровень для безопасности.</li></ul></li><li>Представьте, что вы тестируете веб-приложение с зонами для разных групп пользователей (гости, зарегистрированные, премиум, админы). <strong>Как лучше всего обнаружить страницы, доступные только админам, если у вас нет админской учетной записи?</strong><ul><li>A. Проанализировать ответы сервера на наличие признаков админских элементов (например, в HTML-коде скрытые ссылки или скрипты, связанные с админом).</li><li>B. Использовать SQL-инъекцию, чтобы выгрузить структуру сайта.</li><li>C. Активно сканировать все возможные URL с помощью словаря типичных админских путей.</li><li>D. Оба варианта A и C помогут в совокупности.</li></ul></li><li><strong>Верно или неверно?</strong> Заголовок HTTP Referer может служить надежным фактором для определения, откуда пользователь пришел, и на основании этого можно строить контроль доступа.</li><li>Что означает правило контроля доступа, следующее принципу <strong>"deny by default"</strong>?<ul><li>A. Все запросы от незнакомых IP отклоняются.</li><li>B. Пользователю запрещено всё, что явно не разрешено.</li><li>C. Пользователь по умолчанию имеет права администратора, пока не будет ограничен.</li><li>D. Если модуль контроля доступа падает с ошибкой, запросы блокируются.</li></ul></li><li>При тестировании интернет-магазина вы заметили, что после оформления заказа URL страницы подтверждения – /confirm?order=12345&amp;step=3. Что вы сделаете для проверки на уязвимость контроля доступа?<ul><li>A. Попробую заменить параметр order=12345 на номер чужого заказа, чтобы посмотреть детали чужого заказа.</li><li>B. Изменю step=3 на разные значения (1,2 или 4), пытаясь зайти на этапы вне последовательности.</li><li>C. Удалю параметр step или поставлю некорректное значение, чтобы проверить реакцию системы.</li><li>D. Все перечисленные действия являются осмысленными проверками.</li></ul></li><li><strong>Верно или неверно?</strong> Если у приложения реализован жесткий контроль доступа в коде, то дополнительные механизмы вроде файрвола, сетевых ACL или ролевых правил веб-сервера уже не нужны (они избыточны).</li><li>В чем заключается <strong>опасность оставления устаревшей функциональности</strong> (страниц, API) в приложении, даже если на них нет ссылок?<ul><li>A. Они занимают место на сервере и расходуют память.</li><li>B. Пользователи могут случайно наткнуться на них и запутаться.</li><li>C. Если про них забыли, на них могли не распространить новые политики контроля доступа, и злоумышленник может их вызвать напрямую.</li><li>D. Старая функциональность обычно содержит неэффективный код, что может замедлить приложение, но с безопасностью не связано.</li></ul></li><li>Вы обнаружили, что в ответах сервера присутствует скрытый HTML-блок:</li></ol><ul><li>&lt;!-- Admin Panel: &lt;a href="/admin123"&gt;Go to Admin&lt;/a&gt; --&gt;</li><li>Что это означает в контексте безопасности?<ul><li>A. Ничего особенного, это закомментировано и не влияет.</li><li>B. Возможно, разработчики <em>спрятали</em> ссылку на админ-панель, думая, что раз она в комментарии, пользователи не узнают URL.</li><li>C. Эта строка случайно выдала путь к админской панели, хотя пользователь ее не видит визуально. Злоумышленник, изучив код страницы, теперь знает адрес /admin123.</li><li>D. Такое невозможно, ни один разработчик не оставит явно admin-ссылку в HTML.</li></ul></li></ul><ol><li><strong>Верно или неверно?</strong> При горизонтальном разделении прав важно убедиться, что даже администратор не может получить доступ к данным, которыми он не должен управлять (например, админ техподдержки не должен видеть финансовые отчеты, если это вне его зоны ответственности).</li><li>Допустим, система контролирует доступ к API по ролям: менеджер может видеть только свои проекты, администратор – все проекты. Какой <strong>надежный способ</strong> реализовать это на уровне базы данных?<ul><li>A. В SQL-запрос всегда добавлять условие WHERE project.owner_id = текущий_пользователь для менеджера, а для админа – не добавлять.</li><li>B. Использовать представления (VIEW) в базе, разные для менеджера и админа, с соответствующими фильтрами, и подключаться к базе под учетной записью с нужными правами.</li><li>C. Никак, контроль доступа всегда должен быть исключительно в коде приложения, а в базе – отдавать все.</li><li>D. Сохранять в каждой таблице поле с ролями, которым доступен каждый конкретный ряд.</li></ul></li><li>В ходе теста вы нашли URL /download/Reports/Q1_financial.pdf, доступный без авторизации. Что из ниже перечисленного <strong>НЕправильно</strong> с точки зрения безопасности?<ul><li>A. Хранение финансовых отчетов в статической директории, открытой в веб-сервере.</li><li>B. Название файла содержит информацию (Q1_financial), что может привлечь внимание злоумышленника.</li><li>C. Отсутствие проверки сессии или прав при прямом обращении к PDF-файлу.</li><li>D. Применение PDF-формата для хранения отчетов.</li></ul></li><li><strong>Верно или неверно?</strong> Если приложение генерирует для каждого файла уникальное случайное имя, то можно считать, что доступ к статическим файлам защищен (невозможно угадать URL, значит и проверка не нужна).</li><li>Какой из следующих шагов <strong>наименее эффективен</strong> при проверке горизонтального контроля доступа?<ul><li>A. Получить две учетных записи одного уровня и пробовать под одной открыть данные, принадлежащие другой.</li><li>B. Перебрать несколько идентификаторов ресурсов (например, заказов) вокруг тех, что вам известны, и посмотреть, не станет ли доступен чужой ресурс.</li><li>C. Проверить, не позволяет ли API запросить данные всех пользователей сразу (например, /api/getAllUsers).</li><li>D. Искать уязвимость XSS на страницах входа.</li></ul></li><li>Вы проводите аудит безопасности. Что из перечисленного вы охарактеризуете как <strong>критическую уязвимость контроля доступа</strong>?<ul><li>A. В системе управления пользователями админ может сбросить пароли пользователей.</li><li>B. Любой анонимный посетитель может получить доступ к странице конфиденциальной статистики, минуя логин.</li><li>C. Менеджер отдела видит документы своего отдела, но не другого – однако через прокси-сервер смог получить доступ и к чужим (сменив IP на IP другого офиса).</li><li>D. Пользователь без премиум-подписки нашел способ воспользоваться функцией, доступной только премиум (путем изменения параметра подписки в запросе).</li></ul></li><li><strong>Верно или неверно?</strong> Проверку доступа можно выполнять на клиентской стороне (например, скрывать кнопки, поля ввода, ссылки), и этого достаточно, ведь если пользователь не видит запрещенную функцию, он не сможет ею воспользоваться.</li><li>В лаборатории PortSwigger «Unprotected admin functionality» ключевую роль играет файл:<ul><li>A. .htaccess</li><li>B. config.yaml</li><li>C. robots.txt</li><li>D. admin.log</li></ul></li><li>Какой метод HTTP <strong>чаще всего</strong> злоупотребляется злоумышленниками для обхода запрета на использование POST?<ul><li>A. PUT</li><li>B. HEAD</li><li>C. DELETE</li><li>D. CONNECT</li></ul></li><li>В контексте многоуровневой модели привилегий, выберите правильное утверждение:<ul><li>A. Если приложение защищено на уровне кода, нет смысла ограничивать права на уровне базы данных.</li><li>B. Разделение привилегий между компонентами (приложение, БД, ОС) позволяет смягчить последствия взлома одного уровня.</li><li>C. Глубокоэшелонированная оборона означает, что для доступа к системе нужно пройти несколько этапов аутентификации.</li><li>D. Многоуровневая модель привилегий – это концепция резервного копирования данных с разными уровнями шифрования.</li></ul></li><li><strong>Верно или неверно?</strong> Реализация контроля доступа через централизованный компонент приложения улучшает безопасность, но создает единую точку отказа (single point of failure), поэтому всегда лучше делать проверки разрозненно в каждом модуле.</li><li>Что такое <strong>матрица привилегий</strong> в контексте контроля доступа?<ul><li>A. Таблица в базе данных, хранящая пароли пользователей в зашифрованном виде.</li><li>B. Диаграмма или таблица, отображающая, какие роли (строки) имеют какие права (столбцы) на различных уровнях системы.</li><li>C. Способ шифрования доступа с помощью матричного преобразования (как в одноимённом фильме «Матрица»).</li><li>D. Лог-файл, где записаны все случаи предоставления и отзыва привилегий.</li></ul></li><li>При проверке контроля доступа вы используете прокси Burp Suite. Какие функции Burp могут <strong>автоматически помочь</strong> обнаружить аномалии в доступе?<ul><li>A. Comparer (сравнение ответов) для выявления различий между разными сессиями.</li><li>B. Intruder для перебора идентификаторов ресурсов и анализа ответов.</li><li>C. Scanner, который при активном сканировании убирает заголовок Referer и смотрит на изменения ответов.</li><li>D. Все вышеперечисленные.</li></ul></li><li><strong>Верно или неверно?</strong> Если сравнение карт сайта (site maps) для админа и обычного пользователя показало, что некоторые ссылки присутствуют только у админа, значит контроль доступа точно реализован правильно для этих функций.</li><li>Какой из примеров <strong>указывает на отсутствие горизонтального контроля</strong> в приложении?<ul><li>A. Запрос GET /profile?id=501 возвращает статус 200 и данные профиля, даже если пользователь с id=500.</li><li>B. При попытке удалить чужой файл сервер возвращает 403 Forbidden.</li><li>C. В коде клиента отсутствуют ссылки на профили других пользователей.</li><li>D. У пользователя нет возможности изменить свой собственный email.</li></ul></li><li>В каком случае <strong>недостаточно</strong> только вертикального разделения доступа, и нужна комбинация с горизонтальным?<ul><li>A. В корпоративном приложении у сотрудников есть роли (менеджер, директор), но каждый видит только документы своего отдела.</li><li>B. В форуме есть обычные пользователи и модераторы; модераторы могут удалять любые сообщения.</li><li>C. В фотогалерее все зарегистрированные пользователи равны, но фотографии имеют отметки «только для друзей» или «публичные».</li><li>D. В онлайн-игре есть уровни доступа к контенту по подписке (бесплатный, платный).</li></ul></li><li><strong>Верно или неверно?</strong> Если веб-сервер настроен блокировать доступ неадминистраторов к пути /admin, то добавление суффикса, например запрос к /admin/ (со слэшем) или /admin?. может обойти такое ограничение в некоторых случаях.</li><li>В ходе пентеста вы заметили, что при запросе удаленного ресурса API возвращает HTTP 302 Redirect на страницу логина, <em>но при этом в теле ответа присутствуют данные</em> запрошенного ресурса. Как лучше интерпретировать эту ситуацию?<ul><li>A. Это нормальное поведение, просто кэш или отладочная информация.</li><li>B. Это уязвимость: хоть система и пытается перенаправить на логин, она уже включила защищенные данные в ответ (возможно, по недосмотру).</li><li>C. Это свидетельствует о межсайтовом скриптинге (XSS).</li><li>D. Сервер таким образом шифрует содержимое, и на логин-странице оно расшифруется.</li></ul></li><li>Почему <strong>опасно полагаться только на JavaScript на стороне клиента</strong> для ограничения доступа (например, не отрисовывать админ-кнопки для обычных пользователей)?<ul><li>A. Злоумышленник может вручную вызвать нужный запрос, минуя UI.</li><li>B. Можно отключить JS в браузере и получить доступ ко всем элементам.</li><li>C. JavaScript-код легко изменить или подделать в инструментах разработчика.</li><li>D. Все вышеперечисленное.</li></ul></li><li><strong>Верно или неверно?</strong> Для проверки механизма контроля доступа можно использовать метод черного ящика: вообще не зная деталей кода, просто на основании логики приложения и экспериментов понять, где может быть уязвимость.</li><li>В лабораторной работе PortSwigger «User role controlled by request parameter» основной уязвимостью было:<ul><li>A. Отсутствие HTTPS, из-за чего злоумышленник украл cookie администратора.</li><li>B. Хранение роли пользователя в куки, которую можно изменить на Admin=true.</li><li>C. SQL-инъекция в запросе на вход, позволяющая войти как админ.</li><li>D. XSS на странице входа, что привело к обходу авторизации.</li></ul></li><li>Какой подход поможет <strong>минимизировать человеческие ошибки</strong> при добавлении нового функционала в контексте контроля доступа?<ul><li>A. Обучение разработчиков основам безопасности и контролю доступа.</li><li>B. Использование конвейера CI/CD, в котором автоматически проверяется наличие уязвимостей доступа.</li><li>C. Принуждение разработчиков явно указывать требования доступа для каждого нового эндпоинта (например, аннотациями или конфигурацией).</li><li>D. Привлечение внешних аудиторов для ревью каждого коммита.</li></ul></li><li><strong>Верно или неверно?</strong> Проверка авторизации должна выполняться после всех основных операций в коде страницы (например, сначала обработать запрос, изменить данные, а в конце убедиться, что пользователь имел на это право).</li><li>Когда уместно использовать <strong>двойную авторизацию (two-man rule)</strong> как часть контроля доступа?<ul><li>A. Для операций, несущих большой риск или ценные изменения, требующих подтверждения второго ответственного лица (например, перевод крупной суммы денег).</li><li>B. Для всех операций с базой данных, чтобы уменьшить нагрузку на сервер.</li><li>C. Для авторизации через две разные OAuth-службы одновременно.</li><li>D. Никогда, это устаревшая концепция.</li></ul></li><li>Что из перечисленного <strong>НЕ относится</strong> к методике тестирования контроля доступа?<ul><li>A. Сравнение ответов приложения для пользователей с разными правами.</li><li>B. Перебор URL-адресов и параметров вне предусмотренных сценариев.</li><li>C. Декомпиляция и анализ исходного кода или компонентов (клиентских скриптов, мобильного приложения).</li><li>D. Использование сложных паролей для всех тестовых учетных записей.</li></ul></li><li>В чем риски, если <strong>забыть повторно проверить параметр, переданный через клиент</strong> (например, ID ресурса) на завершающем шаге процесса?<ul><li>A. Пользователь может получить ошибку, но это не влияет на безопасность.</li><li>B. Злоумышленник может изменить этот параметр и получить доступ к объекту, который изначально не должен был быть доступен ему.</li><li>C. Это приведет к утечке памяти на сервере.</li><li>D. Ничего страшного, если начальная проверка прошла, значит все хорошо.</li></ul></li><li><strong>Верно или неверно?</strong> HTTP-заголовок X-Original-URL или X-Rewrite-URL может быть использован злоумышленником для обхода проверок, если веб-сервер поддерживает их, но система контроля об этом «не знает».</li><li>Что из ниже перечисленного является <strong>надежным способом</strong> защитить статические файлы, которые должны быть доступны только авторизованным пользователям?<ul><li>A. Помещать их в недоступную из веба директорию и выдавать через скрипт (динамически) после проверки сессии.</li><li>B. Использовать скрытые, трудногадаемые имена файлов и не публиковать ссылки.</li><li>C. Сжимать файлы в ZIP с паролем и давать пароль только авторизованному пользователю.</li><li>D. Переименовывать файлы каждый день и обновлять ссылки.</li></ul></li><li>После проведения тестирования вы хотите убедиться, что покрыли все чувствительные функции. Назовите <strong>два вопроса</strong>, которые важно себе задать при анализе контролей доступа (открытый вопрос).</li><li>Перечислите <strong>три наиболее распространенных ошибки</strong> разработчиков при реализации контроля доступа (открытый вопрос).</li><li>Опишите вкратце, как уязвимость контроля доступа в горизонтальном разрезе <strong>может привести</strong> к вертикальному компрометации системы (открытый вопрос).</li><li>Вспомните лабораторию PortSwigger про Referer. <strong>Какой заголовок</strong> и <strong>с каким значением</strong> необходимо было добавить к запросу, чтобы обойти проверку? (открытый вопрос)</li><li>Почему принцип <strong>«доверяй, но проверяй»</strong> не подходит для контроля доступа? Что следует использовать вместо него? (открытый вопрос)</li><li>Как может помочь <strong>логирование доступа</strong> в обнаружении попыток эксплуатации уязвимостей контроля доступа? Приведите пример (открытый вопрос).</li><li>Представьте, что у приложения есть URL /admin/deleteUser?userId=123. Какие проверки должны быть выполнены на сервере перед удалением пользователя с ID 123? (открытый вопрос)</li><li>Чем опасна уязвимость, при которой <strong>в HTML-коде интерфейса фигурирует условие</strong> вроде if (isAdmin) { ... показать админ-кнопку ... }? (открытый вопрос)</li><li>Опишите последовательность действий, как вы бы протестировали функцию <strong>«просмотр чужого профиля»</strong> на уязвимость типа IDOR, не имея прямого доступа к чужому профилю через UI (открытый вопрос).</li><li>Что означает <strong>RBAC</strong> и какую проблему избыточных или недостаточных привилегий он решает? (открытый вопрос)</li><li>В чем разница между <strong>дискреционным</strong> и <strong>ролевым</strong> контролем доступа? (открытый вопрос)</li><li>Зачем может потребоваться <strong>повторная аутентификация</strong> пользователя перед совершением особо важного действия, даже если сессия активна? (открытый вопрос)</li><li>Приведите пример заголовка, который активный сканер Burp Suite убирает из запросов для выявления уязвимостей контроля доступа, и объясните почему (открытый вопрос).</li><li>Почему <strong>автоматические сканеры</strong> часто не могут полностью обнаружить уязвимости контроля доступа без участия человека? (открытый вопрос)</li><li>В лаборатории про multi-step процесс уязвимость заключалась в пропущенной проверке на шаге подтверждения. <strong>Как разработчику избежать подобных ошибок</strong> при создании многоэтапных процессов? (открытый вопрос)</li><li>Какие действия должен предпринять разработчик, обнаружив в своем приложении уязвимость типа IDOR, чтобы обезопасить данные пользователей? (открытый вопрос)</li><li>Если вы обнаружили, что через уязвимость контроля доступа можно извлечь список всех пользователей системы, какие дальнейшие шаги атаки вы предпримете? (открытый вопрос)</li><li>Что такое <strong>ACL (Access Control List)</strong> и где она может применяться в современных веб-приложениях? (открытый вопрос)</li><li>Почему <strong>методы HTTP</strong> TRACE или нестандартные (например, SEARCH) могут представлять проблему для контроля доступа? (открытый вопрос)</li><li>Вы провели серию тестов и не нашли очевидных дыр в контроле доступа. Назовите <strong>минимум три меры</strong>, которые вы все равно порекомендуете заказчику внедрить для усиления контроля доступа (открытый вопрос).</li><li><strong>Верно или неверно?</strong> Принцип минимальных привилегий должен применяться не только к пользователям приложения, но и к самим компонентам системы (учетным записям сервисов, БД, ОС).</li><li><strong>Верно или неверно?</strong> Если URL содержит длинный случайный токен (например, для скачивания файла), то можно считать, что доступ к этому ресурсу защищен не хуже, чем сессией.</li><li><strong>Верно или неверно?</strong> Отключение метода HTTP HEAD на веб-сервере гарантированно предотвращает описанные обходы с использованием HEAD-запросов.</li><li><strong>Верно или неверно?</strong> Контроль доступа должен охватывать не только HTTP-запросы страниц, но и действия типа AJAX-вызовов, загрузки файлов, WebSocket-сообщения – все входящие запросы без исключения.</li><li><strong>Верно или неверно?</strong> Использование современного фреймворка (например, с аннотациями контроллеров для ролей) полностью решает проблему – разработчик не может пропустить проверку, если она задается декларативно.</li><li><strong>Верно или неверно?</strong> В AJAX-приложениях (SPA) контроль доступа можно перенести на клиент, ведь сервер обычно выдает только данные, а интерфейс решает, что показать.</li><li><strong>Верно или неверно?</strong> Если приложение использует JWT (JSON Web Token) для хранения роли пользователя, важно на стороне сервера <strong>повторно проверять</strong> роль при каждом запросе, а не доверять тому, что внутри токена.</li><li><strong>Верно или неверно?</strong> При обнаружении уязвимости контроля доступа тестировщику следует попробовать эксплуатировать ее до конца (например, получить админ-права), прежде чем сообщать о ней, так как без доказательства воздействия баг могут не признать.</li><li><strong>Верно или неверно?</strong> Глубокоэшелонированная оборона (defense-in-depth) подразумевает дублирование функций безопасности на разных слоях, поэтому даже компрометация одного слоя не дает полного доступа злоумышленнику.</li><li><strong>Верно или неверно?</strong> Контроль доступа <em>никогда</em> не должен выполняться на стороне клиента, но <em>может</em> дублироваться на клиенте для удобства (например, чтобы сразу не показывать лишнее) – при условии, что сервер все равно проверит.</li><li>В чем заключается <strong>основное назначение</strong> механизма сессий (cookie, токены) в контексте контроля доступа?<ul><li>A. Обеспечить сохранение состояния входа пользователя, на основании которого потом принимаются решения о доступе.</li><li>B. Зашифровать все запросы пользователя.</li><li>C. Хранить на клиенте информацию о всех его правах доступа (внутри токена, например).</li><li>D. Предотвратить атаки методом перебора паролей.</li></ul></li><li>С помощью какого инструмента Burp Suite можно <strong>массово протестировать набор URL</strong> под разными учетными записями?<ul><li>A. Repeater</li><li>B. Intruder</li><li>C. Sequencer</li><li>D. Decoder</li></ul></li><li>Какой из заголовков HTTP <strong>не должен</strong> использоваться для принятия решений о предоставлении доступа?<ul><li>A. Referer</li><li>B. X-User-Role (самостоятельно придуманного)</li><li>C. Authorization (с токеном Bearer)</li><li>D. X-Forwarded-For (с IP адресом)</li></ul></li><li>Как администраторы системы могут обнаружить, что злоумышленник эксплуатирует уязвимость контроля доступа <strong>горизонтального типа</strong>?<ul><li>A. По ошибкам 500 в логах сервера.</li><li>B. По множественным последовательным запросам к ресурсам разных пользователей (например, скачивание 1000 файлов подряд).</li><li>C. По увеличению потребления CPU на сервере.</li><li>D. Никак, это невозможно обнаружить.</li></ul></li><li>Почему <strong>отключение каталогов по умолчанию</strong> (типа /admin/ если не используется, или удаление страниц примеров фреймворка) – важный шаг в конфигурировании сервера?<ul><li>A. Они могут содержать уязвимости XSS.</li><li>B. Они могут предоставить злоумышленнику функциональность без авторизации (например, стандартные админ-панели, оставшиеся незащищёнными).</li><li>C. Это нужно для экономии места.</li><li>D. Чтобы соответствовать требованиям лицензии фреймворка.</li></ul></li><li><strong>Верно или неверно?</strong> Если приложение использует функцию, завязанную на IP-адрес (например, админка доступна только из офиса), это полностью решает проблему контроля доступа для внешних злоумышленников.</li><li>В чем состоит <strong>основная сложность</strong> при проектировании надежного контроля доступа?<ul><li>A. Необходимо учесть множество сценариев и исключений вручную, технология не может автоматически решить, кому что позволено.</li><li>B. Требуется писать много кода на низком уровне (на ассемблере) для контроля доступа.</li><li>C. Нужно использовать только шифрование во всех запросах.</li><li>D. В частых обновлениях браузеров, которые могут обходить контроль доступа.</li></ul></li><li>Какой принцип должен быть выполнен при конфигурации правил доступа на веб-сервере (например, для URL и методов) согласно лучшим практикам?<ul><li>A. Чем более общие правила, тем лучше – одно правило "разрешить всем все методы" достаточно, а остальное сделает приложение.</li><li>B. Правила должны быть максимально детальными (конкретный метод + конкретный путь + конкретная роль), а в конце – правило, запрещающее все остальное.</li><li>C. Не смешивать ограничения по методам и по URL – выбирать что-то одно.</li><li>D. Отдавать контроль доступа полностью в руки приложения, а на сервере ничего не настраивать.</li></ul></li><li><strong>Верно или неверно?</strong> Если в приложении реализована многофакторная аутентификация при входе, то уязвимости контроля доступа уже не будут критичными, так как вероятность проникновения сильно снижена.</li><li>Перечислите <strong>три способа</strong> обхода контроля доступа, основанного на географическом местоположении пользователя (открытый вопрос).</li><li>Какие <strong>основные вопросы</strong> должен задать себе тестировщик в начале анализа системы на уязвимости контроля доступа? Назовите не менее трех (открытый вопрос).</li><li>Что происходит, если <strong>автоматизировать перебор</strong> тысяч возможных ID ресурсов в приложении без достаточных ограничений? Какие риски и последствия? (открытый вопрос)</li><li>Объясните на примере, как <em>горизонтальное повышение привилегий</em> может быть использовано для компрометации <em>вертикального</em> контроля доступа (открытый вопрос).</li><li>Какие индикаторы в логах или мониторинге могут указывать на попытки обхода контроля доступа (приведите 2-3 примера) (открытый вопрос).</li><li>Почему важно <strong>изолировать среду администрирования</strong> (например, админ-панель на отдельном поддомене или с дополнительной авторизацией)? (открытый вопрос)</li><li>Ваше веб-приложение хранит файлы пользователей в Amazon S3 (облачное хранилище). Какие меры вы примете, чтобы реализовать контроль доступа к этим файлам? (открытый вопрос)</li><li>Что следует делать при <strong>дизайн-ревью</strong> новой фичи, чтобы убедиться, что контроль доступа для нее будет адекватным? (открытый вопрос)</li><li>Если при тестировании обнаружено, что REST API возвращает "isAdmin": true в ответе обычному пользователю (просто не используясь на клиенте), является ли это проблемой? Почему? (открытый вопрос)</li><li>Опишите стратегию тестирования, когда у вас <strong>нет учетных записей с разными ролями</strong> (например, у вас только пользователь, а роли менеджера/админа недоступны). Как все же проверить, нет ли уязвимостей контроля доступа? (открытый вопрос)</li><li>Почему <strong>контроль доступа</strong> стоит на первом месте в актуальном списке OWASP Top 10 (2021)? Объясните своими словами, основываясь на материалах урока (открытый вопрос).</li></ol><a id="citations"></a><p><a href="https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality#:~:text=">[1]</a> Lab: Unprotected admin functionality | Web Security Academy</p><p><a href="https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality">https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality</a></p><p><a href="https://portswigger.net/web-security/access-control#:~:text=Sometimes%2C%20a%20website%20will%20implement,step%20with%20the%20required%20parameters">[2]</a> <a href="https://portswigger.net/web-security/access-control#:~:text=administrative%20page%20at%20,then%20the%20request%20is%20allowed">[3]</a> <a href="https://portswigger.net/web-security/access-control#:~:text=,matching%20discrepancies">[10]</a> <a href="https://portswigger.net/web-security/access-control#:~:text=enabled%20the%20,option%20is%20enabled%20by%20default">[11]</a> <a href="https://portswigger.net/web-security/access-control#:~:text=leading%20to%20access%20control%20bypasses">[12]</a> <a href="https://portswigger.net/web-security/access-control#:~:text=Some%20application%20frameworks%20support%20various,a%20request%20like%20the%20following">[13]</a> <a href="https://portswigger.net/web-security/access-control#:~:text=This%20might%20not%20be%20directly,based%20on%20the%20user%27s%20role">[32]</a> <a href="https://portswigger.net/web-security/access-control#:~:text=%60,script">[33]</a> Access control vulnerabilities and privilege escalation | Web Security Academy</p><p><a href="https://portswigger.net/web-security/access-control">https://portswigger.net/web-security/access-control</a></p><p><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BA%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%20%D0%BA%D0%BD%D0%B8%D0%B3%20%D0%B8%20%D0%BF%D0%BE%D0%BA%D1%83%D0%BF%D0%B0%D1%82%D1%8C%20%D1%8D%D0%BB%D0%B5%D0%BA%D1%82%D1%80%D0%BE%D0%BD%D0%BD%D1%8B%D0%B5,%D0%92%20%D0%B4%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B5%20%D0%B8%D0%BC%D1%8F%20%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0">[4]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%2C%20%D0%B8%20%D1%87%D1%82%D0%BE%20%D0%BB%D1%8E%D0%B1%D0%BE%D0%B9%2C%20%D0%BA%D1%82%D0%BE,%D1%84%D0%B0%D0%B9%D0%BB%D0%B0%D0%BC%20%D0%B8%20%D0%B4%D1%80%D1%83%D0%B3%D0%B8%D0%BC%20%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%BC">[5]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9A%D0%B0%D0%BA%20%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BE%20%D0%B2%20%D0%93%D0%BB%D0%B0%D0%B2%D0%B5%203%2C,%D1%8D%D1%82%D0%BE%D1%82%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%2C%20%D0%BE%D1%82%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%B2%20%D1%82%D0%BE%D1%82%20%D0%B6%D0%B5">[6]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BD%D0%B5%D1%81%D0%B0%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC%D1%83%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D1%83,%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B5%20%D0%B4%D0%BB%D1%8F%20%D0%BD%D0%B5%D1%81%D0%B0%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8">[7]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%A7%D1%82%D0%BE%20%D0%BD%D0%B0%20%D0%BF%D0%B5%D1%80%D0%B2%D1%8B%D0%B9%20%D0%B2%D0%B7%D0%B3%D0%BB%D1%8F%D0%B4%20%D0%B5%D1%89%D0%B5,%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D1%8B%20%D1%87%D0%B0%D1%81%D1%82%D0%BE">[8]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%92%20%D0%BD%D0%B5%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D1%85%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D1%8F%D1%85%20%D0%BF%D0%BB%D0%B0%D1%82%D1%84%D0%BE%D1%80%D0%BC%D1%8B%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D1%8E%D1%82,%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B5%20%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%BD%D0%B5%D0%B4%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%20HTTP">[9]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9A%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%20%D0%BD%D0%B0%20%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5%20%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2,%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%20%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D1%8E%D1%89%D0%B5%D0%B3%D0%BE%20%D0%B2%D0%B8%D0%B4%D0%B0">[14]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=https%3A%2F%2Fwahh,%D0%B2%20%D1%80%D0%B0%D1%81%D0%BA%D1%80%D1%8B%D1%82%D0%B8%D0%B8%20%D1%8D%D1%82%D0%BE%D0%B3%D0%BE%20%D0%BC%D0%B5%D1%85%D0%B0%D0%BD%D0%B8%D0%B7%D0%BC%D0%B0%20%D0%BF%D1%80%D0%B8">[15]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9A%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%20%D0%BD%D0%B0%20%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5%20Referer,%D0%AD%D1%82%D0%B0%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D1%8C">[16]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%84%D1%83%D0%BD%D0%B4%D0%B0%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%20%D0%BF%D0%BE%D1%80%D0%BE%D1%87%D0%BD%D0%B0%2C%20%D0%BA%D0%BE%D0%BD%D0%B5%D1%87%D0%BD%D0%BE%20%D0%B6%D0%B5%2C%20%D0%BF%D0%BE%D1%82%D0%BE%D0%BC%D1%83,%D0%B1%D1%8B%D1%82%D1%8C%20%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%20%D0%B2%20%D0%BB%D1%8E%D0%B1%D0%BE%D0%B5%20%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D0%B5">[17]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9C%D0%BD%D0%BE%D0%B3%D0%B8%D0%B5%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8%20%D0%B8%D0%BC%D0%B5%D1%8E%D1%82%20%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BB%D0%B8,%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8%2C%20%D1%80%D0%B0%D1%81%D0%BF%D0%BE%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%B2%20%D1%82%D1%80%D0%B5%D0%B1%D1%83%D0%B5%D0%BC%D0%BE%D0%BC%20%D0%BC%D0%B5%D1%81%D1%82%D0%B5">[18]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%97%D0%BB%D0%BE%D1%83%D0%BC%D1%8B%D1%88%D0%BB%D0%B5%D0%BD%D0%BD%D0%B8%D0%BA%D1%83%20%D0%BE%D1%82%D0%BD%D0%BE%D1%81%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%20%D0%BB%D0%B5%D0%B3%D0%BA%D0%BE%20%D0%BE%D0%B1%D0%BE%D0%B9%D1%82%D0%B8%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C,%D0%9F%D1%80%D1%8F%D0%BC%D0%BE%D0%B5%20%D0%BC%D0%B0%D0%BD%D0%B8%D0%BF%D1%83%D0%BB%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D1%81%D0%BA%D0%B8%D0%BC%D0%B8%20%D0%BC%D0%B5%D1%85%D0%B0%D0%BD%D0%B8%D0%B7%D0%BC%D0%B0%D0%BC%D0%B8%20%D0%B3%D0%B5%D0%BE%D0%BB%D0%BE%D0%BA%D0%B0%D1%86%D0%B8%D0%B8">[19]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9F%D0%A0%D0%90%D0%9A%D0%A2%D0%98%D0%A7%D0%95%D0%A1%D0%9A%D0%98%D0%95%20%D0%A8%D0%90%D0%93%D0%98%20%D0%92%D0%BE%D1%82%20%D0%BD%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE%20%D0%B2%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D0%BE%D0%B2%2C,%D0%B4%D0%BB%D1%8F%20%D0%B5%D0%B3%D0%BE%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B8%20%D0%B8%20%D0%BC%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3%D0%B0">[20]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%BC%D1%83%20%D0%BF%D0%BE%D0%B4%D0%BC%D0%BD%D0%BE%D0%B6%D0%B5%D1%81%D1%82%D0%B2%D1%83%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%2C%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D0%BE%D0%B5%20%D0%BF%D1%80%D0%B8%D0%BD%D0%B0%D0%B4%D0%BB%D0%B5%D0%B6%D0%B8%D1%82,%D1%82%D0%BE%D0%BC%2C%20%D1%87%D1%82%D0%BE%20%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D1%82%D1%81%D1%8F%20%D0%B4%D0%BB%D1%8F">[21]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%87%D0%B5%D0%BB%D0%BE%D0%B2%D0%B5%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE%20%D0%B8%D0%BD%D1%82%D0%B5%D0%BB%D0%BB%D0%B5%D0%BA%D1%82%D0%B0%20%D0%B4%D0%BB%D1%8F%20%D1%8D%D1%84%D1%84%D0%B5%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F,%D0%BA%D0%B0%D0%B6%D0%B4%D0%BE%D0%BC%D1%83%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8E%2C%20%D1%81%D0%BE%D0%B2%D0%BF%D0%B0%D0%B4%D0%B0%D0%B5%D1%82%20%D0%B8%D0%BB%D0%B8%20%D1%80%D0%B0%D0%B7%D0%BB%D0%B8%D1%87%D0%B0%D0%B5%D1%82%D1%81%D1%8F">[22]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=2,%D1%84%D0%B0%D0%B9%D0%BB%20%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D1%8F%2C%20%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9%20%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%20%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F">[23]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B5%20%D0%BD%D0%B5%D1%82%20%D0%BD%D0%B0%20%D0%BD%D0%B5%D0%B5%20%D1%81%D1%81%D1%8B%D0%BB%D0%BE%D0%BA,%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8E%20%D0%BF%D1%80%D0%BE%D1%84%D0%B8%D0%BB%D1%8F%20%D0%B4%D0%BB%D1%8F%20%D1%82%D0%B5%D0%BA%D1%83%D1%89%D0%B5%D0%B3%D0%BE%20%D0%B2%D0%BE%D1%88%D0%B5%D0%B4%D1%88%D0%B5%D0%B3%D0%BE">[24]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BD%D0%B5%D0%B4%D0%BE%D1%81%D1%82%D0%B0%D1%82%D0%BE%D1%87%D0%BD%D0%BE%20%D0%B4%D0%BB%D1%8F%20%D0%BE%D1%86%D0%B5%D0%BD%D0%BA%D0%B8%20%D1%8D%D1%84%D1%84%D0%B5%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D1%81%D1%82%D0%B8%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8F,%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D1%8F">[25]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BF%D1%80%D0%B8%D1%87%D0%B8%D0%BD%D0%B0%D0%BC%2C%20%D0%BD%D0%B5%20%D1%81%D0%B2%D1%8F%D0%B7%D0%B0%D0%BD%D0%BD%D1%8B%D0%BC%20%D1%81%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%B5%D0%BC,%D0%9A%D0%B0%D0%B6%D0%B4%D1%8B%D0%B9%20%D1%88%D0%B0%D0%B3%20%D1%8D%D1%82%D0%BE%D0%B3%D0%BE%20%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D0%B0">[26]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BD%D0%B5%D0%BE%D0%B1%D1%85%D0%BE%D0%B4%D0%B8%D0%BC%D0%BE%20%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C%20%D0%B8%D0%BD%D0%B4%D0%B8%D0%B2%D0%B8%D0%B4%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%2C%20%D1%87%D1%82%D0%BE%D0%B1%D1%8B%20%D1%83%D0%B1%D0%B5%D0%B4%D0%B8%D1%82%D1%8C%D1%81%D1%8F%2C,net%2Fauth%2F471">[27]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%B2%D1%81%D0%B5%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D0%BD%D0%B5%D0%B3%D0%BE%20%D1%82%D0%B5%D1%81%D1%82%D0%B0%20%D0%B2%20%D0%BB%D1%8E%D0%B1%D0%BE%D0%BC%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B5,%D0%BD%D0%B8%D0%B7%D0%BA%D0%BE%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F%20%D1%87%D0%B0%D1%81%D1%82%D0%BE%20%D0%B1%D1%8B%D0%B2%D0%B0%D0%B5%D1%82%20%D0%B4%D0%BE%D1%81%D1%82%D0%B0%D1%82%D0%BE%D1%87%D0%BD%D0%BE">[28]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%81%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D0%BE%D0%B2%D0%B0%D1%82%D1%8C%20%D0%BF%D0%BB%D0%BE%D1%85%D0%BE%20%D0%B7%D0%B0%D1%89%D0%B8%D1%89%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F%20%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C%2C%20%D0%BD%D0%B0,%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BF%D1%80%D1%8F%D0%BC%D0%BE%D0%B3%D0%BE%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%20%D0%BA%20%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9">[29]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=3,%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D1%8B%20%D0%B2%20%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%D0%B5%20%D1%81%D1%81%D1%8B%D0%BB%D0%BE%D0%BA%20%D0%BD%D0%B0">[30]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%B4%D0%BB%D1%8F%20%D0%BF%D1%80%D0%B8%D0%BD%D1%8F%D1%82%D0%B8%D1%8F%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9%20%D0%BE%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%B5,%D0%B7%D0%BD%D0%B0%D1%87%D0%B8%D0%BC%D0%BE%D0%BC%D1%83%20%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D1%8E%20%D0%B2%20%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D0%B5%20%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F">[31]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9F%D0%A0%D0%90%D0%9A%D0%A2%D0%98%D0%A7%D0%95%D0%A1%D0%9A%D0%98%D0%95%20%D0%A8%D0%90%D0%93%D0%98%201,%D0%B2%20%D0%B8%D0%B4%D0%B5%D0%BD%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80%D0%B0%D1%85%2C%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B5%20%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B5%D1%82%20%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5">[34]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=3,%D0%BA%D0%B0%D1%81%D1%82%D0%BE%D0%BC%D0%BD%D0%BE%D0%B9%20%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B9%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B8%20%D1%81%20%D1%86%D0%B5%D0%BB%D1%8C%D1%8E">[35]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=http%3A%2F%2Fmdsec,%D1%87%D1%82%D0%BE%20%D1%81%D0%B0%D0%BC%D1%8B%D0%B5%20%D0%BD%D0%B8%D0%B7%D0%BA%D0%B8%D0%B5%20%D0%BD%D0%BE%D0%BC%D0%B5%D1%80%D0%B0%20%D0%BF%D1%80%D0%B8%D1%81%D0%B2%D0%BE%D0%B5%D0%BD%D1%8B">[36]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BD%D0%B5%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B4%D1%83%D0%B5%D1%82,%D0%92%D0%B5%D1%80%D0%BE%D1%8F%D1%82%D0%BD%D0%BE%2C%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B%20%D0%BC%D0%BE%D0%B3%D1%83%D1%82">[37]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%A2%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%BF%D1%80%D1%8F%D0%BC%D0%BE%D0%B3%D0%BE%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%20%D0%BA%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D0%B0%D0%BC,Encoding%3A%20gzip%2C%20deflate">[38]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=servlet%3Dcom,%D1%81%D0%BC%D0%BE%D0%B6%D0%B5%D1%82%D0%B5%20%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B8%D1%82%D1%8C%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%20%D0%B8%20%D0%BA">[39]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%9F%D0%A0%D0%90%D0%9A%D0%A2%D0%98%D0%A7%D0%95%D0%A1%D0%9A%D0%98%D0%95%20%D0%A8%D0%90%D0%93%D0%98%201,%D0%95%D1%81%D0%BB%D0%B8%20%D0%B2%D0%BE%D0%B7%D0%BC%D0%BE%D0%B6%D0%BD%D0%BE%2C%20%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9%D1%82%D0%B5">[40]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%82%D1%80%D0%B5%D0%B1%D1%83%D0%B5%D0%BC%D1%83%D1%8E%20%D0%BF%D0%BE%D0%BA%D1%83%D0%BF%D0%BA%D1%83,%D0%93%D0%BB%D0%B0%D0%B2%D1%83%2014">[41]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%BE%D0%B2%2C%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B5%20%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D1%8F%D1%8E%D1%82%20%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5,%D0%9F%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%BD%D0%B5%D0%B4%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%20HTTP">[42]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=,">[43]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=,%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D1%8F%D0%BC%D0%B8%2C%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B5%20%D0%B4%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%20%D1%82%D1%80%D0%B5%D0%B1%D1%83%D1%8E%D1%82%D1%81%D1%8F%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D1%83">[44]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%92%20%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BA%20%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8%20%D1%8D%D1%84%D1%84%D0%B5%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D0%B3%D0%BE,%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D0%B5%D1%82%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D1%8C">[45]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=,6%20%D0%BF%D1%80%D0%B8%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%20%D1%87%D0%B0%D1%81%D1%82%D0%B8%D1%87%D0%BD%D1%8B%D0%B9%20%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80">[46]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=,%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D1%8B%20%D0%BF%D1%80%D0%B8%D0%B2%D0%B8%D0%BB%D0%B5%D0%B3%D0%B8%D0%B9%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%BB%D0%BE%D0%B6%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F">[47]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%BC%20%D0%BC%D0%BE%D0%B3%D1%83%D1%82%20%D0%BE%D0%B1%D1%80%D0%B0%D1%89%D0%B0%D1%82%D1%8C%D1%81%D1%8F%20%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D1%82%D0%B8%D0%BF%D1%8B,%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D0%B5%20%D0%BF%D0%BB%D0%B0%D1%82%D1%84%D0%BE%D1%80%D0%BC%D1%8B%20%D0%B4%D0%BB%D1%8F%20%D0%BE%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0">[48]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%81%D0%B1%D0%B0%D0%BB%D0%B0%D0%BD%D1%81%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C%20%D0%BA%D0%BE%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%BE%20%D1%80%D0%BE%D0%BB%D0%B5%D0%B9%2C%20%D1%87%D1%82%D0%BE%D0%B1%D1%8B%20%D0%BE%D0%BD%D0%B8,deny">[49]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D0%95%D1%81%D0%BB%D0%B8%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D1%8E%D1%82%D1%81%D1%8F%20%D1%81%D1%80%D0%B5%D0%B4%D1%81%D1%82%D0%B2%D0%B0%20%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8F%20%D0%BD%D0%B0,%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%8F%D0%B5%D1%82%20%D1%80%D0%B0%D0%B7%D0%BD%D1%8B%D0%B5%20%D1%83%D1%87%D0%B5%D1%82%D0%BD%D1%8B%D0%B5%20%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8%20%D0%B4%D0%BB%D1%8F">[50]</a> <a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w#:~:text=%D1%81%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D1%8B%20%D1%81%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%C2%AB%D0%B7%D0%B0%D0%BF%D1%80%D0%B5%D1%89%D0%B5%D0%BD%D0%BE,%D0%BD%D0%B8%20%D0%BE%D0%B4%D0%BD%D0%BE%D0%BC%D1%83%20%D0%B8%D0%B7%20%D0%BF%D1%80%D0%B5%D0%B4%D1%8B%D0%B4%D1%83%D1%89%D0%B8%D1%85%20%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB">[51]</a> WAHH - Глава 8.txt</p><p><a href="file://file-HdZZXpPEkbGxwwDDd6Mw1w">file://file-HdZZXpPEkbGxwwDDd6Mw1w</a></p>