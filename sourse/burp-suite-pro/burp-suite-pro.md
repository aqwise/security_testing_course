Сканер уязвимостей Burp Suite Pro



Автор: Vladyslav Koniakhin

Добавьте реакцию
Теория

Burp Suite — это интегрированная платформа, предназначенная для проведения аудита веб-приложения, как в ручном, так и в автоматических режимах. Содержит интуитивно понятный интерфейс со специально спроектированными табами, позволяющими улучшить и ускорить процесс атаки. Сам инструмент представляет из себя проксирующий механизм, перехватывающий и обрабатывающий все поступающие от браузера запросы. Имеется возможность установки сертификата burp для анализа https соединений.

Функционал:

Proxy — перехватывающий прокси-сервер, работающий по протоколу HTTP(S) в режиме man-in-the-middle. Находясь между браузером и веб-приложением он позволит вам перехватывать, изучать и изменять трафик идущий в обоих направлениях. 

Spider/Crawler — паук или краулер, позволяющий вам в автоматическом режиме собирать информацию об архитектуре веб-приложения. 

Scanner — автоматический сканер уязвимостей ( OWASP TOP 10 и т.д.) Доступен в Professional версии, в бесплатной версии только описание возможностей. 

Intruder — утилита, позволяющая в автоматическом режиме производить атаки различного вида, такие как подбор пароля, перебор идентификаторов, фаззинг и так далее. 

Repeater — утилита для модифицирования и повторной отправки, отдельных HTTP-запросов и анализа ответов приложения. 

Sequencer — утилита для анализа генерации случайных данных приложения, выявления алгоритма генерации, предиктивности данных. 

Decoder — утилита для ручного или автоматического преобразования данных вебприложения. 

Comparer — утилита для выявления различий в данных. 

Extender — расширения в BurpSuite. Можно добавлять, как готовые из BApp store, так и собственной разработки.

Настраиваем Burp Suite как прокси

Chrome 

Чтобы настроить Burp в качестве прокси Chrome, нужно выполнить следующие действия: настройки Google Chrome → Advanced → "Open your computer's proxy settings" → в разделе "Manual proxy setup" ставим адрес: 127.0.0.1, порт: 8080. Также, удаляем все со второго инпута.

Firefox

 Чтобы настроить прокси в Firefox, нужно зайти в настройки → найти Network Settings (в самом низу) → Settings... → Manual proxy configuration → в поле HTTP Proxy ставим адрес: 127.0.0.1, порт: 8080. В поле HTTPS Proxy дублируем то же самое. 

Для дальнейшего быстрого переключения прокси-серверов можно использовать плагин FoxyProxy. Проверяем, что все работает. Все действия, совершенные в браузере, будут отображаться в Burp Suite.

image_2025-09-30_10-37-59-20250930-083904.png
Получение сертификата для перехвата HTTPS

После того, как мы настроили Burp как прокси, нам потребуется установить SSL сертификат в корневые сертификаты браузера, для перехвата HTTPS трафика. Выполняем следующие шаги:

 Убедитесь, что Burp запущен и работает. 

 В браузере, переходим по адресу http://burp 

 Скачиваем сертификат по ссылке "CA Certificate"

image_2025-09-30_10-38-14.png
Добавляем сгенерированный сертификат в корневые сертификаты браузера.

Firefox Settings → Privacy and Security → Certificates → View certificates → Import → выбираем ранее скачанный нами сертификат → отмечаем галочку на "Trust this CA to identify websites" → OK. После, перезапускаем браузер.

Burp's embedded Chromium browser 

В большинстве случаев, для тестирования/сканирования, будет достаточно использования встроенного браузера Burp Suite Chromium browser. Перехват HTTPS трафика работает из коробки, что позволяет пропустить пункт "Получение сертификата для перехвата HTTPS". Также, браузер сохраняет настройки, позволяет устанавливать плагины и ничем не отличается от обычного Chrome. Но некоторые современые веб-приложения не позволяют перехватывать трафик именно Chromium.

Как запустить:

image_2025-09-30_10-44-13-20250930-084557.png
Виды сканирования: 

Scan - стандартный вид сканирования, будет рассматриваться в слудующем разделе. 

Live Scan - автоматическое сканирование запросов которые обрабатываются в других разделах Burp (Proxy & Repeater). 

Passive Scan - аудит отправленных запросов и полученных ответов, не изменяя данных. 

Active Scan - быстрый запуск сканирования через контекстное меню, без настроек конфигурации.

Подготовка и запуск сканирования 

Подготовка к сканированию 

При каждом запуске появляется окно, где имеется 3 варианта запуска: 

Temporary project - временный проект, sitemap, сканирование и т.д. не сохраняются. 

New project on disk - сохранение сессии.

Open existing project - открыть ранее сохраненную сессию.

image_2025-09-30_10-52-08-20250930-085403.png
После того как мы выбрали вариант запуска сессии, открывается второе окно с выбором конфигурации сканера: 

Use Burp defaults - стандартная настройка сканера. 

Use options saved with project - запуск сканера с настройками которые были в сохраненном проекте (данный вариант возможен только в случае, если мы запускам уже сохраненную сессию). 

Load from configuration file - запуск Burp с опицями которые есть в конфигурационном файле. 

Чекбоксы: 
1) Default to the above in future - использовать выбранную конфигурацию по умолчанию в будущем. 
2) Disable extensions - запуск сканера без расширений (только встроенный функционал).

image_2025-09-30_10-52-35-20250930-085426.png
Убедитесь, что прокси настроен и работает. После этого, переходим на приложение, которое требуется просканировать и собираем sitemap (вручную ходим по сайту и собираем функционал приложения). Добавляем наше приложение в "Scope".

image_2025-09-30_10-53-11-20250930-085429.png
Начинаем сканирование

Когда мы собрали sitemap приложения, можно приступить к сканированию. Во вкладке "Target" кликаем правой кнопкой мыши по нашему приложению и выбираем "Scan". Открывается "Scan Launcher" где можно настроить конфигурацию сканирования.

image_2025-09-30_10-57-36-20250930-085837.png
В первоем разделе "Scan details" можно увидеть 3 пункта:

Scan Type

Crawl and audit - краулинг выполняется с одного или нескольких начальных URL-адресов, а затем выполняется аудит обнаруженного контента на наличие уязвимостей. Crawl - краулинг выполняется с одного или нескольких начальных URL-адресов, без аудита. Audit selected items - аудит собранного ранее sitemap приложения (доступен только в случае выбора "Scan" через контекстное меню во вкладке "Target").

URLs to Scan

Этот раздел доступен только для "Crawl and audit" и "Crawl". Область сканирования будет ограничиваться указанными в данном поле URL-адресами. Например, если указать url: 
Example Domain  - все содержимое по пути 
Example Domain  будет попадать в поле сканирования. Если указать, https://example.org/myapp/myfolder - все содержимое по пути https://example.org/myapp/ будет попадать в поле сканирования. Чтобы в поле сканирования попадало только содержимое директории "myfolder", нужно добавить "/" в конце папки, чтобы получился такой urlадрес: https://example.org/myapp/myfolder/. С помощью "/" Burp определяет конечную директорию для аудита.

Protocol settings

По умолчанию, в конфигурации будет установлено сканирование с использованием HTTP/HTTPS. Функция недоступна для "Audit selected items". Примечание: если в поле "URLs to Scan", вы добавите только 
Example Domain , то аудит с использованием https проводиться не будет.

Items to Scan 

Данный раздел доступен только при выборе типа "Audit selected items". Здесь будут отображаться разделы которые вы собрали в sitemap. Запросы к одному и тому же url-адресу, но с разными параметрами, будут отбражаться отдельно.

image_2025-09-30_10-57-47-20250930-085840.png
Раздел "Scan configuration"

Данный раздел позволяет сконфигруровать выполнение сканирования. Например, выполнять аудит только на sql-иньекции и т.д.

Раздел "Application login"

Этот раздел доступен только типам "Crawl and audit" и "Crawl". Этот раздел позволяет использовать действительные учетные данные при обнаружении формы входа.

Раздел "Resource pool"

Раздел для настройки нагрузки на приложение, можно настроить кол-во запросов которые сканер будет отправлять одновременно, сконфигурировать время паузы между отправлением запросов. 

После того, как мы настроили сканер, кликаем "Ok" и запускаем сканирование. На вкладке "Dashboard" в окне "Tasks" отображается информация о ходе выполнения задач. Окно "Issue activity" отображает информацию о найденных проблемах о которых сообщает каждая задача.

Ниже, идет описание проблемы, а также, вредоносный запрос и ответ. Весь прогресс сканирования, а также: логи, найденные уязвимости и тд, можно отслеживать через вкладку "View Details".

Dashboard

image_2025-09-30_10-58-01-20250930-085843.png
View details

image_2025-09-30_10-58-09-20250930-085845.png
Чтобы просмотреть найденные уязвимости по конкретному домену, нужно перейти по пути "Target" → "Site map" и выбрать интересующее вас приложение. В окне "Issues" будут отображаться найденные уязвимости относящиеся только к выбранному приложению.

image_2025-09-30_10-58-16-20250930-085853.png
Анализ найденных уязвимостей

True positive срабатывания

Для подтверждения нам надо выполнить такой же запрос, какой сделал сканер и понять, влияет этот запрос на приложение или нет. У сканеров возможны false positive срабатывания. И чтобы не отдавать непроверенный отчет проектной команде, на проверку которого они потратят очень много времени, мы проверим все найденные уязвимости сами.

Path Traversal

image_2025-09-30_11-07-16-20250930-093038.png
В случае, если это GET-запрос, то кликаем ПКМ по запросу и выбираем "Copy URL" и вставляем в браузер.

image_2025-09-30_11-07-28-20250930-093113.png
Если же, уязвимость присутствует в POST-запросе, то есть несколько вариантов: 

 Подставить пэйлоад в уязвимый инпут.

Выполнить такой же новый запрос → перехватить его с помощью "Proxy" → изменить значение уязвимого параметра на наш пэйлоад и отправить.

Cross Site Scripting (Stored)

В данном случае, мы имеем дело с POST-запросом.

image_2025-09-30_11-07-35-20250930-093237.png
Идем по пути: http://10.10.3.84/dvwa/vulnerabilities/xss_s/ → пишем комментарий и перехватываем запрос с помощью "Proxy" (не забудьте перед этим включить функцию перехвата) → изменяем значение уязвимого параметра на наш пэйлоад.

image_2025-09-30_11-07-47-20250930-093304.png
Результат:

image_2025-09-30_11-07-55-20250930-093335.png
Уязвимость подтверждена.

False positive срабатывания

False Cross Site Scripting (Reflected)

Сканер отправил код javascript:alert(1); в параметр "page=". Так как, в ответ сканер получил код ответа сервера 200 и в теле сообщения был этот кусок кода, то он посчитал это уязвимостью. Но на самом деле при таком запросе у сервера произошла просто ошибка и на странице просто отобразился текст ошибки.

image_2025-09-30_11-08-03-20250930-093423.png
Отмечаем уязвимость как False Positive и не добавляем ее в отчет.

image_2025-09-30_11-08-10-20250930-093454.png
Отмечаем уязвимость как False Positive и не добавляем ее в отчет.

Проблемы которые могут возникать во время сканирования

Перегрузка сервера
Иногда, во время сканирования, можно столкнуться с проблемой, что серверу не по силам обработать кол-во запросов, которые отправляет сканер. Чтобы предупредить проблему заранее, периодически проверяем отклик сервера. Если он увеличивается, то приостанавливаем сканирование. Также, в конфигурации сканирования, можно уменьшить нагрузку на сервер во вкладке Resource pool, где можно настроить кол-во запросов которые можно отправлять одновременно и паузу между запросами.

Внезапное завершение сессии
Во время сканирования бывают ситуации, когда сессия истекает и куки становятся невалидными. В таком случае сканирование не может нормально продолжаться и его нужно немедленно остановить. Это может произойти либо потому что в аккаунте долго не производились какие-то действия, либо потому что сканер перешел по ссылке выхода из аккаунта.

Как понять что сессия завершилась?

Во время сканирования смотрите на Event log во вкладке Dashboard. Там будут написаны ошибки которые произошли во время сканирования. Уведомление о завершении сессии выглядит так:

image_2025-09-30_11-08-28-20250930-093643.png
Число в квадратных скобках обозначает количество запросов в которых возникла такая ошибка. Если же ошибка возникла слишком много раз, то лучше исправить проблему и начать сканирование заново.

Как изменить токен авторизации в уже собранном sitemap?

Для этого нам понадобиться расширение "Add Custom Header". Оно сможет заменить один токен на другой. Сверху нужно написать какой хедер мы меняем, а снизу - значение (новый токен). Также работает и с куки-файлами. Если в запросе такого хедера нет, то оно автоматически его допишет.

image_2025-09-30_11-08-33-20250930-093737.png
Как избежать протухания сессии?

Запускать сканирование сразу после сбора сайтмапа.

Не выходить из аккаунта во время сбора сайтмапа.

Удалять из сайтмапа запросы logout и возможно login (но тогда необходимо протестировать логин позже)

 