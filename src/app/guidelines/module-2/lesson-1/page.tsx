
import { ContentPageLayout, P, H2, H3, Ul } from '@/components/content/ContentPageLayout';
import { CodeBlock } from '@/components/content/CodeBlock';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";
import Link from 'next/link';

const LinkStyle = "text-primary hover:text-primary/80 hover:underline";

const sourcesData = [
  { id: 1, text: "Password Cracking 101: Attacks & Defenses Explained - BeyondTrust", url: "https://www.beyondtrust.com/blog/entry/password-cracking-101-attacks-defenses-explained" },
  { id: 2, text: "(PDF) CYBERSECURITY - WEB APPLICATION SECURITY - ResearchGate", url: "https://www.researchgate.net/publication/388223650_CYBERSECURITY_-_WEB_APPLICATION_SECURITY" },
  { id: 3, text: "devploit/awesome-ctf-resources: A list of Capture The Flag (CTF) frameworks, libraries, resources and software for started/experienced CTF players - GitHub", url: "https://github.com/devploit/awesome-ctf-resources" },
  { id: 4, text: "Brute Force Heroes - TryHackMe", url: "https://tryhackme.com/room/bruteforceheroes" },
  { id: 5, text: "Using Burp to Brute Force a Login Page - PortSwigger", url: "https://portswigger.net/support/using-burp-to-brute-force-a-login-page" },
  { id: 6, text: "OWASP Top Security Risks & Vulnerabilities 2021 Edition - Sucuri", url: "https://sucuri.net/guides/owasp_top_10_2021_edition/" },
  { id: 7, text: "A07 Identification and Authentication Failures - OWASP Top 10:2021", url: "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/" },
  { id: 8, text: "OWASP Top 10 2021 vulnerabilities - Cloudkul", url: "https://cloudkul.com/blog/owasp-top-10-2021/" },
  { id: 9, text: "Insecure Cookie Flags - GuardRails", url: "https://docs.guardrails.io/docs/vulnerability-classes/insecure-configuration/cookie-flags" },
  { id: 10, text: "Cookie Security Flags - Invicti", url: "https://www.invicti.com/learn/cookie-security-flags/" },
  { id: 11, text: "A01 Broken Access Control - OWASP Top 10:2021", url: "https://owasp.org/Top10/A01_2021-Broken_Access_Control/" },
  { id: 12, text: "Testing for Insecure Direct Object References - WSTG - Latest | OWASP Foundation", url: "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/04-Testing_for_Insecure_Direct_Object_References" },
  { id: 13, text: "Challenge solutions - Pwning OWASP Juice Shop", url: "https://help.owasp-juice.shop/appendix/solutions.html" },
  { id: 14, text: "Juice-Shop Write-up: Manipulate Basket - GitHub", url: "https://github.com/Whyiest/Juice-Shop-Write-up/blob/main/3-stars/manipulate_basket.md" },
  { id: 15, text: "Cross Site Scripting (XSS) - OWASP Foundation", url: "https://owasp.org/www-community/attacks/xss/" },
  { id: 16, text: "SQL Injection Bypassing WAF - OWASP Foundation", url: "https://owasp.org/www-community/attacks/SQL_Injection_Bypassing_WAF" },
  { id: 17, text: "XSS Filter Evasion: How Attackers Bypass XSS Filters – And Why Filtering Alone Isn't Enough | Acunetix", url: "https://www.acunetix.com/blog/articles/xss-filter-evasion-bypass-techniques/" },
  { id: 18, text: "Complete Cross-site Scripting Walkthrough - Exploit-DB", url: "https://www.exploit-db.com/docs/english/18895-complete-cross-site-scripting-walkthrough.pdf" },
  { id: 19, text: "Hacking the OWASP Juice Shop Series - Challenge #2 (DOM XSS) - YouTube", url: "https://www.youtube.com/watch?v=qTm52tJu4i4" },
  { id: 20, text: "File Inclusion Vulnerabilities - Metasploit Unleashed - OffSec", url: "https://www.offsec.com/metasploit-unleashed/file-inclusion-vulnerabilities/" },
  { id: 21, text: "Testing for Remote File Inclusion - WSTG - v4.2 | OWASP Foundation", url: "https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion" },
  { id: 22, text: "Testing for Local File Inclusion - WSTG - v4.2 | OWASP Foundation", url: "https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion" },
  { id: 23, text: "Statistics-Based OWASP Top 10 2021 Proposal - DZone", url: "https://dzone.com/articles/statistics-based-owasp-top-10-2021-proposal" },
  { id: 24, text: "Arbitrary File Upload Vulnerability At Various Security Levels - Securium Solutions", url: "https://securiumsolutions.com/arbitrary-file-upload-vulnerability-at-various-security-levels/" },
  { id: 25, text: "Security Misconfiguration - Pwning OWASP Juice Shop", url: "https://pwning.owasp-juice.shop/companion-guide/latest/part2/security-misconfiguration.html" },
  { id: 26, text: "Hacking the OWASP Juice Shop Series - Challenge #7 (Error Handling) - YouTube", url: "https://www.youtube.com/watch?v=aFJzZJcxVd8" },
  { id: 27, text: "Docker Logs Location: Where Are Container Logs Stored - Sematext", url: "https://sematext.com/blog/docker-logs-location/" },
  { id: 28, text: "Apache in Docker: How do I \"access.log\"? - Server Fault", url: "https://serverfault.com/questions/763882/apache-in-docker-how-do-i-access-log" },
  { id: 29, text: "Damn Vulnerable Web App", url: "http://webguvenligi.org/dergi/DamnVulnerableWebApp-Aralik2009-RyanDewhurst.pdf" },
  { id: 30, text: "Building a Web Hacking Lab (w/ XAMPP and DVWA) - YouTube", url: "https://www.youtube.com/watch?v=XCqSQJapP7M" },
  { id: 31, text: "Hands-On Web Penetration Testing with Kali Linux: Getting to Know the DVWA Interface|packtpub.com - YouTube", url: "https://www.youtube.com/watch?v=fWN9l0eV2fw" },
  { id: 32, text: "Fingerprint Web Application Framework - WSTG - Latest | OWASP Foundation", url: "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework" },
  { id: 33, text: "OWASP Secure Headers Project", url: "https://owasp.org/www-project-secure-headers/" },
];

export default function Module2Lesson1Page() {
  return (
    <ContentPageLayout
      title="Урок 1: Основные Механизмы Защиты – Фундамент Безопасности Веб-Приложений (WAHH2, Глава 2)"
      subtitle="Модуль II: Разведка и Картирование Приложения"
    >
      <H3 id="s1-1">
        <Link href="#s1-1" className={LinkStyle}>1.1</Link> Введение в Основные Механизмы Защиты
      </H3>
      <P>
        Ключевые механизмы защиты, описанные в Главе 2 "Web Application Hacker's Handbook, Second Edition" (WAHH2), формируют концептуальную основу для всего процесса тестирования на проникновение и обеспечения безопасности веб-приложений. Эти механизмы представляют собой идеализированную модель того, как приложение должно защищать себя от различных угроз. Они охватывают четыре фундаментальных аспекта: обработку доступа пользователя, обработку пользовательского ввода, адекватную реакцию на действия злоумышленника и безопасное управление самим приложением.
      </P>
      <P>
        Глубокое понимание этих столпов безопасности позволяет не только выстраивать эффективную оборону, но и, с точки зрения атакующего, целенаправленно искать отклонения от этих идеалов. Именно в этих отклонениях, ошибках реализации или отсутствующих проверках и кроются уязвимости, которые могут быть эксплуатированы. Данный урок посвящен детальному разбору каждого из этих механизмов с практическими заданиями для закрепления материала.
      </P>

      <H3 id="s1-2">
        <Link href="#s1-2" className={LinkStyle}>1.2</Link> Обработка Доступа Пользователя
      </H3>
      <P>
        Обработка доступа пользователя является краеугольным камнем безопасности любого веб-приложения, требующего разграничения прав и персонализации взаимодействия. Этот процесс включает три ключевых компонента: аутентификацию, управление сессиями и контроль доступа. Недостатки в любом из этих компонентов могут привести к серьезным последствиям, от несанкционированного доступа к учетным записям до полного контроля над приложением.
      </P>

      <H3 id="s1-2-1">
        <Link href="#s1-2-1" className={LinkStyle}>1.2.1</Link> Аутентификация
      </H3>
      <P>
        Аутентификация – это процесс проверки личности пользователя, как правило, посредством предоставления учетных данных, таких как логин и пароль. Надежность системы аутентификации напрямую влияет на общую безопасность приложения. Слабые механизмы аутентификации, такие как использование легко подбираемых паролей, отсутствие защиты от атак перебора (brute-force) или небезопасные процедуры восстановления пароля, могут привести к несанкционированному доступу [WAHH2 1.2.1].
      </P>
      <P>
        Атаки на механизмы аутентификации чрезвычайно распространены. Злоумышленники могут использовать списки распространенных паролей 1 или специализированные инструменты для автоматизации подбора учетных данных. Отсутствие ограничений на количество попыток входа или недостаточная сложность парольной политики значительно упрощают такие атаки.
      </P>
      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.2.1.A: Атака Перебора (Brute-Force) на Форму Входа</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Продемонстрировать возможность подбора учетных данных пользователя с использованием автоматизированных инструментов при отсутствии адекватных мер защиты от атак перебора.</P>
          <P><strong>Среда:</strong> Damn Vulnerable Web Application (DVWA), уровень безопасности "Low".</P>
          <P><strong>Инструменты:</strong> Hydra, Burp Suite (Intruder).</P>
          <P><strong>Шаги (используя Hydra для GET-запроса на DVWA Low):</strong></P>
          <Ul items={[
            "Определить параметры запроса на вход в DVWA. На уровне \"Low\" это GET-запрос к http://<DVWA_IP>/vulnerabilities/brute/ с параметрами username и password. Сообщение об ошибке при неверном входе обычно содержит \"Username and/or password incorrect.\".2",
            "Подготовить списки логинов (например, user.txt с admin) и паролей (например, pass.txt с распространенными паролями, такими как \"password\", \"12345\", \"qwerty\" 1).",
            <>Сформировать команду Hydra. Пример команды для DVWA Low (GET-запрос): 
              <CodeBlock code={'hydra -L user.txt -P pass.txt <DVWA_IP> http-get-form "/vulnerabilities/brute/index.php:username=^USER^&password=^PASS^&Login=Login:Username and/or password incorrect." -V'} />
              <Ul items={[
                "<strong>-L user.txt:</strong> Файл со списком пользователей.",
                "<strong>-P pass.txt:</strong> Файл со списком паролей.",
                "<strong>&lt;DVWA_IP&gt;:</strong> IP-адрес DVWA.",
                "<strong>http-get-form:</strong> Указание на использование HTTP GET.",
                "<strong>\"/vulnerabilities/brute/index.php:username=^USER^&password=^PASS^&Login=Login:Username and/or password incorrect.\":</strong> Путь, параметры формы (^USER^ и ^PASS^ будут заменены значениями из списков) и строка, указывающая на неудачную попытку входа.2",
                "<strong>-V:</strong> Включить подробный вывод."
              ]}/>
            </>
          ]}/>
          <P><strong>Шаги (используя Burp Suite Intruder):</strong></P>
          <Ul items={[
            "Перехватить запрос на вход в DVWA с помощью Burp Proxy.",
            "Отправить запрос в Burp Intruder (ПКМ -> \"Send to Intruder\").5",
            "В Intruder, на вкладке \"Positions\", выбрать тип атаки \"Cluster bomb\".",
            "Выделить значения параметров username и password и добавить их как позиции для перебора (\"Add §\").5",
            <>На вкладке "Payloads":
              <Ul items={[
                "Для \"Payload set 1\" (username) выбрать тип \"Simple list\" и загрузить список пользователей.5",
                "Для \"Payload set 2\" (password) выбрать тип \"Simple list\" и загрузить список паролей.5"
              ]}/>
            </>,
            "Запустить атаку и анализировать ответы. Успешный вход обычно отличается по коду ответа (например, 302 Found) или длине ответа."
          ]}/>
          <P><strong>Ожидаемый Результат:</strong> Успешный подбор учетных данных (например, admin/password для DVWA Low).</P>
          <P><strong>Контекст OWASP Top 10:</strong> Эта уязвимость относится к A07:2021-Identification and Authentication Failures.6 Отсутствие защиты от перебора является прямым нарушением этого пункта.</P>
          <P>Успешное выполнение данной атаки наглядно демонстрирует, что простая форма входа без защиты от перебора учетных записей является легкодоступной мишенью. Злоумышленнику достаточно иметь список распространенных или потенциальных паролей и логинов, чтобы с высокой вероятностью получить несанкционированный доступ. Это подчеркивает критическую важность внедрения таких мер, как ограничение количества попыток входа, CAPTCHA и многофакторная аутентификация.7</P>
        </CardContent>
      </Card>

      <H3 id="s1-2-2">
        <Link href="#s1-2-2" className={LinkStyle}>1.2.2</Link> Управление Сессиями
      </H3>
      <P>
        После успешной аутентификации необходимо поддерживать состояние пользователя между многочисленными HTTP-запросами, поскольку HTTP сам по себе является протоколом без сохранения состояния. Эту задачу решает управление сессиями, обычно реализуемое с помощью токенов сессии. Эти токены передаются между клиентом и сервером, идентифицируя аутентифицированного пользователя. Безопасность управления сессиями зависит от генерации криптостойких, непредсказуемых токенов, их надежной передачи (например, через HTTPS и с флагом HttpOnly для cookie) и своевременной инвалидации при выходе пользователя из системы или по истечении времени неактивности [WAHH2 1.2.2].
      </P>
      <P><strong>Вопрос из теста для самоконтроля (WAHH2):</strong> "Какой HTTP-заголовок может использоваться сервером для установки идентификатора сессии в браузере пользователя?".</P>
      <P><em>Правильный ответ: A) Set-Cookie, так как именно этот заголовок используется для передачи сессионных (и других) cookie клиенту.</em></P>
      <P>
        Небезопасная конфигурация cookie, используемых для передачи токенов сессии, может привести к их перехвату или использованию в различных атаках, таких как XSS или CSRF.
      </P>
      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.2.2.A: Анализ Флагов Безопасности Cookie Сессии</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Проанализировать флаги безопасности, установленные для cookie сессии, и понять их значение.</P>
          <P><strong>Среда:</strong> DVWA (любой уровень безопасности, после входа в систему).</P>
          <P><strong>Инструменты:</strong> Браузерные инструменты разработчика (Developer Tools).</P>
          <P><strong>Шаги:</strong></P>
          <Ul items={[
            "Войти в DVWA.",
            "Открыть инструменты разработчика в браузере (обычно F12) и перейти на вкладку \"Application\" (Chrome) или \"Storage\" (Firefox).",
            "В разделе \"Cookies\" найти cookie с именем PHPSESSID (или аналогичное, в зависимости от приложения).",
            "Проверить наличие и значения флагов HttpOnly, Secure, SameSite.9"
          ]}/>
          <P><strong>Ожидаемый Результат:</strong> Определение, какие флаги установлены для PHPSESSID. Например, в стандартной конфигурации DVWA флаг Secure может отсутствовать, если доступ осуществляется по HTTP. Флаг HttpOnly обычно присутствует.</P>
          <P><strong>Контекст OWASP Top 10:</strong> Неправильная конфигурация флагов cookie относится к A05:2021-Security Misconfiguration.6 Если токены сессии слабые или предсказуемые, это также может затрагивать A02:2021-Cryptographic Failures.</P>
          <P>Отсутствие флага Secure позволяет передавать cookie по незащищенному HTTP-соединению, что делает их уязвимыми для перехвата. Отсутствие флага HttpOnly позволяет JavaScript-коду на странице получить доступ к cookie, что критично при XSS-атаках.9 Флаг SameSite помогает защититься от CSRF-атак, ограничивая отправку cookie с межсайтовыми запросами.10 Анализ этих флагов является важным шагом в оценке безопасности управления сессиями.</P>
        </CardContent>
      </Card>
      
      <H3 id="s1-2-3">
        <Link href="#s1-2-3" className={LinkStyle}>1.2.3</Link> Контроль Доступа (Авторизация)
      </H3>
      <P>
        Контроль доступа, или авторизация, – это механизм, определяющий, какие действия и ресурсы доступны конкретному пользователю после его успешной аутентификации. Если аутентификация отвечает на вопрос "Кто вы?", то авторизация отвечает на вопрос "Что вам разрешено делать?". Эффективный контроль доступа реализует принцип наименьших привилегий, гарантируя, что пользователи имеют доступ только к тем функциям и данным, которые необходимы для выполнения их задач [WAHH2 1.2.3]. Ошибки в логике контроля доступа часто приводят к серьезным уязвимостям, таким как небезопасные прямые ссылки на объекты (IDOR), когда атакующий, изменяя идентификатор в запросе, может получить доступ к данным другого пользователя. Эта категория уязвимостей занимает первое место в OWASP Top 10 2021 (A01:2021 – Broken Access Control).6
      </P>
      <P><strong>Вопрос из теста для самоконтроля (WAHH2):</strong> "Какой из перечисленных механизмов отвечает за проверку того, какие действия разрешены пользователю после входа в систему?".</P>
      <P><em>Корректным ответом является: C) Контроль доступа (Авторизация).</em></P>
      <P>
        Уязвимости IDOR возникают, когда приложение доверяет идентификаторам объектов, передаваемым пользователем, без должной проверки прав доступа текущего пользователя к запрашиваемому объекту.12
      </P>
      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.2.3.A: Эксплуатация Небезопасных Прямых Ссылок на Объекты (IDOR)</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Продемонстрировать несанкционированный доступ к данным другого пользователя путем манипулирования ссылками на объекты.</P>
          <P><strong>Среда:</strong> OWASP Juice Shop.</P>
          <P><strong>Целевое Задание:</strong> "View another user's shopping basket" 13 или "Manipulate Basket" / "Put an additional product into another user's shopping basket".13</P>
          <P><strong>Инструменты:</strong> Браузерные инструменты разработчика, Burp Suite Proxy.</P>
          <P><strong>Шаги (на основе 13):</strong></P>
          <Ul items={[
            "Войти в систему как пользователь (например, user1). Добавить товары в его корзину.",
            "Наблюдать за HTTP-запросами для операций с корзиной (например, с помощью Burp Suite или инструментов разработчика). Идентифицировать параметр BasketId или аналогичный. В 13 упоминается поиск bid в Session Storage. В 14 упоминается BasketId в теле запроса.",
            "Попытаться получить доступ/изменить корзину другого пользователя, изменив BasketId (например, увеличив/уменьшив идентификатор). Если известен BasketId другого пользователя (например, путем регистрации второго пользователя или перебора), подставить его.",
            "Для задания \"Manipulate Basket\" 13 это может включать атаку HTTP Parameter Pollution (HPP), отправив дублирующиеся параметры BasketId: {\"ProductId\": X, \"BasketId\": \"yourOwnBasketId\", \"quantity\": 1, \"BasketId\": \"victimBasketId\"}. Сервер может обработать первый BasketId для проверки безопасности, а второй – для выполнения операции.14"
          ]}/>
          <P><strong>Ожидаемый Результат:</strong> Успешный просмотр или изменение корзины другого пользователя, решение соответствующего задания в Juice Shop.</P>
          <P><strong>Контекст OWASP Top 10:</strong> IDOR является классическим примером A01:2021-Broken Access Control.11</P>
          <P>Уязвимость IDOR существует из-за того, что приложение доверяет предоставленным пользователем идентификаторам без достаточных проверок авторизации на стороне сервера для этого конкретного ресурса и пользователя. Злоумышленники эксплуатируют это, просто изменяя идентификатор. Техника HPP, описанная в 14, демонстрирует более продвинутый способ обхода простых проверок, когда сервер некорректно обрабатывает дублирующиеся параметры. IDOR-уязвимости чрезвычайно распространены и могут приводить к значительным утечкам данных или несанкционированным действиям, подчеркивая критическую необходимость применения проверок авторизации в каждой точке, где доступ к данным или функциям осуществляется на основе контролируемых пользователем идентификаторов.</P>
        </CardContent>
      </Card>

      <H3 id="s1-3">
        <Link href="#s1-3" className={LinkStyle}>1.3</Link> Обработка Пользовательского Ввода: Поле Мин для Уязвимостей
      </H3>
      <P>
        Веб-приложения по своей природе обрабатывают огромное количество данных, поступающих от пользователей из разнообразных источников. Недостаточная или некорректная обработка этого ввода является одной из наиболее частых причин возникновения уязвимостей. Каждая точка ввода данных представляет собой потенциальный вектор атаки.
      </P>

      <H3 id="s1-3-1">
        <Link href="#s1-3-1" className={LinkStyle}>1.3.1</Link> Повсеместность Пользовательского Ввода и Присущие Риски (из WAHH2 1.3.1)
      </H3>
      <P>
        Источники пользовательского ввода многообразны: URL-адреса и их параметры, HTTP-заголовки (например, User-Agent, Referer), тело HTTP-запроса (данные форм, JSON, XML), а также значения cookie [WAHH2 1.3.1]. Каждый из этих источников потенциально может содержать вредоносные данные, поэтому необходима их тщательная проверка на стороне сервера. Разработчики могут сосредоточиться на очевидных полях форм, пренебрегая менее очевидными источниками, такими как HTTP-заголовки или даже метаданные файлов, что расширяет поверхность атаки. Примеры атак через различные векторы ввода, такие как XSS через HTTP-заголовки 15 или SQL-инъекции через параметры GET/POST запросов 16, подчеркивают необходимость комплексной валидации всех входящих данных.
      </P>

      <H3 id="s1-3-2">
        <Link href="#s1-3-2" className={LinkStyle}>1.3.2</Link> Стратегии Валидации: Белые Списки, Черные Списки, Граничные Проверки
      </H3>
      <P>
        Существует два основных подхода к валидации ввода: использование "черных списков" (blacklisting) и "белых списков" (whitelisting) [WAHH2 1.3.2].
      </P>
      <P>
        Черный список определяет запрещенные символы или паттерны. Этот подход часто оказывается неэффективным, так как атакующие постоянно находят способы обхода таких списков, используя различные кодировки или не учтенные разработчиком векторы.17
      </P>
      <P>
        Белый список, напротив, определяет разрешенные символы, форматы или значения. Все, что не соответствует белому списку, отвергается. Этот подход считается более надежным [WAHH2 1.3.2].
      </P>
      <P><strong>Вопрос из теста для самоконтроля (WAHH2):</strong> "Что такое "белый список" (whitelist) при валидации ввода?".</P>
      <P><em>Правильный ответ: C) Список разрешенных символов, форматов или значений.</em></P>
      <P>
        Граничная валидация включает проверку типов данных (например, является ли значение числом, строкой, датой), их длины (не превышает ли строка максимально допустимую длину), формата (соответствует ли электронный адрес ожидаемому формату) и диапазона (находится ли число в допустимых пределах) [WAHH2 1.3.3].
      </P>
      <P>
        Критически важно понимать, что любая валидация, выполненная на стороне клиента (например, с помощью JavaScript), должна рассматриваться лишь как улучшение пользовательского опыта, но никогда не как мера безопасности. Решающая валидация всегда должна происходить на стороне сервера, поскольку клиентские проверки могут быть легко обойдены [WAHH2 1.3.3].
      </P>
      <P>
        Черные списки являются фундаментально ошибочным подходом к безопасности, поскольку требуют предвидения всех возможных вредоносных входных данных, что практически невозможно. Белые списки по своей сути безопаснее, так как определяют узкий диапазон допустимых входных данных. Многочисленные техники обхода XSS-фильтров, такие как использование различных кодировок, вариаций регистра и альтернативных тегов 17, часто успешно применяются против фильтров на основе черных списков, что еще раз подтверждает превосходство белых списков.
      </P>
      <H3>Таблица: Сравнение Подходов к Валидации Ввода</H3>
      <div className="overflow-x-auto my-6">
        <Table>
          <TableHeader>
            <TableRow>
              <TableHead>Подход</TableHead>
              <TableHead>Описание (из WAHH2 1.3.2)</TableHead>
              <TableHead>Преимущества</TableHead>
              <TableHead>Недостатки</TableHead>
              <TableHead>Рекомендуемое Использование</TableHead>
            </TableRow>
          </TableHeader>
          <TableBody>
            <TableRow>
              <TableCell>Белый список</TableCell>
              <TableCell>Определяет разрешенные символы, форматы или значения.</TableCell>
              <TableCell>Более безопасный, отклоняет неизвестные входные данные.</TableCell>
              <TableCell>Может быть более строгим, если не спроектирован тщательно.</TableCell>
              <TableCell>Основной метод для валидации безопасности.</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Черный список</TableCell>
              <TableCell>Определяет запрещенные символы или паттерны.</TableCell>
              <TableCell>Проще в реализации для известных вредоносных данных.</TableCell>
              <TableCell>Легко обходится атакующими с использованием кодировок, вариаций, новых векторов.</TableCell>
              <TableCell>Обычно не рекомендуется в качестве основной меры безопасности. Может дополнять белый список в специфических, ограниченных случаях.</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Граничные проверки</TableCell>
              <TableCell>Валидирует тип, длину, формат, диапазон.</TableCell>
              <TableCell>Отлавливает некорректные или выходящие за пределы данные.</TableCell>
              <TableCell>Не останавливает вредоносную логику, если данные соответствуют границам.</TableCell>
              <TableCell>Необходимая часть комплексной валидации, используется с белым списком.</TableCell>
            </TableRow>
          </TableBody>
        </Table>
      </div>
      <P>
        Эта таблица наглядно демонстрирует различия между белыми и черными списками, опираясь на определения из WAHH2 и примеры обхода из 17 и.18 Она служит кратким руководством для понимания, почему белый список является предпочтительной стратегией безопасности, напрямую поддерживая основную идею урока по обработке ввода.
      </P>

      <H3 id="s1-3-3">
        <Link href="#s1-3-3" className={LinkStyle}>1.3.3</Link> Каноникализация: Противодействие Техникам Уклонения (из WAHH2 1.3.4)
      </H3>
      <P>
        Данные, поступающие от пользователя, могут быть представлены в различных формах, например, с использованием разных кодировок (URL-encoding, HTML-encoding, Base64) или с вариациями регистра символов. Каноникализация – это процесс приведения данных к единому, стандартному, минимальному формату перед их валидацией [WAHH2 1.3.4]. Это критически важный шаг для предотвращения обхода проверок. Например, если валидатор ищет строку &lt;script&gt;, атакующий может попытаться обойти его, используя смешанный регистр (&lt;ScRiPt&gt;) или кодируя часть символов (например, %3Cscript%3E). Каноникализация преобразует все эти варианты в единую форму (например, &lt;script&gt;), которую затем проверяет валидатор.
      </P>
      <P><strong>Вопрос из теста для самоконтроля (WAHH2):</strong> "Зачем нужна каноникализация данных перед валидацией?".</P>
      <P><em>Правильный ответ: C) Чтобы привести данные к единому стандартному формату и предотвратить обход проверок с помощью разных кодировок.</em></P>
      <P>
        Многоэтапная валидация может потребоваться, когда данные проходят через несколько этапов обработки или декодирования [WAHH2 1.3.4]. Отсутствие каноникализации перед валидацией является распространенной ошибкой, которая делает многие средства контроля валидации неэффективными даже против умеренно квалифицированных злоумышленников. Атакующие специально используют кодирование и обфускацию для обхода фильтров.17 Если приложение не выполняет каноникализацию этих входных данных перед проверкой по черному списку (или даже по шаблону белого списка), обход будет успешным. Это демонстрирует прямую связь между каноникализацией и эффективной валидацией.
      </P>

      <H3 id="s1-3-4">
        <Link href="#s1-3-4" className={LinkStyle}>1.3.4</Link> Распространенные Атаки на Основе Ввода и Практическая Эксплуатация
      </H3>
      <P>
        Этот подраздел предоставляет практический опыт работы с наиболее распространенными уязвимостями, связанными с валидацией ввода.
      </P>
      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.3.4.A: Межсайтовый Скриптинг (XSS)</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Понять и эксплуатировать отраженный (Reflected), хранимый (Stored) и DOM-based XSS.</P>
          <P><strong>Концепции:</strong></P>
          <Ul items={[
            "Отраженный XSS: Ввод немедленно отражается на странице (например, в результатах поиска, сообщении об ошибке).15",
            "Хранимый XSS: Вредоносный скрипт сохраняется на сервере (например, в базе данных, в профиле пользователя, комментарии) и затем отображается другим пользователям.13",
            "DOM XSS: Уязвимость в клиентском коде; полезная нагрузка может не достигать сервера. Манипуляция происходит в Document Object Model (DOM) браузера.15"
          ]}/>
          <P><strong>Воздействие:</strong> Кража cookie, перехват сессий, дефейсмент, доставка вредоносного ПО.15</P>
          <P><strong>Среда и Задания:</strong></P>
          <Ul items={[
            "DVWA (Уровни безопасности Low и Medium) - Reflected XSS, Stored XSS.",
            "Low: Простой ввод <script>alert('XSS')</script>.",
            "Medium: Обход str_replace('&lt;script&gt;', '') с использованием таких техник, как &lt;SCRIPT&gt;, &lt;img src=x onerror=alert(1)&gt;, или вложенных тегов, если применимо (например, &lt;scr&lt;script&gt;ipt&gt;). 18 показывает обход изменением регистра17 упоминает альтернативные теги и обработчики событий.",
            "OWASP Juice Shop:",
            "\"Perform a DOM XSS attack\".13 Пример полезной нагрузки: &lt;iframe src=\"javascript:alert('xss')\"&gt; в строке поиска.",
            "\"Perform a persisted XSS attack\" (например, \"Zero Stars\" или \"Product Tampering\" для внедрения XSS в отзывы о товарах).13",
            "\"Bonus Payload\" / XSS через HTTP-заголовок (например, User-Agent).13"
          ]}/>
          <P><strong>Инструменты:</strong> Браузер, Burp Suite.</P>
          <P><strong>Ожидаемый Результат:</strong> Успешное появление всплывающих окон XSS (alert). Понимание различных типов XSS и базовых техник обхода.</P>
          <P><strong>Контекст OWASP Top 10:</strong> XSS является частью A03:2021-Injection.6</P>
          <P>Злоумышленники не ограничиваются простым &lt;script&gt;. Они используют широкий спектр техник уклонения (кодирование, различные теги, обработчики событий, вариации регистра), как показано в 17 и.18 Это делает простые фильтры на основе черных списков крайне неэффективными. XSS остается распространенной уязвимостью, поскольку корректная санация вывода для всех возможных контекстов, где может отображаться пользовательский ввод, является сложной задачей. DOM XSS 19 подчеркивает, что клиентский код также является значительным источником уязвимостей. Неэффективность фильтра DVWA Medium 18 напрямую иллюстрирует утверждение WAHH2 о слабости черных списков.</P>
        </CardContent>
      </Card>

      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.3.4.B: SQL-инъекция (SQLi)</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Понять, как команды SQL могут быть внедрены через пользовательский ввод для манипулирования запросами к базе данных.</P>
          <P><strong>Концепции:</strong> Добавление синтаксиса SQL к полям ввода для изменения логики запроса. Union-based, error-based, blind SQLi (кратко).</P>
          <P><strong>Среда и Задания:</strong></P>
          <Ul items={[
            "DVWA (Уровни безопасности Low и Medium) - SQL Injection, SQL Injection (Blind).",
            "Low: ' OR '1'='1 для обхода входа или 1' UNION SELECT user, password FROM users # для извлечения учетных данных.",
            "Medium: На среднем уровне DVWA для SQL-инъекции часто используется выпадающий список, что требует перехвата запроса с помощью Burp Suite для внедрения полезной нагрузки. Также может применяться функция mysql_real_escape_string(). Обход может включать числовые инъекции, если ввод ожидается как целое число (например, 1 UNION SELECT user, password FROM users # без кавычек), или различные кодировки, если функция экранирования имеет недостатки (хотя это менее вероятно для самой mysql_real_escape_string). Некоторые принципы обхода WAF, такие как нормализация или загрязнение параметров 16, могут быть концептуально адаптированы, если на среднем уровне есть специфические фильтры."
          ]}/>
          <P><strong>Инструменты:</strong> Браузер, Burp Suite, (опционально sqlmap для продвинутых).</P>
          <P><strong>Ожидаемый Результат:</strong> Успешный обход входа, извлечение данных.</P>
          <P><strong>Контекст OWASP Top 10:</strong> SQLi является основным примером A03:2021-Injection.6</P>
          <P>Хотя параметризованные запросы являются основной защитой, устаревший код или неправильное использование ORM все еще могут приводить к SQLi. Пример DVWA Medium показывает, что даже базовые попытки санации могут быть ошибочными, если они не являются всеобъемлющими. Злоумышленники проявляют большую изобретательность в обходе защитных мер, как показывают техники обхода WAF.16 Одна единственная уязвимость SQLi может скомпрометировать всю базу данных, приводя к массовым утечкам данных.</P>
        </CardContent>
      </Card>

      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.3.4.C: Включение Файлов (LFI/RFI)</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Включить и просмотреть/выполнить локальные или удаленные файлы через уязвимые параметры ввода.</P>
          <P><strong>Концепции:</strong></P>
          <Ul items={[
            "Local File Inclusion (LFI): Доступ к файлам на сервере (например, /etc/passwd, исходный код, логи).20",
            "Remote File Inclusion (RFI): Включение файлов с внешнего сервера (менее распространено, если allow_url_include отключен в PHP).20",
            "Directory Traversal: Использование ../ для навигации по файловой системе."
          ]}/>
          <P><strong>Среда и Задания:</strong></P>
          <Ul items={[
            "DVWA (Уровни безопасности Low и Medium) - File Inclusion.",
            "Low: ?page=../../../../etc/passwd.20",
            "Medium: На среднем уровне DVWA часто применяются замены типа str_replace( array( \"http://\", \"https://\" ), \"\", $file ); и str_replace( array( \"../\", \"..\\\"\" ), \"\", $file );. Обходы для среднего уровня могут включать:",
            "?page=....//....//....//....//etc/passwd (если ../ заменяется на пустую строку, это может превратиться в ../../../../etc/passwd после нескольких замен).",
            "Использование абсолютных путей, если они известны: ?page=/etc/passwd.",
            "Вариации регистра, если фильтр чувствителен к регистру (например, ?page=..%2F..%2Fetc/passwd, если фильтруется только ../). Фильтр str_replace по умолчанию чувствителен к регистру."
          ]}/>
          <P><strong>Инструменты:</strong> Браузер.</P>
          <P><strong>Ожидаемый Результат:</strong> Отображение содержимого чувствительных файлов.</P>
          <P><strong>Контекст OWASP Top 10:</strong> LFI/RFI могут относиться к A01:2021-Broken Access Control (доступ к неавторизованным файлам) или A03:2021-Injection (если это приводит к выполнению кода).2322 подчеркивает, что LFI приводит к раскрытию конфиденциальной информации.</P>
          <P>LFI может быть ступенькой для более сложных атак. Злоумышленник может использовать LFI для чтения конфигурационных файлов с целью поиска учетных данных базы данных (что поможет в SQLi) или для чтения исходного кода для поиска других уязвимостей. Если также возможна загрузка файлов, LFI может быть использована для выполнения загруженной вредоносной оболочки.24 Уязвимости включения файлов возникают, когда имена файлов/пути из пользовательского ввода не проходят должную санацию. Включение файлов может привести к полной компрометации сервера, особенно если возможно RFI или LFI можно скомбинировать с другими уязвимостями, такими как загрузка файлов, для достижения выполнения кода.</P>
        </CardContent>
      </Card>
      
      <H3 id="s1-4">
        <Link href="#s1-4" className={LinkStyle}>1.4</Link> Реакция на Действия Злоумышленника: Обнаружение и Ответ
      </H3>
      <P>
        Помимо превентивных мер, приложение должно уметь корректно реагировать на попытки атак или аномальное поведение. Это включает безопасную обработку ошибок, ведение подробных аудиторских логов и наличие механизмов оповещения и реагирования.
      </P>

      <H3 id="s1-4-1">
        <Link href="#s1-4-1" className={LinkStyle}>1.4.1</Link> Безопасная Обработка Ошибок: Избежание Утечки Информации (из WAHH2 1.4.1)
      </H3>
      <P>
        При возникновении ошибок приложение не должно раскрывать чувствительную информацию, которая может помочь атакующему. Детальные сообщения об ошибках SQL, пути к файлам на сервере, версии программного обеспечения или фрагменты кода являются примерами такой утечки информации [WAHH2 1.4.1]. Вместо этого пользователю следует показывать общие сообщения об ошибках, а детальная информация должна логироваться на сервере для анализа администраторами.
      </P>
      <P><strong>Вопрос из теста для самоконтроля (WAHH2):</strong> "Какой принцип безопасности нарушается, если приложение отображает детальные сообщения об ошибках SQL или пути к файлам на сервере?".</P>
      <P><em>Верный ответ: C) Предотвращение утечки информации (Information Leakage Prevention).</em></P>
      <P>
        Раскрытие такой информации может значительно упростить задачу злоумышленнику, предоставляя ему сведения о внутренней структуре приложения, используемых технологиях и потенциальных точках входа для других атак.
      </P>
      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.4.1.A: Провоцирование и Анализ Детализированных Ошибок</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Выявить случаи, когда приложение раскрывает чувствительную информацию через сообщения об ошибках.</P>
          <P><strong>Среда:</strong> OWASP Juice Shop.</P>
          <P><strong>Целевое Задание:</strong> "Provoke an error that is neither very gracefully nor consistently handled".25</P>
          <P><strong>Инструменты:</strong> Браузер, Burp Suite.</P>
          <P><strong>Шаги (на основе 25):</strong></P>
          <Ul items={[
            "Попробовать отправить некорректный ввод в формы (например, неожиданные типы данных, слишком длинные строки).",
            "Манипулировать URL-путями или параметрами.",
            "Отправить неожиданные HTTP-методы или некорректно сформированные запросы.",
            "Конкретно для Juice Shop26 показывает пример вызова ошибки SQL путем ввода одинарной кавычки в поле входа (например, u'). Наблюдать, раскрывает ли сообщение об ошибке синтаксис SQL, тип базы данных (SQLite в 26) или части запроса."
          ]}/>
          <P><strong>Ожидаемый Результат:</strong> Сообщение об ошибке, которое раскрывает внутренние детали о приложении или сервере, решая задание Juice Shop.</P>
          <P>Злоумышленники используют утекшую из сообщений об ошибках информацию для понимания стека технологий приложения (например, "SQLite" из 26), структуры базы данных, путей к файлам или даже для подтверждения уязвимостей, таких как SQLi. Подробные сообщения об ошибках снижают планку для атакующих, предоставляя им бесплатную разведку, которая может значительно помочь в дальнейшей эксплуатации.</P>
        </CardContent>
      </Card>

      <H3 id="s1-4-2">
        <Link href="#s1-4-2" className={LinkStyle}>1.4.2</Link> Ведение Аудиторских Логов: Инструментарий Следователя (из WAHH2 1.4.2)
      </H3>
      <P>
        Запись важных событий безопасности в аудиторские логи является неотъемлемой частью стратегии защиты. Логи должны фиксировать такие события, как успешные и неуспешные попытки входа, изменения прав доступа, доступ к критически важным данным и другие значимые операции [WAHH2 1.4.2]. Эти логи помогают в расследовании инцидентов и выявлении подозрительной активности. Хороший аудиторский лог должен содержать как минимум временную метку, IP-адрес источника, идентификатор пользователя (если применимо), тип события и его результат.
      </P>
      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.4.2.A: (Концептуальный или Лабораторный) Обзор Логов Приложения</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Понять тип информации, содержащейся в логах, и ее полезность.</P>
          <P><strong>Среда:</strong></P>
          <Ul items={[
            "При использовании Docker-контейнеров DVWA/Juice Shop, найти логи Apache/приложения (в 27 обсуждаются расположения логов Docker, обычно /var/lib/docker/containers/<container_id>/<container_id>-json.log для STDOUT/STDERR контейнера, или специфичные пути, такие как /var/log/apache2, если настроено внутри контейнера).",
            "DVWA имеет интеграцию с PHPIDS (система обнаружения вторжений).29 По возможности изучить его логи, чтобы увидеть, как он помечает вредоносные попытки."
          ]}/>
          <P><strong>Шаги:</strong></P>
          <Ul items={[
            "Выполнить некоторые действия в приложении (вход, неудачный вход, попытка XSS).",
            "Получить доступ и просмотреть соответствующие файлы логов.",
            "Определить записи, соответствующие выполненным действиям.",
            "Обсудить, предоставляют ли логи достаточно деталей для расследования."
          ]}/>
          <P><strong>Ожидаемый Результат:</strong> Ознакомление с содержимым логов и понимание важности детального логирования.</P>
          <P>Недостаточное логирование (OWASP Top 10 A09:2021-Security Logging and Monitoring Failures 6) является серьезной проблемой. Без логов почти невозможно обнаружить атаку в процессе или расследовать взлом постфактум. Эффективное логирование — это не просто техническое требование, а критически важный компонент общей системы безопасности организации и ее способности реагировать на инциденты.</P>
        </CardContent>
      </Card>

      <H3 id="s1-4-3">
        <Link href="#s1-4-3" className={LinkStyle}>1.4.3</Link> Оповещение и Стратегии Активного Реагирования (из WAHH2 1.4.3)
      </H3>
      <P>
        Система должна предусматривать механизмы оповещения администраторов о подозрительной активности или обнаруженных атаках в реальном времени. Адекватная реакция на атаки может включать временную блокировку IP-адресов, с которых исходит атака, принудительное завершение сессий подозрительных пользователей или активацию более строгих режимов безопасности [WAHH2 1.4.3]. В реальных сценариях это часто реализуется с помощью WAF (Web Application Firewall), IDS/IPS (Intrusion Detection/Prevention System) или SIEM (Security Information and Event Management) систем. Оповещение и активное реагирование переводят безопасность из чисто пассивного состояния в более проактивное, позволяя вмешаться до того, как будет нанесен значительный ущерб. Хотя данный урок не предполагает настройку систем оповещения, важно понимать, что эффективные логи (см. <Link href="#s1-4-2" className={LinkStyle}>1.4.2</Link>), такие как логи PHPIDS в DVWA 29, являются основой для таких систем.
      </P>

      <H3 id="s1-5">
        <Link href="#s1-5" className={LinkStyle}>1.5</Link> Безопасное Управление Приложением (из WAHH2 1.5)
      </H3>
      <P>
        Безопасность веб-приложения также зависит от его правильной конфигурации, своевременного обновления всех компонентов (включая серверное ПО, библиотеки и фреймворки) и безопасного администрирования. Неправильные настройки сервера, использование учетных данных по умолчанию или устаревшее ПО могут создать легко эксплуатируемые уязвимости [WAHH2 1.5].
      </P>
      <P>Ключевые аспекты безопасного управления включают:</P>
      <Ul items={[
        "Надежная конфигурация: Приложения, веб-серверы и базы данных должны быть настроены с учетом принципов безопасности, отключая ненужные функции и службы.",
        "Своевременное применение исправлений: Все компоненты системы, включая операционную систему, серверное программное обеспечение, библиотеки и фреймворки, должны регулярно обновляться для устранения известных уязвимостей. Это напрямую связано с OWASP Top 10 A06:2021-Vulnerable and Outdated Components.6",
        "Безопасное администрирование: Использование сложных, уникальных паролей для административных интерфейсов и отказ от учетных данных по умолчанию.",
        "Предотвращение утечки информации через HTTP-заголовки: Такие заголовки, как Server, X-Powered-By, X-AspNet-Version, могут раскрывать информацию о версиях используемого ПО, что облегчает злоумышленникам поиск известных уязвимостей.32 Проект OWASP Secure Headers Project 33 описывает заголовки, которые могут повысить безопасность приложения (например, Strict-Transport-Security, Content-Security-Policy)."
      ]}/>
      <Card className="my-6">
        <CardHeader>
          <CardTitle>Практическое Задание 1.5.A: Выявление Утечки Информации через HTTP-заголовки</CardTitle>
        </CardHeader>
        <CardContent>
          <P><strong>Цель:</strong> Определить версии серверного ПО и фреймворков по HTTP-заголовкам ответа.</P>
          <P><strong>Среда:</strong> Любое веб-приложение, включая DVWA или OWASP Juice Shop.</P>
          <P><strong>Инструменты:</strong> Браузерные инструменты разработчика (вкладка "Network"), curl, netcat.</P>
          <P><strong>Шаги (на основе 32):</strong></P>
          <Ul items={[
            "Сделать запрос к приложению.",
            "Проанализировать заголовки ответа на наличие Server, X-Powered-By, X-AspNet-Version и т.д.",
            "Обсудить, как эта информация может помочь злоумышленнику (например, найти известные эксплойты для конкретных версий).",
            "Обратиться к OWASP Secure Headers Project 33 для ознакомления с заголовками, повышающими безопасность (например, Strict-Transport-Security, Content-Security-Policy, X-Frame-Options, X-Content-Type-Options). Хотя это не напрямую связано с утечкой, это хороший контекст для управления безопасностью заголовков."
          ]}/>
          <P><strong>Ожидаемый Результат:</strong> Идентификация потенциально раскрывающих информацию заголовков. Понимание, как уменьшить эту утечку.</P>
          <P>Конфигурации по умолчанию часто приводят к утечке информации о версиях через HTTP-заголовки, предоставляя злоумышленникам легкие цели, если эти версии имеют известные уязвимости. Это "низко висящие фрукты" для атакующих. Управление приложением — это не только обеспечение его функциональности, но и усиление защиты среды и минимизация информационного следа, доступного потенциальным злоумышленникам. Это напрямую связано с OWASP A05:2021-Security Misconfiguration.6</P>
        </CardContent>
      </Card>

      <H3 id="s1-6">
        <Link href="#s1-6" className={LinkStyle}>1.6</Link> Заключение: Построение Устойчивой Защиты
      </H3>
      <P>
        Описанные выше механизмы – аутентификация, управление сессиями, контроль доступа, валидация ввода, обработка ошибок, логирование и безопасное конфигурирование – представляют собой "идеальную" модель защиты. Однако на практике их реализация часто содержит ошибки, упущения или неполные проверки. Именно эти несоответствия между ожидаемым и реальным поведением системы безопасности и становятся основной целью для атакующих [WAHH2 1.6].
      </P>
      <P>
        Понимание того, как приложение должно защищаться, позволяет специалисту по безопасности (или злоумышленнику) целенаправленно искать слабые места. Успешная защита требует непрерывного цикла: проектирование с учетом безопасности, безопасная реализация, тщательное тестирование (включая тестирование на проникновение), постоянный мониторинг и оперативное реагирование на инциденты.
      </P>
      <P>
        OWASP Top 10 является ценным ресурсом для понимания наиболее распространенных и критических рисков для веб-приложений. Многие из этих рисков являются прямым следствием недостатков в фундаментальных механизмах защиты, рассмотренных в этом уроке.
      </P>
      
      <H3>Таблица: Соответствие Обсужденных Уязвимостей и OWASP Top 10 2021</H3>
      <div className="overflow-x-auto my-6">
        <Table>
          <TableHeader>
            <TableRow>
              <TableHead>Обсужденная Уязвимость в Уроке</TableHead>
              <TableHead>Пример Эксплуатации</TableHead>
              <TableHead>Соответствующий OWASP Top 10 2021</TableHead>
              <TableHead>Нарушенный Механизм WAHH2</TableHead>
            </TableRow>
          </TableHeader>
          <TableBody>
            <TableRow>
              <TableCell>Слабая Аутентификация (Brute Force)</TableCell>
              <TableCell>DVWA Brute Force с Hydra/Burp</TableCell>
              <TableCell>A07: Identification and Authentication Failures 7</TableCell>
              <TableCell>1.2.1 Аутентификация</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Небезопасные Флаги Cookie Сессии</TableCell>
              <TableCell>Отсутствие флагов HttpOnly/Secure</TableCell>
              <TableCell>A05: Security Misconfiguration (для флагов); A02: Cryptographic Failures (если токены слабые/предсказуемые) 9</TableCell>
              <TableCell>1.2.2 Управление Сессиями</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Небезопасные Прямые Ссылки на Объекты (IDOR)</TableCell>
              <TableCell>Манипуляция Корзиной в Juice Shop</TableCell>
              <TableCell>A01: Broken Access Control 11</TableCell>
              <TableCell>1.2.3 Контроль Доступа</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Межсайтовый Скриптинг (XSS)</TableCell>
              <TableCell>Полезные нагрузки XSS в DVWA/Juice Shop</TableCell>
              <TableCell>A03: Injection 8</TableCell>
              <TableCell>1.3 Обработка Пользовательского Ввода</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>SQL-инъекция (SQLi)</TableCell>
              <TableCell>Полезные нагрузки SQLi в DVWA</TableCell>
              <TableCell>A03: Injection 8</TableCell>
              <TableCell>1.3 Обработка Пользовательского Ввода</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Локальное Включение Файлов (LFI)</TableCell>
              <TableCell>LFI в DVWA (/etc/passwd)</TableCell>
              <TableCell>A01: Broken Access Control (если доступ к неавторизованным файлам); A03: Injection (если ведет к RCE) 22</TableCell>
              <TableCell>1.3 Обработка Пользовательского Ввода</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Детализированные Сообщения об Ошибках</TableCell>
              <TableCell>Утечка SQL-ошибки в Juice Shop</TableCell>
              <TableCell>A05: Security Misconfiguration (Утечка информации – форма неверной конфигурации) 25</TableCell>
              <TableCell>1.4.1 Обработка Ошибок</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Недостаточное Логирование</TableCell>
              <TableCell>(Концептуально – отсутствие доказательств атак)</TableCell>
              <TableCell>A09: Security Logging & Monitoring Failures</TableCell>
              <TableCell>1.4.2 Ведение Аудиторских Логов</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Утечка Информации (HTTP-заголовки)</TableCell>
              <TableCell>Видимость заголовков Server, X-Powered-By</TableCell>
              <TableCell>A05: Security Misconfiguration 32</TableCell>
              <TableCell>1.5 Управление Приложением</TableCell>
            </TableRow>
            <TableRow>
              <TableCell>Использование Уязвимых Компонентов</TableCell>
              <TableCell>(Подразумевается, если устаревшее ПО идентифицировано)</TableCell>
              <TableCell>A06: Vulnerable and Outdated Components</TableCell>
              <TableCell>1.5 Управление Приложением</TableCell>
            </TableRow>
          </TableBody>
        </Table>
      </div>
      <P>
        Эта таблица обеспечивает важное связующее звено между конкретными уязвимостями и механизмами WAHH2, обсуждаемыми в уроке, и более широкими, признанными в отрасли рисками OWASP Top 10. Она помогает учащимся контекстуализировать свои знания и понять реальную значимость этих проблем. Многие категории OWASP Top 10 не являются изолированными, а часто являются результатом сбоев в одном или нескольких фундаментальных механизмах защиты. Например, A01 (Broken Access Control) может проявляться как IDOR (сбой в <Link href="#s1-2-3" className={LinkStyle}>1.2.3</Link>) или LFI (сбой в <Link href="#s1-3" className={LinkStyle}>1.3</Link>, приводящий к несанкционированному доступу к файлам). Это подчеркивает, что "отклонения от идеала", упомянутые в WAHH2, – это именно то, что часто описывают категории OWASP Top 10.
      </P>

      <H2 id="sources">Источники</H2>
      <ol className="list-decimal list-inside space-y-2 text-sm">
        {sourcesData.map(source => (
          <li key={source.id}>
            {source.text} - <Link href={source.url} target="_blank" rel="noopener noreferrer" className={LinkStyle}>{source.url}</Link> (дата последнего обращения: июня 12, 2025)
          </li>
        ))}
      </ol>

    </ContentPageLayout>
  );
}
