export const quizQuestions = [
    {
        question: "1. К чему может привести уязвимость загрузки файлов?",
        answers: [
            "Полный компрометации сервера (RCE), Defacement, DoS",
            "Только к XSS",
            "К удалению базы данных",
            "К медленной работе сайта"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "2. Какой тип файлов является наиболее опасным для загрузки на PHP сервер?",
        answers: [
            ".jpg",
            ".php (и его вариации .php5, .phtml)",
            ".txt",
            ".pdf"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "3. Что такое Web Shell?",
        answers: [
            "Красивая оболочка сайта",
            "Вредоносный скрипт, загруженный на сервер, позволяющий удаленно выполнять команды системы через HTTP запросы",
            "Защитная оболочка",
            "Браузерное расширение"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "4. Почему проверка `Content-Type` заголовка недостаточна для защиты?",
        answers: [
            "Потому что браузеры его не отправляют",
            "Потому что этот заголовок полностью контролируется клиентом и может быть легко подделан (например, отправлен `image/png` для файла `shell.php`)",
            "Потому что он устарел",
            "Потому что он шифруется"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "5. Что такое 'Null Byte Injection' в контексте обхода проверки расширения?",
        answers: [
            "Добавление нулевого байта (%00) в имя файла (shell.php%00.jpg), чтобы валидатор видел .jpg, а файловая система (на C/C++) обрезала строку до .php",
            "Использование нуля в размере файла",
            "Загрузка пустого файла",
            "Удаление байтов"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "6. Какое расширение является альтернативой для .php, которая часто исполняется сервером?",
        answers: [
            ".phtml",
            ".txt",
            ".doc",
            ".css"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "7. Что такое 'Double Extension' атака?",
        answers: [
            "Загрузка двух файлов",
            "Использование имени файла вида `shell.php.jpg`. Если сервер неправильно настроен (например, Apache с AddHandler), он может исполнить файл как PHP, даже если он заканчивается на .jpg, но содержит .php",
            "Дублирование расширения",
            "Сжатие файла"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "8. Почему опасно сохранять загруженные файлы в корень веб-сервера (webroot)?",
        answers: [
            "Они занимают место",
            "Потому что они становятся доступны для прямого скачивания или исполнения по прямому URL",
            "Это некрасиво",
            "Это замедляет индексацию"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "9. Как защититься от выполнения скриптов в папке загрузки?",
        answers: [
            "Отключить исполнение скриптов в этой директории (например, через .htaccess `php_flag engine off` или конфигурацию Nginx)",
            "Скрыть папку",
            "Поставить пароль на папку",
            "Удалять файлы через час"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "10. Может ли SVG файл быть опасным?",
        answers: [
            "Нет, это картинка",
            "Да, SVG это XML, он может содержать XSS (Stored XSS) и XXE вектора атак",
            "Только если он большой",
            "Только в IE"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "11. Что такое 'Polyglot' файл?",
        answers: [
            "Файл на нескольких языках",
            "Файл, который валиден сразу в нескольких форматах (например, валидный GIF и валидный PHP скрипт одновременно)",
            "Файл с переводом",
            "Зашифрованный файл"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "12. Как переименование файлов при загрузке помогает безопасности?",
        answers: [
            "Не помогает",
            "Оно предотвращает перезапись системных файлов и усложняет атакующему доступ к файлу (если новое имя случайное и неизвестное)",
            "Делает имена короче",
            "Улучшает SEO"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "13. Что такое Magic Number (сигнатура файла)?",
        answers: [
            "Магическое число 42",
            "Первые байты файла, идентифицирующие его формат (например, `FF D8 FF` для JPEG). Проверка сигнатуры надежнее проверки расширения",
            "Хеш файла",
            "Размер файла"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "14. Как можно использовать `.htaccess` для атаки при загрузке файлов?",
        answers: [
            "Удалить его",
            "Загрузить свой злобный `.htaccess`, который переопределит настройки сервера (например, разрешит исполнение .txt файлов как PHP)",
            "Прочитать его",
            "Это невозможно"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "15. Какой инструмент командной строки позволяет внедрить PHP код в метаданные изображения?",
        answers: [
            "exiftool",
            "photoshop",
            "paint",
            "grep"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "16. Безопасно ли проверять только размер изображения (getimagesize)?",
        answers: [
            "Да, это гарантирует, что это картинка",
            "Нет, валидная картинка все еще может содержать вредоносный PHP код в комментариях (metadata injection)",
            "Только для PNG",
            "Да, если размер меньше 1Мб"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "17. Что такое 'Zip Slip' уязвимость?",
        answers: [
            "Разрыв архива",
            "Атака при распаковке архивов, позволяющая перезаписать произвольные файлы системы через имена файлов типа `../../evil.sh` внутри архива",
            "Быстрая загрузка",
            "Сжатие без потерь"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "18. Как защититься от ImageTragick?",
        answers: [
            "Не использовать ImageMagick",
            "Обновить ImageMagick и настроить `policy.xml` для отключения опасных кодеров (MVG, MSL, HTTPS...)",
            "Использовать только JPG",
            "Удалить картинки"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "19. Какой список расширений (White или Black) лучше использовать?",
        answers: [
            "Blacklist (черный список)",
            "Whitelist (белый список) — разрешать только заведомо безопасные расширения",
            "Оба",
            "Никакой"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "20. Что делать с правами доступа на папку uploads?",
        answers: [
            "Ставить 777",
            "Ставить минимально необходимые права, запретить исполнение (noexec bit если возможно, или конфиг веб-сервера)",
            "Ставить только чтение",
            "Скрыть папку"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "21. Можно ли получить RCE загрузив `.jsp` файл на IIS сервер?",
        answers: [
            "Да",
            "Обычно нет, IIS исполняет ASP/.NET, а не Java. Но файл может быть просто скачан",
            "Всегда",
            "Никогда"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "22. Как работает атака через `.user.ini` в PHP?",
        answers: [
            "Меняет дизайн сайта",
            "Если загрузить `.user.ini`, можно переопределить настройки PHP для директории, например, `auto_prepend_file`, что заставит выполняться шелл при каждом запросе к любому php файлу",
            "Удаляет пользователей",
            "Создает админа"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "23. Что такое 'Pixel Flood' атака?",
        answers: [
            "Заливка цветом",
            "DoS атака через загрузку изображения с огромными размерами (10000x10000px), но малым весом файла (сжатие). При обработке сервер расходует всю RAM",
            "Атака на монитор",
            "Битые пиксели"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "24. Опасна ли загрузка CSV файлов?",
        answers: [
            "Нет, это текст",
            "Да, CSV Injection (формулы Excel) может атаковать администратора, открывшего файл в Excel",
            "Только если он большой",
            "Нет, Excel безопасен"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "25. Почему `getimagesize()` в PHP не гарантирует безопасность?",
        answers: [
            "Функция проверяет только заголовки изображения, но не сканирует все тело на наличие PHP тегов",
            "Функция устарела",
            "Она работает только с GIF",
            "Она дорогая по ресурсам"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "26. В чем суть атаки с использованием символов `::$DATA` в Windows?",
        answers: [
            "Это системный сбой",
            "Позволяет обойти проверки расширения и создать файл, скрыв его реальное расширение или содержимое от некоторых проверок, или записать в поток NTFS",
            "Это дата создания файла",
            "Ошибка базы данных"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "27. Может ли имя файла вызвать XSS?",
        answers: [
            "Нет",
            "Да, если имя файла отображается на странице без экранирования (Reflected или Stored XSS)",
            "Только в Linux",
            "Только в PDF"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "28. Как правильно хранить файлы?",
        answers: [
            "В корне сайта",
            "В базе данных (BLOB) или в облачном хранилище (S3) без прав исполнения, или в папке вне webroot",
            "На рабочем столе",
            "На флешке"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "29. Какие символы стоит удалять из имен файлов?",
        answers: [
            "Только пробелы",
            "Спецсимволы, null-байты, управляющие символы, `../`, лучше вообще генерировать UUID имя",
            "Цифры",
            "Гласные буквы"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "30. Что такое 'Race Condition' при загрузке файлов?",
        answers: [
            "Соревнование хакеров",
            "Когда файл сначала сохраняется, а потом проверяется/удаляется. Хакер успевает вызвать файл до его удаления",
            "Быстрая загрузка",
            "Ошибка сети"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "31. Что такое Exif данные?",
        answers: [
            "Метаданные изображения (камера, GPS, и т.д.), куда можно спрятать пейлоад",
            "Графические данные",
            "Сжатие",
            "Цветовая палитра"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "32. Помогает ли пережатие (resize/re-encode) изображений?",
        answers: [
            "Нет",
            "Да, это очень эффективная мера, так как она разрушает структуру внедренного кода (обычно удаляет комментарии и метаданные)",
            "Только для JPEG",
            "Ухудшает качество"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "33. Можно ли доверять расширению файла, пришедшему от клиента?",
        answers: [
            "Да, всегда",
            "Нет, никогда",
            "Только в Chrome",
            "Если пользователь админ"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "34. Какая уязвимость позволяет читать содержимое файлов через загрузку XML/SVG?",
        answers: [
            "XSS",
            "XXE (XML External Entity)",
            "SQLi",
            "CSRF"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "35. Что такое 'GIFAR'?",
        answers: [
            "Анимация",
            "Файл, который является валидным GIF и валидным JAR архивом одновременно (использовался для атак на Java applets)",
            "Ошибка сжатия",
            "Формат видео"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "36. Почему важно ограничивать размер файла?",
        answers: [
            "Чтобы не закончилось место на диске (DoS)",
            "Чтобы файл быстрее грузился",
            "Чтобы не тратить трафик",
            "Все вышеперечисленное"
        ],
        correctAnswerIndex: 3
    },
    {
        question: "37. Как атакующий может использовать загрузку HTML файла?",
        answers: [
            "Чтобы изменить дизайн",
            "Для XSS атаки (если файл откроется в контексте домена сайта, JS выполнится с доступом к кукам)",
            "Для SEO",
            "Это безопасно"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "38. Что делает расширение .phar опасным в PHP?",
        answers: [
            "Ничего",
            "Это PHP Archive, может привести к RCE через десериализацию (если вызвать file_exists('phar://...') на контролируемом файле)",
            "Это картинка",
            "Это база данных"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "39. Нужно ли сканировать загружаемые файлы антивирусом?",
        answers: [
            "Нет, это дорого",
            "Желательно (ClamAV и т.д.) для защиты пользователей от скачивания малвари, хотя от веб-шеллов не всегда спасает",
            "Только в Windows",
            "Антивирусы не работают на сервере"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "40. Можно ли загрузить web shell, если разрешены только PDF?",
        answers: [
            "Нет",
            "Возможно (Polyglot PDF), или использовать уязвимости в PDF парсере сервера (ImageMagick CVE)",
            "PDF это текст",
            "Всегда"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "41. Как защититься от DoS при загрузке ZIP бомб?",
        answers: [
            "Не принимать ZIP архивы или строго ограничивать коэффициент сжатия и рекурсию при распаковке",
            "Использовать RAR",
            "Увеличить память",
            "Удалить сервер"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "42. Что такое 'Content-Disposition' заголовок?",
        answers: [
            "Заголовок ответа сервера, который говорит браузеру, скачать файл (attachment) или открыть (inline). `attachment` безопаснее для HTML/SVG файлов",
            "Заголовок запроса",
            "Расположение контента",
            "Тип файла"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "43. Что будет, если загрузить файл с именем `index.html` в пустую папку?",
        answers: [
            "Ничего",
            "Он может переопределить главную страницу этой папки (Defacement)",
            "Ошибка",
            "Файл удалится"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "44. Какой из этих символов опасен в имени файла в Linux?",
        answers: [
            "/ (слэш)",
            "a",
            "1",
            "-"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "45. Почему стоит использовать Content Security Policy (CSP)?",
        answers: [
            "Для защиты от XSS, если атакующему удалось загрузить JS/HTML файл",
            "Для красоты",
            "Для скорости",
            "Для SEO"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "46. Как атакующий может использовать LFI через загрузку файла?",
        answers: [
            "Загрузить файл с PHP кодом, а потом подключить его через уязвимость LFI (include 'uploads/shell.jpg')",
            "Это невозможно",
            "Только если файл txt",
            "LFI и Upload не связаны"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "47. Что такое 'Put method'?",
        answers: [
            "Метод HTTP, позволяющий загружать файлы на сервер (если разрешен и не защищен)",
            "Вставка данных",
            "Положить трубку",
            "Метод GET"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "48. Является ли проверка MIME-type файла по его содержимому (magic bytes) 100% гарантией?",
        answers: [
            "Да",
            "Нет, можно создать Polyglot файл, у которого правильные magic bytes в начале, но вредоносный код в середине/конце",
            "Только для Linux",
            "Только для Windows"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "49. В каком случае загрузка XML файла безопасна?",
        answers: [
            "Всегда",
            "Если на сервере отключен парсинг внешних сущностей (libxml_disable_entity_loader) и DTD",
            "Если файл маленький",
            "Если он в UTF-8"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "50. Какое золотое правило работы с пользовательским вводом (файлами)?",
        answers: [
            "Все доверять",
            "Never Trust User Input (Никогда не доверяй вводу пользователя). Всегда валидируй, санитайзь и изолируй",
            "Проверять только расширение",
            "Ввод пользователя безопасен"
        ],
        correctAnswerIndex: 1
    }
    ,
    {
        question: "51. Что такое 'Null Byte' на языке C и как он влияет на PHP?",
        answers: [
            "Это конец файла",
            "В C это терминатор строки. Старые версии PHP (до 5.3.4) передавали его в системные вызовы, обрезая строку, что позволяло обходить проверки расширений",
            "Это ошибка памяти",
            "Это пробел"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "52. Какой заголовок IIS может быть использован для выполнения файла как ASP, если он загружен как txt?",
        answers: [
            "Content-Type: application/x-asp",
            "Никакой, нужно настроить Handler Mappings на сервере",
            "X-ASP-Exec",
            "Cookie"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "53. В чем опасность использования `move_uploaded_file` без проверки назначения?",
        answers: [
            "Это медленная функция",
            "Если путь назначения контролируется пользователем, можно перезаписать критические файлы (config.php) или сохранить файл в папку автозагрузки",
            "Она удаляет исходный файл",
            "Она требует root прав"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "54. Можно ли выполнить JS код через загрузку SVG изображения?",
        answers: [
            "Нет, SVG это векторная графика",
            "Да, SVG поддерживает тег <script>, и если открыть изображение в браузере (не через <img> тег), JS выполнится (Stored XSS)",
            "Только в Firefox",
            "Только если файл называется script.svg"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "55. Что такое 'Chained Extension' в контексте Apache?",
        answers: [
            "Цепочка сертификатов",
            "Если файл имеет имя `file.php.jpg` и в конфиге есть `AddHandler application/x-httpd-php .php`, Apache может обработать его как PHP, даже если .php не последнее расширение (зависит от настроек)",
            "Длинное расширение",
            "Сжатие цепочкой"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "56. Как атакующий может использовать функцию 'Unzip' на сервере?",
        answers: [
            "Для экономии места",
            "Для Zip Slip атаки (запись файлов за пределы целевой папки) или для DoS (Zip Bomb)",
            "Для ускорения сайта",
            "Для шифрования"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "57. Почему важно отключать `short_open_tag` в PHP?",
        answers: [
            "Для производительности",
            "Чтобы атакующий не мог использовать короткий тег `<?` для инъекции кода, если фильтруется только `<?php`",
            "Это стандарт PSR",
            "Это экономит байты"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "58. Какой инструмент в Linux позволяет найти скрытый код внутри картинки?",
        answers: [
            "strings",
            "ls",
            "cd",
            "mkdir"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "59. Что произойдет, если загрузить файл `.htaccess` в директорию uploads?",
        answers: [
            "Ничего, это текстовый файл",
            "Сервер (Apache) применит настройки из этого файла. Атакующий может разрешить исполнение php в этой папке",
            "Сервер упадет",
            "Файл удалится"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "60. Как защититься от загрузки `.htaccess`?",
        answers: [
            "Запретить файлы, начинающиеся с точки, и установить `AllowOverride None` в конфиге Apache",
            "Удалить Apache",
            "Переименовать его",
            "Скрыть его"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "61. Что такое 'NTFS ADS' (Alternate Data Streams)?",
        answers: [
            "Потоковое видео",
            "Функция файловой системы Windows, позволяющая скрывать данные за файлом (file.txt:hidden.exe). Может использоваться для скрытия веб-шелла",
            "Реклама в Windows",
            "Система прав доступа"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "62. Можно ли загрузить JSP шелл в WAR архив?",
        answers: [
            "Да, WAR это ZIP архив с приложением Java. Если Tomcat распакует его, шелл станет доступен",
            "Нет, WAR только для библиотек",
            "Только в PHP",
            "Нет"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "63. Чем опасна загрузка PDF файлов?",
        answers: [
            "Ничем",
            "PDF может содержать JS для XSS, ссылки для Phishing, или эксплойты для PDF ридеров (Adobe RCE)",
            "Они тяжелые",
            "Они не индексируются"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "64. Как работает байпас через `DATA` URI scheme?",
        answers: [
            "Через data://text/plain;base64,... можно передать содержимое файла прямо в URL (если есть LFI/RFI)",
            "Это база данных",
            "Это дата загрузки",
            "Это ошибка"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "65. Почему стоит перегенерировать имя файла при сохранении?",
        answers: [
            "Чтобы избежать коллизий имен",
            "Чтобы убрать спецсимволы, предотвратить Path Traversal и скрыть оригинальное имя",
            "Чтобы сделать имя короче",
            "Все вышеперечисленное"
        ],
        correctAnswerIndex: 3
    },
    {
        question: "66. Что такое 'Second Order' уязвимость при загрузке файлов?",
        answers: [
            "Загрузка двух файлов",
            "Когда имя файла сохраняется в БД, а потом используется в опасном контексте (например, SQLi через имя файла или XSS в админке при просмотре списка файлов)",
            "Вторая попытка",
            "Ошибка сортировки"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "67. Какой статус код HTTP обычно возвращает успешная загрузка?",
        answers: [
            "200 OK или 201 Created",
            "404 Not Found",
            "500 Error",
            "302 Redirect"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "68. Как работает атака 'ImageGhost'?",
        answers: [
            "Это призрак на фото",
            "Изменение изображения так, что при изменении размера (thumbnail) появляется скрытый контент (манипуляция алгоритмами ресайза)",
            "Удаление картинки",
            "Скрытие IP"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "69. Можно ли исполнить код через `putenv()`?",
        answers: [
            "Да, если загрузить `.so` библиотеку и через `putenv` изменить `LD_PRELOAD`, можно перехватить системные вызовы (в PHP mail())",
            "Нет",
            "Только в Windows",
            "Только в CSS"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "70. Что такое 'Symlink Race'?",
        answers: [
            "Гонка ссылок",
            "Создание символической ссылки на критический файл в момент проверки и записи файла, чтобы перезаписать цель",
            "Быстрая ссылка",
            "Ошибка DNS"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "71. Безопасно ли использовать `blacklist` для расширений?",
        answers: [
            "Да, если перечислить все",
            "Нет, всегда найдется расширение, которое забыли (phtml, phps, cer, asa, ...)",
            "Да, это рекомендация OWASP",
            "Да, для Windows"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "72. Как `open_basedir` помогает в PHP?",
        answers: [
            "Ограничивает скрипты чтением/записью только в указанных директориях, предотвращая доступ к `/etc/passwd` даже если шелл загружен",
            "Открывает базу данных",
            "Запрещает загрузку",
            "Ускоряет PHP"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "73. Что такое 'Fileless Malware' при загрузке?",
        answers: [
            "Вирус без файла",
            "Вредоносный код, который выполняется в памяти без сохранения на диск (через загрузку в поток или memory mapped file)",
            "Удаленный файл",
            "Ошибка диска"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "74. Как проверить, что файл действительно картинка, а не скрипт?",
        answers: [
            "По расширению",
            "Перекодировать (re-render) изображение. Удалить метаданные и создать новый файл из пиксельных данных",
            "По размеру",
            "Открыть в Paint"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "75. Какой риск несет загрузка XML файлов для парсинга?",
        answers: [
            "Никакого",
            "XXE (чтение файлов, SSRF) и DoS (Billion Laughs Attack)",
            "XSS",
            "SQLi"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "76. Что такое 'Extension truncation'?",
        answers: [
            "Обрезание расширения из-за ограничения длины имени файла (buffer overflow) или null-byte",
            "Сжатие файла",
            "Удаление файла",
            "Кодировка UTF-8"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "77. Можно ли использовать `finfo_file` (PHP) для гарантии типа?",
        answers: [
            "Да",
            "Нет, он проверяет magic bytes, которые можно подделать (Polyglot)",
            "Только для текста",
            "Только для видео"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "78. Как защитить S3 бакет от исполнения загруженных файлов?",
        answers: [
            "Настроить права доступа (IAM / Bucket Policy), не делать бакет публичным, использовать Content-Disposition: attachment",
            "Удалить бакет",
            "Использовать пароль",
            "S3 всегда безопасен"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "79. Что такое 'HTML Injection' через загрузку?",
        answers: [
            "Загрузка HTML файла, который выглядит как страница логина (Phishing) или содержит вредоносные скрипты",
            "Инъекция в базу",
            "Стиль CSS",
            "Ошибка HTML"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "80. Почему важно логировать загрузку файлов?",
        answers: [
            "Для статистики",
            "Для форензики (расследования инцидентов), чтобы знать кто, когда и что загрузил",
            "Для красоты",
            "Для SEO"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "81. Как влияет регистр букв в расширении (File.PhP) на Windows?",
        answers: [
            "Никак, Windows case-insensitive, поэтому .PhP == .php",
            "Windows считает это разными файлами",
            "Вызовет ошибку",
            "Файл удалится"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "82. Можно ли загрузить вирус через `.exe`?",
        answers: [
            "Да, если сервер не проверяет содержимое и пользователь его скачает/запустит",
            "Нет, .exe не работает в вебе",
            "Только если он меньше 1Мб",
            "Антивирус всегда ловит"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "83. Что такое 'Client-side Validation'?",
        answers: [
            "Проверка JS в браузере. Легко обходится через Burp / Curl",
            "Проверка на сервере",
            "Проверка администратором",
            "Проверка антивирусом"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "84. Как атаковать через загрузку `.csv`?",
        answers: [
            "CSV Injection (DDE) - формулы выполняются при открытии в Excel (=cmd|' /C calc'!A0)",
            "Никак",
            "Через макросы",
            "Через SQL"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "85. Зачем использовать отдельный домен для статики (cdn.example.com)?",
        answers: [
            "Для скорости",
            "Для безопасности (Same Origin Policy). Если XSS выполнится на CDN домене, он не будет иметь доступа к кукам основного домена",
            "Для красоты",
            "Это дешевле"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "86. Что будет, если загрузить файл с именем `../../etc/passwd`?",
        answers: [
            "Ничего",
            "Если нет проверки, сервер может перезаписать системный файл (Path Traversal)",
            "Ошибка 500",
            "Файл сохранится в корне"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "87. Как работает 'Conditional Race'?",
        answers: [
            "Сложная гонка условий, где успех зависит от таймингов проверки и выполнения",
            "Гонка машин",
            "Условие if",
            "Цикл for"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "88. Можно ли спрятать PHP код в EXIF заголовке 'Comment'?",
        answers: [
            "Да",
            "Нет",
            "Только в PNG",
            "Только в BMP"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "89. Какой риск загрузки архивов (ZIP, TAR, GZ)?",
        answers: [
            "Никакого",
            "Zip Slip, Zip Bomb, обход антивирусов (пароль на архиве)",
            "Они большие",
            "Они старые"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "90. Что такое 'Transmutation' при загрузке?",
        answers: [
            "Превращение файла",
            "Когда сервер конвертирует файл (например, docx в pdf) и в процессе срабатывает уязвимость конвертера (ImageMagick, LibreOffice)",
            "Ошибка мутации",
            "Изменение прав"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "91. Помогает ли смена прав на `chmod 400`?",
        answers: [
            "Да, файл становится только для чтения, его нельзя исполнить (если веб-сервер не форсирует исполнение)",
            "Нет",
            "Делает файл невидимым",
            "Удаляет файл"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "92. Что такое 'Web Shell' на языке Python?",
        answers: [
            "Скрипт .py, который принимает команды через GET/POST и выполняет через os.system()",
            "Змея в интернете",
            "Браузер на Python",
            "Ошибка PIP"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "93. Как обнаружить Web Shell?",
        answers: [
            "По логам (странные запросы, `whoami`), дате создания файла, анализу кода, изменениям контрольных сумм",
            "По цвету файла",
            "Нельзя",
            "Только ребутом"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "94. Что такое 'ColdFusion' файлы?",
        answers: [
            ".cfm, .cfc - скрипты, которые могут исполняться на серверах Adobe ColdFusion",
            "Холодный синтез",
            "Файлы конфигурации",
            "Картинки"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "95. Зачем нужен 'Sandboxing' при обработке файлов?",
        answers: [
            "Играть в песочнице",
            "Изолировать процесс обработки файла (конвертацию), чтобы RCE в конвертере не дало доступ к основной системе",
            "Для детей",
            "Для очистки диска"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "96. Можно ли использовать `onload` в SVG для XSS?",
        answers: [
            "Да, <svg onload=alert(1)> сработает",
            "Нет",
            "Только в IE",
            "Только если разрешен JS"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "97. Что такое 'File Signature'?",
        answers: [
            "Подпись автора",
            "Уникальная последовательность байтов в начале файла (Magic Bytes)",
            "Расширение",
            "Размер"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "98. Как работает атака на 'Image Processing Libraries'?",
        answers: [
            "Загрузка специально сформированного изображения, вызывающего переполнение буфера или RCE в библиотеке (libpng, libjpeg, ImageMagick)",
            "Рисование на фото",
            "Удаление библиотек",
            "Сжатие фото"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "99. Почему опасно разрешать загрузку `.json`?",
        answers: [
            "JSON безопасен",
            "Если JSON используется в конфигурации или десериализации, подмена файла может изменить логику приложения",
            "JSON это текст",
            "JSON не читается"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "100. Является ли File Upload критической уязвимостью в OWASP?",
        answers: [
            "Да, часто классифицируется как Critical / High (если ведет к RCE)",
            "Нет, это Low",
            "Это вообще не уязвимость",
            "Зависит от погоды"
        ],
        correctAnswerIndex: 0
    }
];
