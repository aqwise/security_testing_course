export interface QuizQuestion {
    question: string;
    answers: string[];
    correctAnswerIndex: number;
    explanation?: string;
    link?: {
        label: string;
        url: string;
    };
}

export const quizQuestions: QuizQuestion[] = [
    {
        question: "Что такое Injection (Инъекция) в контексте веб-безопасности?",
        answers: [
            "Уязвимость, возникающая когда недоверенные данные отправляются интерпретатору как часть команды или запроса",
            "Техника обхода аутентификации путем перехвата сессионных токенов между клиентом и сервером",
            "Метод защиты приложений через внедрение дополнительных проверок безопасности в код",
            "Процесс добавления метаданных в HTTP-заголовки для отслеживания запросов",
            "Способ шифрования данных перед их сохранением в базе данных",
            "Техника балансировки нагрузки между несколькими серверами приложений",
            "Механизм кеширования запросов на уровне прокси-сервера"
        ],
        correctAnswerIndex: 0,
        explanation: "Инъекция — класс уязвимостей, при которых приложение принимает недоверенные данные и передает их интерпретатору (SQL, OS, LDAP). В этом уроке мы рассматриваем 5 основных типов: XSS, HTML Injection, SQL Injection, Command Injection и XXE.",
        link: {
            label: "Раздел 'Что такое инъекции кода?' в этом уроке",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Какое место занимают уязвимости класса Injection в рейтинге OWASP Top 10 (2021)?",
        answers: [
            "A03: Injection — третье место в списке критических уязвимостей",
            "A01: Broken Access Control — первое место, объединенное с инъекциями",
            "A07: Identification and Authentication Failures — седьмое место как подкатегория",
            "A10: Server-Side Request Forgery — десятое место из-за снижения распространенности",
            "A05: Security Misconfiguration — пятое место, куда перенесли инъекции",
            "A02: Cryptographic Failures — второе место в связи с шифрованием данных",
            "A08: Software and Data Integrity Failures — восьмое место в новой классификации"
        ],
        correctAnswerIndex: 0,
        explanation: "В OWASP Top 10 2021 инъекции занимают 3-е место (A03). Это подчеркивает их критическую важность. В предыдущих версиях рейтинга инъекции были на 1-м месте.",
        link: {
            label: "OWASP Top 10:2021 - A03 Injection",
            url: "https://owasp.org/Top10/A03_2021-Injection/"
        }
    },
    {
        question: "Какой основной архитектурный принцип позволяет защититься от инъекций?",
        answers: [
            "Разделение данных и управляющего кода — данные никогда не должны интерпретироваться как команды",
            "Использование многофакторной аутентификации для всех пользователей системы",
            "Применение WAF (Web Application Firewall) как единственного слоя защиты",
            "Шифрование всего трафика между клиентом и сервером с помощью TLS 1.3",
            "Ограничение количества запросов от одного IP-адреса (rate limiting)",
            "Логирование всех действий пользователей для последующего аудита",
            "Использование микросервисной архитектуры вместо монолитной"
        ],
        correctAnswerIndex: 0,
        explanation: "Главный принцип — никогда не смешивать данные с кодом. Используйте параметризованные запросы, ORM, подготовленные выражения (prepared statements). Это описано в разделе 'Используйте белые списки и избегайте прямых вставок'.",
        link: {
            label: "Раздел 'Советы по проверке защиты' в этом уроке",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Что подразумевается под термином 'Untrusted Data' (Недоверенные данные)?",
        answers: [
            "Любые данные из внешних источников: HTTP-запросы, файлы, данные от API, пользовательский ввод",
            "Только данные, введенные анонимными пользователями без аутентификации",
            "Данные, которые не прошли проверку антивирусом на сервере",
            "Информация из баз данных, к которым нет прямого доступа у приложения",
            "Данные, передаваемые по HTTP без шифрования TLS",
            "Только данные из форм, помеченных как небезопасные в HTML",
            "Информация от пользователей с низким уровнем доверия в системе"
        ],
        correctAnswerIndex: 0,
        explanation: "Недоверенные данные — это ВСЕ данные извне: HTTP запросы, файлы, базы данных, API. Как сказано в уроке: 'Не работать с данными поступающими от пользователя без обработки'.",
        link: {
            label: "Совет 1: Проверяем все данные поступающие от пользователя",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Какой тип инъекции позволяет выполнять вредоносный JavaScript-код в браузере пользователя?",
        answers: [
            "Cross-Site Scripting (XSS) — внедрение и выполнение скриптов в контексте браузера жертвы",
            "SQL Injection — внедрение кода в запросы к базе данных на стороне сервера",
            "Command Injection — выполнение системных команд на сервере приложения",
            "LDAP Injection — манипуляция запросами к службе каталогов",
            "XXE Injection — внедрение внешних сущностей в XML-документы",
            "CRLF Injection — манипуляция HTTP-заголовками через символы переноса строки",
            "Template Injection — внедрение кода в серверные шаблонизаторы"
        ],
        correctAnswerIndex: 0,
        explanation: "XSS позволяет внедрить JavaScript, который выполнится в браузере жертвы. Как сказано в уроке: 'мы можем украсть сессию пользователя или изменить его банковский счет, похитить сенситивную информацию'.",
        link: {
            label: "Урок 2: Cross-Site Scripting (XSS)",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-2"
        }
    },
    {
        question: "Какой тип инъекции считается одним из самых опасных и позволяет напрямую манипулировать базой данных?",
        answers: [
            "SQL Injection — позволяет читать, изменять и удалять данные в базе",
            "HTML Injection — изменение структуры HTML-страницы",
            "XSS — выполнение JavaScript в браузере пользователя",
            "CSRF — выполнение действий от имени аутентифицированного пользователя",
            "Path Traversal — доступ к файлам за пределами web-директории",
            "Session Fixation — фиксация сессии для захвата аккаунта",
            "Open Redirect — перенаправление на вредоносный сайт"
        ],
        correctAnswerIndex: 0,
        explanation: "SQL Injection отмечена в уроке как 'Один из самых опасных видов уязвимостей'. Злоумышленник может читать, записывать, вносить изменения или даже удалить данные.",
        link: {
            label: "Урок 4: SQL Injection",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-4"
        }
    },
    {
        question: "Какой тип инъекции дает атакующему прямой доступ к выполнению команд операционной системы сервера?",
        answers: [
            "Command Injection — выполнение команд ОС (pwd, ls, dir) через приложение",
            "SQL Injection — выполнение SQL-запросов к базе данных",
            "XSS — выполнение JavaScript в браузере клиента",
            "XXE — чтение файлов через XML-парсер",
            "SSRF — отправка запросов от имени сервера к внутренним ресурсам",
            "Prototype Pollution — модификация прототипов JavaScript-объектов",
            "Deserialization — выполнение кода при десериализации объектов"
        ],
        correctAnswerIndex: 0,
        explanation: "Command Injection позволяет выполнять команды ОС. В уроке сказано: 'Урон от такого колоссальный, т.к. имеем доступ напрямую к серверу'.",
        link: {
            label: "Урок 5: Command Injection",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-5"
        }
    },
    {
        question: "Что такое XXE (XML External Entity) Injection?",
        answers: [
            "Уязвимость, позволяющая читать файлы сервера и взаимодействовать с внутренними системами через XML-парсер",
            "Атака на внешние JavaScript-библиотеки, подключенные к странице",
            "Внедрение вредоносных стилей через внешние CSS-файлы",
            "Техника обхода CORS-политик через подмену заголовков Origin",
            "Метод подмены сертификатов при MitM-атаке на HTTPS",
            "Атака на внешние API через подмену endpoint-адресов",
            "Внедрение вредоносных зависимостей в package.json проекта"
        ],
        correctAnswerIndex: 0,
        explanation: "XXE позволяет читать файлы на сервере (например, /etc/passwd) и взаимодействовать с внутренними системами. Это описано в разделе про XXE в этом уроке.",
        link: {
            label: "Урок 6: XXE (XML External Entity)",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-6"
        }
    },
    {
        question: "Почему важно тестировать приложение на обработку различных типов кодировок ввода?",
        answers: [
            "Приложения могут декодировать URI-значения (%2F → /) и выполнить вредоносный payload",
            "Различные кодировки влияют только на отображение текста, но не на безопасность",
            "Кодировки важны только для многоязычных сайтов с Unicode-символами",
            "Тестирование кодировок нужно только для API, работающих с бинарными данными",
            "Кодировки проверяются автоматически браузером и не требуют ручного тестирования",
            "Только Base64-кодировка может скрывать вредоносный код",
            "Кодировки влияют только на производительность парсинга данных"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке сказано: 'Замечайте случаи, когда сайты принимают URI-закодированные значения, такие, как %2F и рендерят их декодированные значения'. Двойное кодирование (%252F) может обойти фильтры.",
        link: {
            label: "Совет 3: Тестируйте различные типы ввода",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Почему важно проверять безопасность после каждого обновления кода?",
        answers: [
            "Новый код может содержать новые уязвимости, а исправления могут быть неполными",
            "Обновления автоматически исправляют все известные уязвимости без остатка",
            "Проверки нужны только при крупных релизах, а не при мелких обновлениях",
            "Современные CI/CD-системы полностью исключают появление уязвимостей",
            "Обновления кода не влияют на ранее протестированный функционал",
            "Достаточно проверить только изменённые файлы, остальной код безопасен",
            "Автоматические тесты заменяют ручное тестирование безопасности"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке подчеркивается: 'Одно лишь то, что код был обновлен, не значит, что что-то было исправлено. Когда выкатывают обновление, это так же значит, что новый код может содержать баги.'",
        link: {
            label: "Совет 4: Проверяйте код после обновлений",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Что эффективнее для защиты от инъекций: белый список (Allow list) или черный список (Block list)?",
        answers: [
            "Белый список — разрешать только заведомо безопасные значения, черные списки легко обойти",
            "Черный список — блокировать все известные вредоносные паттерны атак",
            "Оба подхода одинаково эффективны при правильной реализации",
            "Серый список — комбинация белого и черного для баланса безопасности",
            "Черный список эффективнее, так как покрывает больше сценариев атак",
            "Ни один из подходов не работает без дополнительного шифрования",
            "Красный список — особый режим для критических систем"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке сказано: 'Не помещать в запрос управляющие структуры и идентификаторы, введенные пользователем, а заранее прописывать в скрипте список возможных вариантов'. Белый список надежнее.",
        link: {
            label: "Совет 2: Используйте белые списки",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Что такое HTML Injection и чем она отличается от XSS?",
        answers: [
            "HTML Injection позволяет внедрять HTML-теги и менять вид страницы, XSS — выполнять JavaScript-код",
            "HTML Injection и XSS — это одно и то же, просто разные названия",
            "HTML Injection работает только на стороне сервера, XSS — на клиенте",
            "HTML Injection влияет только на мобильные браузеры",
            "XSS — устаревшее название для HTML Injection",
            "HTML Injection требует авторизации, XSS работает без неё",
            "HTML Injection быстрее выполняется, чем XSS"
        ],
        correctAnswerIndex: 0,
        explanation: "Как сказано в уроке: 'HTML Injection — когда приложение принимает и интерпретирует теги HTML и мы можем изменить вид страниц или сделать вредоносную ссылку'. XSS идет дальше — выполняет скрипты.",
        link: {
            label: "Урок 3: HTML Injection",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-3"
        }
    },
    {
        question: "На что нужно обращать внимание при анализе URL-параметров приложения?",
        answers: [
            "Параметры URL могут отображаться на странице и быть точками для инъекций (XSS, SQLi)",
            "URL-параметры всегда безопасны, так как проходят через браузерную валидацию",
            "Только POST-параметры представляют угрозу, GET-параметры безопасны",
            "URL-параметры важны только для SEO-оптимизации сайта",
            "Параметры в URL шифруются браузером автоматически",
            "Только числовые параметры могут быть опасными",
            "URL-параметры проверяются на уровне DNS-сервера"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке сказано: 'Будьте внимательны к передаваемым параметрам URL, которые отображаются в виде содержимого сайта. Они могут содержать возможные точки атаки'.",
        link: {
            label: "Совет 6: Внимательность к URL параметрам",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Что делать, если при тестировании вы подозреваете наличие уязвимости, но не можете её подтвердить?",
        answers: [
            "Продолжать исследование, отмечать риски и вернуться позже с новыми знаниями и инструментами",
            "Игнорировать подозрение — если не подтверждается, значит уязвимости нет",
            "Сразу сообщить о критической уязвимости в отчёте без подтверждения",
            "Перейти к тестированию других частей приложения и забыть об этом",
            "Использовать автоматические сканеры — они всегда находят всё",
            "Считать это ложноположительным срабатыванием",
            "Подождать пока разработчики сами найдут проблему"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке сказано: 'Если вы чувствуете, что что-то не так, продолжайте копать! Отмечайте риски, чтобы позже вернуться к ним с новыми силами и знаниями'.",
        link: {
            label: "Совет 5: Продолжайте исследование при подозрениях",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Какие данные могут стать источником инъекции в веб-приложении?",
        answers: [
            "HTTP-запросы, загруженные файлы, данные из БД, cookies, заголовки, параметры URL",
            "Только данные из форм ввода на главной странице сайта",
            "Только данные, передаваемые через POST-запросы",
            "Только файлы, загружаемые пользователями на сервер",
            "Только данные из cookies и локального хранилища браузера",
            "Только данные от неаутентифицированных пользователей",
            "Только данные, поступающие по незащищённому HTTP-соединению"
        ],
        correctAnswerIndex: 0,
        explanation: "Инъекции возникают когда 'непроверенные данные отправляются интерпретатору'. Источником могут быть любые внешние данные: HTTP запросы, файлы, базы данных и т.д.",
        link: {
            label: "Раздел 'Что такое инъекции кода?'",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Почему инъекции остаются одной из самых распространённых уязвимостей веб-приложений?",
        answers: [
            "Разработчики часто доверяют входным данным и не разделяют данные от кода (команд)",
            "Современные фреймворки не имеют встроенной защиты от инъекций",
            "Инъекции невозможно обнаружить автоматическими средствами тестирования",
            "Все веб-серверы имеют встроенные уязвимости к инъекциям",
            "Браузеры специально пропускают инъекции для обратной совместимости",
            "Инъекции появляются только в устаревших языках программирования",
            "Стандарты HTTP не предусматривают защиту от инъекций"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке указано: 'Инъекции кода всегда являлись одной из самых значимых и распространенных уязвимостей'. Основная причина — нарушение принципа разделения данных и кода.",
        link: {
            label: "Раздел 'Что такое инъекции кода?'",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Какие последствия может иметь успешная атака через SQL Injection?",
        answers: [
            "Чтение, изменение и удаление данных в базе, обход аутентификации, выполнение команд ОС",
            "Только чтение данных без возможности их изменения",
            "Только временное замедление работы базы данных",
            "Только изменение визуального отображения страниц сайта",
            "Только доступ к публичным данным без приватной информации",
            "Только логирование действий пользователя без доступа к данным",
            "Только отправка уведомлений администратору системы"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке SQL Injection описана как 'Один из самых опасных видов уязвимостей. Злоумышленник может читать, записывать, вносить изменения или даже удалить данные'.",
        link: {
            label: "Урок 4: SQL Injection",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-4"
        }
    },
    {
        question: "Какие элементы ответа сервера могут подсказать наличие уязвимости к инъекции?",
        answers: [
            "Сообщения об ошибках, статус-коды HTTP, изменение времени ответа, аномальное поведение",
            "Только явные сообщения об ошибках SQL в теле страницы",
            "Только статус-код 500 Internal Server Error",
            "Только изменение визуального оформления страницы",
            "Только редиректы на страницу ошибки 404",
            "Ответ сервера никогда не выдаёт информацию об уязвимостях",
            "Только наличие CAPTCHA на странице входа"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке сказано: 'Статус ответа сервера или само тело ответа могут быть отличной подсказкой в поиске'. Это включает ошибки, тайминги и аномалии.",
        link: {
            label: "Совет 5: Продолжайте исследование",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Чем опасна HTML Injection для бизнеса компании?",
        answers: [
            "Можно изменить вид страницы, разместить фишинговые ссылки или нанести вред репутации компании",
            "HTML Injection не представляет бизнес-рисков, только технические",
            "Опасна только для разработчиков, пользователи не затронуты",
            "Влияет только на SEO-позиции сайта в поисковых системах",
            "Опасна только при использовании устаревших браузеров",
            "Представляет риск только для интернет-магазинов",
            "Опасна только для мобильных версий сайтов"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке сказано: 'Или просто залить картинку с определенным контентом и нанести вред репутации компании'. HTML Injection может использоваться для фишинга и дефейса.",
        link: {
            label: "Раздел про HTML Injection",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-3"
        }
    },
    {
        question: "Какой подход к безопасности требует постоянного обучения и внимания к деталям?",
        answers: [
            "Тестирование безопасности — это непрерывный процесс, требующий постоянного развития навыков",
            "Достаточно один раз настроить WAF и забыть о безопасности",
            "Безопасность обеспечивается только сертификатами SSL/TLS",
            "После прохождения аудита безопасности дополнительные проверки не нужны",
            "Безопасность полностью автоматизируется современными инструментами",
            "Только специалисты SOC занимаются вопросами безопасности",
            "Безопасность — разовая задача при запуске проекта"
        ],
        correctAnswerIndex: 0,
        explanation: "Заключение урока: 'Помните: безопасность - это непрерывный процесс, требующий постоянного обучения и внимания к деталям'.",
        link: {
            label: "Заключение урока",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Что такое NoSQL Injection и чем она отличается от классической SQL Injection?",
        answers: [
            "NoSQL Injection эксплуатирует документо-ориентированные БД (MongoDB, CouchDB) через JSON/BSON-синтаксис",
            "NoSQL базы данных полностью защищены от инъекций из-за отсутствия SQL",
            "NoSQL Injection работает только в старых версиях баз данных",
            "Это более слабая версия SQL Injection с ограниченными возможностями",
            "NoSQL Injection возможна только при использовании ORM",
            "NoSQL базы автоматически экранируют все входные данные",
            "NoSQL Injection влияет только на производительность запросов"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке упоминается, что инъекции связаны с 'SQL, NoSQL, OS и LDAP'. NoSQL базы также уязвимы — атаки используют специфический синтаксис ($where, $gt, $regex в MongoDB).",
        link: {
            label: "OWASP NoSQL Injection",
            url: "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.6-Testing_for_NoSQL_Injection"
        }
    },
    {
        question: "Что такое LDAP Injection и для каких целей она используется?",
        answers: [
            "Инъекция в запросы к службе каталогов LDAP для обхода аутентификации или получения данных пользователей",
            "Атака на протокол передачи файлов по локальной сети",
            "Внедрение вредоносного кода в сетевые драйверы",
            "Модификация настроек сетевого оборудования",
            "Перехват трафика между серверами в корпоративной сети",
            "Атака на систему распределения IP-адресов DHCP",
            "Внедрение в протокол разрешения имен DNS"
        ],
        correctAnswerIndex: 0,
        explanation: "В уроке LDAP упоминается как один из интерпретаторов, куда могут попасть недоверенные данные. LDAP используется для аутентификации в Active Directory.",
        link: {
            label: "OWASP LDAP Injection Prevention",
            url: "https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html"
        }
    },
    {
        question: "Какие инструменты помогают автоматически обнаруживать инъекции в веб-приложениях?",
        answers: [
            "DAST-сканеры (OWASP ZAP, Burp Suite, Acunetix) для динамического тестирования работающего приложения",
            "Только текстовые редакторы для ручного анализа кода",
            "Антивирусные программы, установленные на сервере",
            "Системы мониторинга производительности (APM)",
            "Инструменты для создания резервных копий базы данных",
            "Программы для оптимизации изображений на сайте",
            "Системы управления версиями (Git, SVN)"
        ],
        correctAnswerIndex: 0,
        explanation: "DAST (Dynamic Application Security Testing) — сканеры, которые тестируют работающее приложение, отправляя вредоносные payload'ы и анализируя ответы.",
        link: {
            label: "OWASP ZAP - бесплатный сканер",
            url: "https://www.zaproxy.org/"
        }
    },
    {
        question: "Чем отличается SAST от DAST при поиске уязвимостей к инъекциям?",
        answers: [
            "SAST анализирует исходный код без запуска приложения, DAST тестирует работающее приложение",
            "SAST и DAST — это одно и то же, просто разные названия",
            "SAST работает быстрее, поэтому всегда предпочтительнее DAST",
            "DAST может найти все уязвимости, которые находит SAST",
            "SAST требует доступа к production-серверу для анализа",
            "DAST анализирует только клиентский JavaScript-код",
            "SAST можно использовать только для Java-приложений"
        ],
        correctAnswerIndex: 0,
        explanation: "SAST (Static) анализирует код, находя опасные паттерны. DAST (Dynamic) тестирует приложение в runtime. Оба подхода дополняют друг друга.",
        link: {
            label: "OWASP Source Code Analysis Tools",
            url: "https://owasp.org/www-community/Source_Code_Analysis_Tools"
        }
    },
    {
        question: "Является ли WAF (Web Application Firewall) полным решением проблемы инъекций?",
        answers: [
            "Нет, WAF — это дополнительный слой защиты, но уязвимость в коде остаётся и может быть обойдена",
            "Да, WAF полностью защищает от всех видов инъекций",
            "WAF защищает только от SQL Injection, но не от XSS",
            "WAF работает только для приложений на PHP",
            "WAF заменяет необходимость валидации входных данных",
            "WAF эффективен только в облачных окружениях",
            "WAF защищает только от атак со старых IP-адресов"
        ],
        correctAnswerIndex: 0,
        explanation: "WAF — это Defense in Depth (эшелонированная защита). Он может блокировать известные паттерны атак, но опытные атакующие находят обходы. Код нужно исправлять.",
        link: {
            label: "OWASP Web Application Firewall",
            url: "https://owasp.org/www-community/Web_Application_Firewall"
        }
    },
    {
        question: "Что такое Blind SQL Injection и чем она отличается от обычной?",
        answers: [
            "При Blind SQLi приложение не возвращает данные напрямую, но реагирует по-разному (задержка, True/False)",
            "Blind SQLi — это инъекция, которую невозможно эксплуатировать",
            "Blind SQLi работает только на сайтах без HTTPS",
            "Это устаревший термин, который больше не используется",
            "Blind SQLi возможна только в Oracle-базах данных",
            "Слепая инъекция означает, что атакующий не видит экран",
            "Blind SQLi опаснее, так как не оставляет логов"
        ],
        correctAnswerIndex: 0,
        explanation: "При Blind SQLi сервер не показывает ошибки или данные, но атакующий определяет результат по косвенным признакам: разное время ответа или разное содержимое страницы.",
        link: {
            label: "PortSwigger: Blind SQL Injection",
            url: "https://portswigger.net/web-security/sql-injection/blind"
        }
    },
    {
        question: "Что такое Time-based Blind SQL Injection?",
        answers: [
            "Техника, при которой результат инъекции определяется по времени ответа сервера (SLEEP, WAITFOR DELAY)",
            "Инъекция, которая работает только в определённое время суток",
            "Атака с ограничением по времени выполнения",
            "Инъекция в функции работы с датой и временем в SQL",
            "Атака, которая срабатывает через определённый интервал",
            "Техника замедления работы базы данных",
            "Инъекция в timestamp-поля таблицы"
        ],
        correctAnswerIndex: 0,
        explanation: "Time-based Blind SQLi использует функции задержки (SLEEP в MySQL, WAITFOR DELAY в MSSQL). Если сервер 'задумался' — условие True.",
        link: {
            label: "PortSwigger: Blind SQL Injection",
            url: "https://portswigger.net/web-security/sql-injection/blind"
        }
    },
    {
        question: "Какой принцип безопасности требует предоставления минимально необходимых прав?",
        answers: [
            "Principle of Least Privilege — пользователь или процесс должен иметь только те права, которые необходимы",
            "Principle of Maximum Security — максимальные ограничения для всех",
            "Principle of Open Access — открытый доступ ко всем ресурсам по умолчанию",
            "Principle of Shared Responsibility — все пользователи имеют одинаковые права",
            "Principle of Default Admin — все получают права администратора",
            "Principle of Trust — доверие всем пользователям системы",
            "Principle of Convenience — удобство важнее безопасности"
        ],
        correctAnswerIndex: 0,
        explanation: "Least Privilege смягчает последствия инъекции: если пользователь БД не имеет прав на DROP TABLE, атакующий не сможет удалить таблицы даже при успешной SQLi.",
        link: {
            label: "OWASP Principle of Least Privilege",
            url: "https://owasp.org/www-community/Principle_of_least_privilege"
        }
    },
    {
        question: "Что такое Defense in Depth (Эшелонированная защита)?",
        answers: [
            "Многоуровневая защита: валидация ввода + параметризация + WAF + минимальные права + мониторинг",
            "Один очень мощный слой защиты, заменяющий все остальные",
            "Защита только внешнего периметра сети",
            "Использование нескольких антивирусов одновременно",
            "Глубокий анализ кода раз в год",
            "Установка firewall на каждом компьютере сети",
            "Многократное шифрование одних и тех же данных"
        ],
        correctAnswerIndex: 0,
        explanation: "Defense in Depth — концепция, при которой несколько слоёв защиты страхуют друг друга. Если WAF пропустит атаку, её остановит параметризация запросов.",
        link: {
            label: "OWASP Defense in Depth",
            url: "https://owasp.org/www-community/Defense_in_Depth"
        }
    },
    {
        question: "Может ли инъекция произойти через данные из сторонних API (Third-party)?",
        answers: [
            "Да, если приложение доверяет данным от внешнего API и не валидирует их перед использованием",
            "Нет, все API автоматически возвращают безопасные данные",
            "Только если API не использует HTTPS",
            "Только для API без аутентификации",
            "Только для устаревших REST API версии 1.0",
            "Только если API принадлежит конкуренту",
            "API-данные проходят валидацию на стороне провайдера"
        ],
        correctAnswerIndex: 0,
        explanation: "Данные от любого внешнего источника — недоверенные. Даже если API партнёра был взломан или возвращает некорректные данные, ваше приложение должно их валидировать.",
        link: {
            label: "Раздел про недоверенные данные",
            url: "https://aqwise.github.io/security_testing_course/school/injections/lesson-1"
        }
    },
    {
        question: "Что такое Second Order Injection (Инъекция второго порядка)?",
        answers: [
            "Когда вредоносные данные сохраняются в БД, а срабатывают позже при извлечении в другом контексте",
            "Второй тип SQL-инъекции после обычной",
            "Инъекция, требующая двух попыток для успеха",
            "Атака через два разных параметра одновременно",
            "Инъекция с использованием двойных кавычек",
            "Вторичная проверка безопасности после основной",
            "Атака на резервную копию базы данных"
        ],
        correctAnswerIndex: 0,
        explanation: "Second Order Injection опасна тем, что данные проходят первичную валидацию при сохранении, но не проверяются при извлечении и использовании.",
        link: {
            label: "PortSwigger: Second Order SQL Injection",
            url: "https://portswigger.net/kb/issues/00100210_sql-injection-second-order"
        }
    },
    {
        question: "Что такое Template Injection (SSTI — Server-Side Template Injection)?",
        answers: [
            "Внедрение кода в серверные шаблонизаторы (Jinja2, Twig, FreeMarker), часто приводящее к RCE",
            "Инъекция в HTML-шаблоны на стороне браузера",
            "Модификация CSS-стилей через специальные теги",
            "Атака на системы генерации PDF-документов",
            "Внедрение в шаблоны email-рассылок",
            "Изменение структуры шаблонов баз данных",
            "Атака на системы автоматической генерации кода"
        ],
        correctAnswerIndex: 0,
        explanation: "SSTI позволяет выполнять произвольный код на сервере через шаблонизаторы. Payload {{7*7}} возвращающий 49 — типичный тест на уязвимость.",
        link: {
            label: "PortSwigger: SSTI",
            url: "https://portswigger.net/web-security/server-side-template-injection"
        }
    },
    {
        question: "Что такое Output Encoding и зачем оно нужно?",
        answers: [
            "Преобразование данных перед выводом в контекст (HTML, JS, URL), чтобы они воспринимались как данные, а не код",
            "Сжатие данных для уменьшения размера страницы",
            "Шифрование данных перед отправкой клиенту",
            "Перевод текста на другие языки программирования",
            "Форматирование данных для вывода в Excel",
            "Кодирование видео для стриминга",
            "Конвертация изображений в Base64"
        ],
        correctAnswerIndex: 0,
        explanation: "Output Encoding защищает от XSS: символ < становится &lt; и не интерпретируется как начало тега. Разные контексты требуют разного кодирования.",
        link: {
            label: "OWASP XSS Prevention Cheat Sheet",
            url: "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
        }
    },
    {
        question: "Что такое CVE и для чего используется этот идентификатор?",
        answers: [
            "Common Vulnerabilities and Exposures — база данных общеизвестных уязвимостей с уникальными идентификаторами",
            "Сертификат безопасности для веб-сайтов",
            "Система оценки критичности уязвимостей",
            "Протокол шифрования данных",
            "Стандарт разработки безопасного кода",
            "Лицензия на использование средств защиты",
            "Формат логирования событий безопасности"
        ],
        correctAnswerIndex: 0,
        explanation: "CVE (например, CVE-2021-44228 — Log4Shell) позволяет однозначно идентифицировать уязвимость и найти информацию о ней, включая патчи и эксплойты.",
        link: {
            label: "CVE Database",
            url: "https://cve.mitre.org/"
        }
    },
    {
        question: "Что такое CWE и чем он отличается от CVE?",
        answers: [
            "Common Weakness Enumeration — классификация типов слабостей кода (CWE-89: SQLi, CWE-79: XSS)",
            "CWE и CVE — это одна и та же система с разными названиями",
            "CWE — это более новая версия CVE",
            "CWE используется только для критических уязвимостей",
            "CWE описывает только уязвимости в сетевых протоколах",
            "CWE применяется только для Open Source проектов",
            "CWE — закрытая база данных для крупных компаний"
        ],
        correctAnswerIndex: 0,
        explanation: "CWE — классификация типов слабостей (SQL Injection = CWE-89), CVE — конкретные уязвимости в конкретных продуктах. CWE описывает 'что', CVE — 'где'.",
        link: {
            label: "CWE Database",
            url: "https://cwe.mitre.org/"
        }
    },
    {
        question: "Что такое CVSS и какие оценки считаются критическими?",
        answers: [
            "Common Vulnerability Scoring System — оценка критичности от 0 до 10, где 9.0-10.0 = Critical",
            "Система сертификации специалистов по безопасности",
            "Протокол обмена данными об уязвимостях между компаниями",
            "Стандарт шифрования конфиденциальных данных",
            "Метод автоматического исправления уязвимостей",
            "Формат отчётов для Bug Bounty программ",
            "Система приоритизации обновлений ПО"
        ],
        correctAnswerIndex: 0,
        explanation: "CVSS помогает приоритизировать уязвимости. Оценка зависит от: вектора атаки, сложности, необходимых прав, влияния на CIA. RCE через сеть без аутентификации ≈ 10.0.",
        link: {
            label: "CVSS Calculator",
            url: "https://www.first.org/cvss/calculator/3.1"
        }
    },
    {
        question: "Что такое Fuzzing и как он помогает находить инъекции?",
        answers: [
            "Автоматическая отправка случайных/невалидных данных для вызова ошибок и обнаружения уязвимостей",
            "Техника размытия изображений для скрытия данных",
            "Метод шифрования данных с добавлением шума",
            "Способ сжатия логов для экономии места",
            "Техника маскировки IP-адреса при тестировании",
            "Метод защиты от автоматических сканеров",
            "Алгоритм генерации случайных паролей"
        ],
        correctAnswerIndex: 0,
        explanation: "Fuzzing отправляет спецсимволы (', \", <, >, |, ;) и наблюдает за реакцией. Инструменты: wfuzz, ffuf, Burp Intruder. Аномальный ответ может указать на уязвимость.",
        link: {
            label: "OWASP Fuzzing",
            url: "https://owasp.org/www-community/Fuzzing"
        }
    },
    {
        question: "Какой тип инструментов используется для ручного тестирования веб-приложений на инъекции?",
        answers: [
            "Intercepting Proxy (Burp Suite, OWASP ZAP) — для перехвата и модификации HTTP-запросов",
            "Текстовые редакторы (Notepad, VS Code) — для анализа HTML-кода",
            "Браузерные DevTools — достаточны для полного тестирования",
            "Антивирусные сканеры — для поиска вредоносного кода",
            "Системы мониторинга (Grafana, Kibana) — для анализа логов",
            "IDE (IntelliJ, Eclipse) — для отладки серверного кода",
            "Системы контроля версий (Git) — для отслеживания изменений"
        ],
        correctAnswerIndex: 0,
        explanation: "Intercepting Proxy позволяет перехватывать запросы, модифицировать параметры, повторять с payload'ами и анализировать ответы сервера.",
        link: {
            label: "OWASP ZAP Getting Started",
            url: "https://www.zaproxy.org/getting-started/"
        }
    },
    {
        question: "Какой CWE-идентификатор соответствует уязвимости SQL Injection?",
        answers: [
            "CWE-89: Improper Neutralization of Special Elements used in an SQL Command",
            "CWE-79: Improper Neutralization of Input During Web Page Generation (XSS)",
            "CWE-78: Improper Neutralization of Special Elements used in an OS Command",
            "CWE-22: Improper Limitation of a Pathname to a Restricted Directory",
            "CWE-611: Improper Restriction of XML External Entity Reference",
            "CWE-352: Cross-Site Request Forgery (CSRF)",
            "CWE-287: Improper Authentication"
        ],
        correctAnswerIndex: 0,
        explanation: "CWE-89 описывает SQL Injection. CWE-79 — XSS, CWE-78 — Command Injection. Знание CWE помогает в поиске документации и инструментов защиты.",
        link: {
            label: "CWE-89: SQL Injection",
            url: "https://cwe.mitre.org/data/definitions/89.html"
        }
    },
    {
        question: "Что такое Prepared Statements (Подготовленные выражения) и как они защищают от SQLi?",
        answers: [
            "Механизм, при котором SQL-запрос и данные передаются отдельно, данные никогда не интерпретируются как код",
            "Заранее подготовленные шаблоны ответов на SQL-ошибки",
            "Система кеширования часто используемых запросов для ускорения",
            "Метод шифрования SQL-запросов перед отправкой в БД",
            "Инструмент для автоматической генерации SQL-запросов",
            "Способ логирования всех SQL-запросов для аудита",
            "Техника оптимизации производительности базы данных"
        ],
        correctAnswerIndex: 0,
        explanation: "Prepared Statements — главная защита от SQLi. База данных получает структуру запроса отдельно от данных и не может интерпретировать данные как SQL-код.",
        link: {
            label: "OWASP SQL Injection Prevention",
            url: "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html"
        }
    }
];
