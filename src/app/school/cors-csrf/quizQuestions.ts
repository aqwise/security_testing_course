export const quizQuestions = [
    {
        question: "1. Что означает аббревиатура CORS?",
        answers: [
            "Cross-Origin Resource Sharing",
            "Cross-Origin Request Security",
            "Common Origin Resource System",
            "Computer Online Recovery System"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "2. Что означает аббревиатура CSRF?",
        answers: [
            "Cross-Site Request Forgery",
            "Common System Request Format",
            "Client-Side Resource Fetching",
            "Cross-Site Resource Fix"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "3. Какова основная цель SOP (Same-Origin Policy)?",
        answers: [
            "Ускорить загрузку сайта",
            "Запретить скриптам с одного источника (Origin) читать данные с другого источника",
            "Запретить использование кук",
            "Шифровать трафик"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "4. Какие три параметра составляют Origin?",
        answers: [
            "IP, MAC, Порт",
            "Протокол, Домен, Порт",
            "Страна, Город, Провайдер",
            "Браузер, ОС, Версия"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "5. В чем главное отличие CORS от CSRF?",
        answers: [
            "CORS - это атака, CSRF - защита",
            "CORS - это механизм контроля доступа к ресурсам (чтение данных), а CSRF - это атака, заставляющая выполнить действие (изменение данных)",
            "Они ничем не отличаются",
            "CORS работает только в IE"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "6. Какой HTTP метод обычно считается 'безопасным' и не требует Pre-flight запроса (при простых заголовках)?",
        answers: [
            "PUT",
            "DELETE",
            "GET",
            "PATCH"
        ],
        correctAnswerIndex: 2
    },
    {
        question: "7. Зачем браузер отправляет запрос OPTIONS перед основным запросом?",
        answers: [
            "Чтобы проверить скорость соединения",
            "Это Pre-flight запрос для проверки прав доступа (CORS) перед выполнением 'опасного' метода или передачей кастомных заголовков",
            "Это ошибка браузера",
            "Чтобы узнать время на сервере"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "8. Что делает заголовок `Access-Control-Allow-Origin: *`?",
        answers: [
            "Запрещает доступ всем",
            "Разрешает доступ к ресурсу с любого домена (публичный доступ)",
            "Разрешает доступ только админам",
            "Это некорректный заголовок"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "9. Безопасно ли использовать `Access-Control-Allow-Origin: *` вместе с `Access-Control-Allow-Credentials: true`?",
        answers: [
            "Да, это стандарт",
            "Нет, такая комбинация запрещена спецификацией (браузер выдаст ошибку), но если сервер динамически подставляет Origin - это критическая уязвимость",
            "Только для HTTPS",
            "Да, для GET запросов"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "10. В чем суть атаки CSRF?",
        answers: [
            "Хакер крадет пароль жертвы",
            "Хакер заставляет браузер жертвы выполнить запрос к уязвимому сайту (где жертва залогинена) от её имени, используя её куки",
            "Хакер взламывает сервер",
            "Хакер перехватывает Wi-Fi"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "11. Какой атрибут Cookie помогает защититься от CSRF?",
        answers: [
            "HttpOnly",
            "SameSite (Strict или Lax)",
            "Secure",
            "Domain"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "12. Что делает `SameSite=Strict`?",
        answers: [
            "Кука отправляется только при запросах с того же сайта, полная блокировка отправки при переходе по ссылкам извне",
            "Разрешает все",
            "Шифрует куку",
            "Удаляет куку при закрытии вкладки"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "13. Что такое CSRF-токен?",
        answers: [
            "Пароль пользователя",
            "Случайное, непредсказуемое значение, генерируемое сервером для сессии пользователя, которое должно передаваться в каждом модифицирующем запросе (POST)",
            "Токен авторизации JWT",
            "API ключ"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "14. Почему CSRF атака возможна?",
        answers: [
            "Потому что браузеры автоматически прикрепляют куки к запросам на целевой домен, даже если запрос инициирован с другого сайта",
            "Потому что сервер слабый",
            "Потому что интернет опасен",
            "Потому что HTTP протокол устарел"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "15. Защищают ли заголовки CORS от CSRF?",
        answers: [
            "Да, полностью",
            "Нет, CORS блокирует чтение ответа, но не обязательно предотвращает выполнение запроса (side effects) на сервере",
            "CORS и CSRF это одно и то же",
            "Зависит от браузера"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "16. Можно ли прочитать содержимое `http://google.com` через скрипт на `http://mysite.com` по умолчанию?",
        answers: [
            "Да, легко",
            "Нет, SOP запрещает чтение ответа, если Google явно не разрешил это через CORS",
            "Только в режиме инкогнито",
            "Да, через iframe"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "17. Какой заголовок запроса указывает на источник, инициировавший запрос?",
        answers: [
            "Referer и Origin",
            "Host",
            "User-Agent",
            "Cookie"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "18. Является ли проверка только заголовка Referer надежной защитой от CSRF?",
        answers: [
            "Да, хакер не может его подделать",
            "Нет, Referer может быть скрыт (политикой приватности) или подделан в некоторых редких сценариях (хотя в браузере это сложно)",
            "Да, это стандарт RFC",
            "Только для GET запросов"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "19. Что такое 'Simple Request' в контексте CORS?",
        answers: [
            "Запрос без параметров",
            "Запрос, который не вызывает Pre-flight (HEAD, GET, POST) и использует только безопасные заголовки",
            "Запрос на локалхост",
            "Запрос картинки"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "20. Почему использование `null` в Origin (например, `Access-Control-Allow-Origin: null`) опасно?",
        answers: [
            "Это вызывает ошибку сервера",
            "Некоторые запросы (из песочницы iframe, локальные файлы) имеют origin 'null', что может позволить атакующему обойти защиту",
            "Null это ноль",
            "Это замедляет парсинг"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "21. Должен ли CSRF токен быть привязан к сессии пользователя?",
        answers: [
            "Нет, он может быть общим для всех",
            "Да, иначе злоумышленник может получить свой токен и подставить его жертве (CSRF с фиксацией токена)",
            "Не обязательно",
            "Только для админов"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "22. Как передавать CSRF токен безопаснее всего?",
        answers: [
            "В URL параметре (GET)",
            "В скрытом поле формы (для POST) или специальном HTTP заголовке (для AJAX)",
            "В куках (без дублирования)",
            "По почте"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "23. Что такое Double Submit Cookie паттерн защиты?",
        answers: [
            "Отправка двух кук сразу",
            "Клиент читает токен из куки и отправляет его же в заголовке/теле запроса. Сервер сверяет их. (Работает, так как хакер не может прочесть куку для сайта)",
            "Двойная проверка пароля",
            "Использование двух браузеров"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "24. Уязвим ли JSON API к CSRF?",
        answers: [
            "Нет, формы не отправляют JSON",
            "Да, если Content-Type не проверяется строго или если используется `text/plain` для отправки валидного JSON",
            "JSON безопасен по определению",
            "Только если используется XML"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "25. Что такое 'Credentials' в контексте fetch/XHR?",
        answers: [
            "Пароль пользователя",
            "Куки, HTTP-аутентификация и клиентские SSL сертификаты",
            "Права доступа",
            "Ключи шифрования"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "26. Какой заголовок ответа разрешает браузеру читать данные при запросе с credentials (true)?",
        answers: [
            "Access-Control-Allow-Credentials: true",
            "Allow-Auth: true",
            "CORS-Secure: on",
            "Cookie-Share: yes"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "27. Почему POST запросы не защищают от CSRF автоматически?",
        answers: [
            "Они защищают",
            "Потому что HTML формы могут отправлять POST запросы с любого домена",
            "Потому что POST устарел",
            "Потому что хакер может превратить POST в GET"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "28. Что произойдет, если на `bank.com` нет защиты CSRF и вы зашли на `evil.com`, где есть скрытая форма перевода денег?",
        answers: [
            "Браузер заблокирует запрос",
            "Запрос выполнится, деньги уйдут (если вы залогинены и кука подставилась)",
            "Сайт упадет",
            "Всплывет предупреждение"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "29. Можно ли защититься от CSRF, проверяя только наличие куки сессии?",
        answers: [
            "Да, если кука HttpOnly",
            "Нет, кука подставляется браузером автоматически, сервер должен проверять дополнительный фактор (токен или заголовок)",
            "Да, если кука длинная",
            "Только в Chrome"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "30. Как работает отражение Origin (Origin Reflection) уязвимость?",
        answers: [
            "Сервер зеркалит экран пользователя",
            "Сервер слепо копирует значение из заголовка Origin запроса в заголовок Access-Control-Allow-Origin ответа",
            "Сервер отражает атаки",
            "Это функция кэширования"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "31. Что делает `Access-Control-Expose-Headers`?",
        answers: [
            "Скрывает заголовки",
            "Разрешает скрипту на клиенте доступ к указанным заголовкам ответа (которые иначе скрыты)",
            "Удаляет заголовки",
            "Блокирует заголовки"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "32. Является ли XSS вектором для обхода CSRF защиты?",
        answers: [
            "Нет, это разные вещи",
            "Да, через XSS можно прочитать CSRF токен (даже из формы) и выполнить валидный запрос",
            "Только если токен в URL",
            "Нет, XSS работает только на клиенте"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "33. Зачем ограничивать методы (Allow-Methods) в CORS?",
        answers: [
            "Для красоты",
            "Чтобы минимизировать поверхность атаки, разрешая только необходимые методы (например, только GET)",
            "Чтобы ускорить сервер",
            "Это требование HTTP/2"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "34. Как долго кешируется Pre-flight запрос?",
        answers: [
            "Вечно",
            "Задается заголовком `Access-Control-Max-Age`",
            "1 минута",
            "Не кешируется"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "35. Безопасно ли разрешать CORS для всех поддоменов `*.example.com`?",
        answers: [
            "Да, это одна компания",
            "Рискованно. Если хотя бы один поддомен уязвим (XSS) или захвачен (Subdomain Takeover), атакующий получит доступ к данным основного домена",
            "Да, если HTTPS",
            "Нет, регулярки не работают"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "36. Что такое 'Login CSRF'?",
        answers: [
            "Взлом логина",
            "Атака, при которой хакер логинит жертву под СВОИМ аккаунтом. Жертва сохраняет данные карты или историю поиска, и они попадают к хакеру",
            "Удаление логина",
            "Блокировка входа"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "37. Помогают ли капчи (CAPTCHA) от CSRF?",
        answers: [
            "Нет",
            "Да, так как для отправки формы нужно ручное действие, которое скрипт не может выполнить (если капча не сломана)",
            "Только от ботов",
            "Нет, они для спама"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "38. Должен ли Re-authentication (повторный ввод пароля) защищать от CSRF?",
        answers: [
            "Да, это эффективная мера для критических действий (смена пароля, email)",
            "Нет, пароль можно подставить",
            "Только для админов",
            "Это неудобно"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "39. Что, если токен CSRF передается в URL?",
        answers: [
            "Это нормально",
            "Это уязвимость, так как URL сохраняется в истории, логах и Referer заголовке",
            "Это удобно для закладок",
            "Это стандарт GET запросов"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "40. Что такое 'Lax' значение для SameSite (по дефолту в современных браузерах)?",
        answers: [
            "Куки не отправляются никуда",
            "Куки отправляются при навигации (переходе по ссылке) на сайт, но не при фоновых запросах (AJAX, Image) с других сайтов",
            "Куки отправляются везде",
            "Все разрешено"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "41. Можно ли подделать Origin заголовок из JS в браузере?",
        answers: [
            "Да, через `setHeader`",
            "Нет, это защищенный заголовок (Forbidden Header Name), браузер сам его устанавливает",
            "Да, в режиме отладки",
            "Только в Firefox"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "42. Почему локальные файлы (file://) часто имеют проблемный Origin?",
        answers: [
            "У них нет домена",
            "Их Origin часто определяется как `null`, что может быть ошибочно добавлено в белый список",
            "Они не используют HTTP",
            "Это вирусы"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "43. Как проверить, уязвим ли сайт к CSRF, используя Burp Suite?",
        answers: [
            "Нажать 'Scan'",
            "Использовать 'Generate CSRF PoC', сохранить как HTML и открыть в браузере, будучи залогиненным (в другой вкладке)",
            "Посмотреть заголовки",
            "Это невозможно"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "44. Если сайт не использует куки для авторизации (только JWT в LocalStorage), нужен ли CSRF токен?",
        answers: [
            "Да, всегда нужен",
            "Обычно нет, так как LocalStorage не отправляется автоматически с запросом. Но нужно защищаться от XSS (чтобы не украли токен)",
            "Зависит от фазы луны",
            "Нет, LocalStorage небезопасен"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "45. Работает ли CSRF для GET запросов?",
        answers: [
            "Нет, GET безопасен",
            "Да, если GET запрос меняет состояние сервера (чего делать нельзя по стандарту, но бывает)",
            "Только для картинок",
            "Нет, браузер блокирует"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "46. Что приоритетнее при проверке: Origin или Referer?",
        answers: [
            "Referer",
            "Origin более надежен (его сложнее скрыть/подделать и он есть при POST), но лучше проверять оба",
            "Оба бесполезны",
            "Cookie"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "47. Как влияет атрибут `target='_blank'` на безопасность ссылок?",
        answers: [
            "Никак",
            "Если нет `rel='noopener'`, новая страница может получить доступ к `window.opener` и перенаправить исходную страницу (Tabnabbing)",
            "Открывает в новом окне",
            "Делает ссылку синей"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "48. Может ли Flash или Silverlight отправить запрос на другой домен?",
        answers: [
            "Нет, они умерли",
            "Раньше могли, используя `crossdomain.xml`. Сейчас это менее актуально, но стоит помнить о legacy",
            "Да, всегда",
            "Только с разрешения админа"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "49. Как правильно реализовать Logout для защиты от CSRF?",
        answers: [
            "Просто удалить куку на клиенте",
            "Инвалидировать сессию на сервере. Желательно требовать CSRF токен и для Logout (чтобы хакер не мог 'выкинуть' пользователя)",
            "Закрыть вкладку",
            "Перезагрузить ПК"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "50. Какой лучший способ защиты от всех уязвимостей сразу?",
        answers: [
            "Выключить компьютер",
            "Глубокая защита (Defense in Depth): CSP, CSRF токены, Secure Cookies, валидация ввода, CORS whitelist",
            "Использовать только HTTPS",
            "Нанять охранника"
        ],
        correctAnswerIndex: 1
    }
    ,
    {
        question: "51. Как заголовок `Access-Control-Allow-Methods` влияет на безопасность?",
        answers: [
            "Он не влияет, это просто информация",
            "Он ограничивает, какие методы (PUT, DELETE) браузер может использовать в кросс-доменных запросах, снижая риск случайного выполнения опасных действий",
            "Он ускоряет запросы",
            "Он шифрует методы"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "52. Можно ли осуществить CSRF атаку через тег `<img>`?",
        answers: [
            "Нет, картинки безопасны",
            "Да, но только GET запросом. Если приложение выполняет действия по GET (нарушение стандарта), то img src='...' выполнит атаку",
            "Только если картинка в формате SVG",
            "Только в браузере IE"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "53. Что такое 'Flash-based CSRF'?",
        answers: [
            "Атака с использованием Adobe Flash для отправки сложных запросов (в т.ч. POST с произвольным телом), если crossdomain.xml настроен слишком широко",
            "Атака с яркой вспышкой экрана",
            "Атака на BIOS",
            "Атака на USB флешку"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "54. Как Content-Type `text/plain` может использоваться для обхода CSRF защиты?",
        answers: [
            "Никак",
            "HTML формы могут отправлять `text/plain`, что позволяет сформировать (почти) валидный JSON тело для API, если API не проверяет строго Content-Type",
            "Это самый безопасный тип",
            "Он шифрует данные"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "55. Какой риск несет `Access-Control-Allow-Origin: null` для локальных HTML файлов?",
        answers: [
            "Никакого",
            "Локальный файл (открытый жертвой с диска или из архива) имеет Origin 'null' и сможет читать данные с вашего сервера, если этот Origin разрешен",
            "Это замедляет загрузку",
            "Это требует пароль"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "56. Можно ли защититься от CSRF, проверяя `X-Requested-With: XMLHttpRequest`?",
        answers: [
            "Нет, заголовок легко подделать",
            "Раньше считалось надежным (т.к. формы его не шлют), но этот заголовок не обязателен и может отсутствовать. Лучше использовать токены",
            "Да, это 100% защита",
            "Только для Flash"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "57. Что такое 'Referer Policy'?",
        answers: [
            "Политика конфиденциальности",
            "Заголовок, управляющий тем, когда браузер должен отправлять Referer (например, `no-referrer`, `same-origin`, `strict-origin-when-cross-origin`)",
            "Политика компании по ссылкам",
            "Список рефералов"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "58. В чем разница между `Access-Control-Request-Headers` и `Access-Control-Allow-Headers`?",
        answers: [
            "Request - при запросе, Allow - при ответе",
            "Request-Headers отправляет браузер в Pre-flight запросе (спрашивает 'можно ли?'), а Allow-Headers сервер отвечает ('да, можно эти')",
            "Это одно и то же",
            "Один для GET, другой для POST"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "59. Как `document.domain` влияет на SOP?",
        answers: [
            "Не влияет",
            "Позволяет двум страницам на поддоменах (a.site.com и b.site.com) общаться напрямую, если они оба установят `document.domain = 'site.com'` (ослабление SOP)",
            "Это меняет домен сайта",
            "Это запрещено в HTML5"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "60. Что такое 'CORS Preflight Caching' риск?",
        answers: [
            "Кэш переполняется",
            "Если атакующий может заставить кэшировать пермиссивный ответ (через Poisoning), другие пользователи могут быть атакованы. Или наоборот, долгий кэш мешает обновлению политик",
            "Браузер зависает",
            "Сервер падает"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "61. Можно ли выполнить CSRF через `form` с `target='hidden_iframe'`?",
        answers: [
            "Да, это классический способ сделать атаку незаметной для пользователя (страница не перезагружается визуально)",
            "Нет, iframe виден всегда",
            "Нет, формы не работают в iframe",
            "Только в Edge"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "62. Защищает ли HTTPS от CSRF?",
        answers: [
            "Да, полностью",
            "Нет, HTTPS шифрует канал, но не проверяет намерение пользователя. CSRF работает и по HTTPS",
            "Только если сертификат EV",
            "Только с HSTS"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "63. Что такое `Origin: null` в ответе сервера?",
        answers: [
            "Сервер сломан",
            "Это значение заголовка Access-Control-Allow-Origin, которое буквально разрешает доступ источнику 'null' (не безопасно для file:// и sandboxed iframes)",
            "Это отсутствие заголовка",
            "Это ошибка 403"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "64. Как работает 'Cookie Tossing' атака?",
        answers: [
            "Бросание печенья",
            "Атакующий на поддомене (evil.example.com) устанавливает куку для основного домена (.example.com), перетирая легитимную куку или вызывая DoS / CSRF bypass",
            "Удаление кук",
            "Кража кук"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "65. Что такое 'Strict-Transport-Security' (HSTS) и помогает ли он CORS?",
        answers: [
            "Форсирует HTTPS. Прямо не связан с CORS, но предотвращает атаки 'Man-in-the-Middle', которые могут инжектировать зловредные CORS заголовки",
            "Это транспортный налог",
            "Это протокол передачи файлов",
            "Это база данных"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "66. Что такое 'Idempotency' метода и как это связано с CSRF?",
        answers: [
            "Идемпотентность - повторный вызов не меняет состояние. GET должен быть идемпотентным. Если GET меняет данные, он уязвим к тривиальному CSRF",
            "Это сложный пароль",
            "Это уникальный ID",
            "Это ошибка API"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "67. Как CSP (Content Security Policy) влияет на отправку форм (CSRF)?",
        answers: [
            "Не влияет, CSP контролирует загрузку ресурсов и скриптов, но обычно не запрещает отправку форм на другие домены (нужен form-action директива)",
            "Блокирует все формы",
            "Шифрует формы",
            "CSRF невозможен с CSP"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "68. Что такое 'Wildcard Subdomain' в CORS конфигурации?",
        answers: [
            "Регулярное выражение типа `*.example.com` (не поддерживается стандартом CORS, сервер должен сам парсить Origin и возвращать его, если он в белом списке)",
            "Это стандартная фича",
            "Это DNS запись",
            "Это ошибка сертификата"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "69. Может ли WebSocket быть уязвим к CSRF (CSWSH)?",
        answers: [
            "Нет, WS использует другое соединение",
            "Да, Cross-Site WebSocket Hijacking. Если хендшейк WS полагается только на куки (без токенов/проверки Origin), атакующий может открыть сокет от имени жертвы",
            "Только если wss://",
            "Только в Chrome"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "70. Что такое `Vary: Origin` заголовок?",
        answers: [
            "Говорит кэширующим серверам (CDN, Browser Cache), что ответ зависит от заголовка Origin (важно при динамическом CORS: одной Origin - один ответ, другому - другой)",
            "Это переменная JS",
            "Это ошибка вариативности",
            "Изменяет Origin"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "71. Нужно ли защищать API от CSRF, если оно используется мобильным приложением?",
        answers: [
            "Нет",
            "Да, если это же API используется веб-версией (или WebView) и полагается на сессионные куки. Для чисто мобильного API (Bearer token) CSRF не актуален, так как браузер не шлет токены сам",
            "Всегда нужно",
            "Никогда не нужно"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "72. Является ли проверка `if (req.headers.origin !== 'site.com')` достаточной?",
        answers: [
            "Да",
            "Нет, Origin может не прийти (при навигации, некоторых GET запросах). Плюс нужно учитывать поддомены и протокол",
            "Только для POST",
            "Origin подделывается легко"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "73. Что такое 'Same-Origin' request?",
        answers: [
            "Запрос на тот же домен:путь",
            "Запрос, где протокол, порт и хост совпадают с текущей страницей",
            "Запрос на тот же IP",
            "Запрос к базе данных"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "74. Можно ли обойти SOP с помощью DNS Rebinding?",
        answers: [
            "Да, обходя проверку IP/Host, заставляя браузер считать внешний домен локальным ресурсом",
            "Нет, DNS кешируется",
            "Только если отключен JS",
            "Только в Firefox"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "75. Какой заголовок предотвращает загрузку сайта в iframe (защита от Clickjacking/CSRF UI)?",
        answers: [
            "X-Frame-Options",
            "Access-Control-Allow-Iframe",
            "Iframe-Security",
            "No-Frame"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "76. Работает ли `SameSite` cookie атрибут в старых браузерах?",
        answers: [
            "Работает везде",
            "Нет, старые браузеры игнорируют его. Поэтому это 'Defense in Depth', а не единственная защита",
            "Только в IE6",
            "Работает через полифил"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "77. Что такое 'Client-Side CSRF'?",
        answers: [
            "Атака, где JS код приложения сам формирует вредоносный запрос (например, берет параметры из URL и делает POST), позволяя атакующему 'зарядить' ссылку",
            "Атака на клиента",
            "Атака через CSS",
            "XSS"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "78. Как влияет заголовок `Access-Control-Max-Age: -1`?",
        answers: [
            "Кэширует навсегда",
            "Запрещает кэширование Pre-flight запроса (каждый раз будет OPTIONS)",
            "Ошибка синтаксиса",
            "Кэширует на 1 секунду"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "79. Где лучше хранить CSRF токен: LocalStorage или Cookie?",
        answers: [
            "LocalStorage безопаснее от CSRF (браузер сам не шлёт), но уязвим к XSS краже",
            "Cookie безопаснее",
            "В файле",
            "В URL"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "80. Что такое 'Authenticated CSRF'?",
        answers: [
            "Когда атакующий знает пароль",
            "Обычный CSRF, который эффективен только если пользователь аутентифицирован (имеет активную сессию)",
            "CSRF на странице логина",
            "Подделка аутентификации"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "81. Что такое 'Blind CSRF'?",
        answers: [
            "CSRF на сайт для слепых",
            "Когда атакующий не видит ответа сервера (из-за SOP), но действие выполняется (write-only attack)",
            "Атака вслепую (брутфорс)",
            "Скрытая атака"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "82. Можно ли использовать один CSRF токен на всю жизнь аккаунта?",
        answers: [
            "Да, это удобно",
            "Не рекомендуется. Лучше менять токен на каждую сессию (Per-Session) или даже каждый запрос (Per-Request), чтобы уменьшить окно атаки при утечке",
            "Нет, он должен жить 1 секунду",
            "Только для админов"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "83. Как 'UI Redressing' связан с CSRF?",
        answers: [
            "Это смена темы сайта",
            "Это Clickjacking - хакер перекрывает кнопку 'Удалить аккаунт' невидимым слоем (iframe) поверх безобидной кнопки, заставляя пользователя кликнуть 'самому' (CSRF руками пользователя)",
            "Это переодевание UI",
            "Это XSS"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "84. Нужно ли включать CSRF защиту для GET API endpoint, возвращающего данные?",
        answers: [
            "Да, всегда",
            "Нет, если GET не меняет состояние (safe method) и данные не конфиденциальны (или защищены SOP/CORS). CSRF токен обычно защищает от *действий*",
            "Только если возвращает JSON",
            "Только если возвращает XML"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "85. Как работает 'Referer spoofing'?",
        answers: [
            "Подмена заголовка Referer. Сложно в браузере, но возможно при переходе с HTTPS на HTTP (referer обрезается) или использовании специальных атрибутов <a>",
            "Это просто",
            "Это невозможно",
            "Это подмена IP"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "86. В чем опасность заголовка `Access-Control-Allow-Origin: *` для API с Basic Auth?",
        answers: [
            "Никакой",
            "С `*` браузер не разрешит отправить Credentials (Authorization header), так что Basic Auth не сработает в кросс-доменном запросе. Это скорее 'сломает' клиент, чем откроет дыру (если сервер следует спецификации)",
            "Это позволяет всем читать пароль",
            "Это отключает SSL"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "87. Что такое 'PortSwigger CSRF PoC Generator'?",
        answers: [
            "Генератор случайных чисел",
            "Инструмент в Burp Suite Pro, который автоматически создает HTML форму для эксплуатации найденной CSRF уязвимости",
            "Генератор паролей",
            "Сканер портов"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "88. Как 'Content-Type' влияет на Simple Requests?",
        answers: [
            "Не влияет",
            "Только `application/x-www-form-urlencoded`, `multipart/form-data` и `text/plain` считаются простыми. `application/json` вызывает Pre-flight",
            "Все типы простые",
            "Только картинки простые"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "89. Что делать, если фреймворк не поддерживает CSRF токены?",
        answers: [
            "Сменить фреймворк или реализовать middleware с Double Submit Cookie или Synchronizer Token паттерном",
            "Забить",
            "Использовать только GET",
            "Отключить куки"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "90. Зачем нужен `Access-Control-Allow-Credentials`?",
        answers: [
            "Чтобы разрешить передачу пароля в URL",
            "Чтобы разрешить браузеру включать куки и Authorization заголовки в кросс-доменные запросы (и читать ответ)",
            "Чтобы разрешить админку",
            "Это для ключей API"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "91. Какой код ответа возвращается при неудачном Pre-flight?",
        answers: [
            "200 OK",
            "Обычно 403 Forbidden или сервер просто не присылает нужные CORS заголовки, и браузер блокирует основной запрос (Network Error в консоли)",
            "404 Not Found",
            "500 Internal Error"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "92. Можно ли использовать CSRF для Logout жертвы?",
        answers: [
            "Да, это частый 'Annoyance' вектор. Заставляет жертву выйти, можно использовать для DoS или подготовки к фишингу",
            "Нет",
            "Только в Safari",
            "Только если нет пароля"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "93. Что такое 'Origin: file://'?",
        answers: [
            "Запрос с локального диска. Часто имеет привилегии `null` или особые права в старых браузерах",
            "Запрос файла",
            "Скачивание файла",
            "Ошибка браузера"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "94. Помогает ли JWT (JSON Web Token) от CSRF?",
        answers: [
            "Сам по себе нет (если хранится в куках). Да (если в LocalStorage + Authorization header)",
            "Да, всегда",
            "Нет, никогда",
            "JWT это не про безопасность"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "95. Что такое 'Strict-Origin-When-Cross-Origin'?",
        answers: [
            "Значение Referrer-Policy по умолчанию. Посылает полный URL при same-origin, только Origin (домен) при cross-origin (HTTPS->HTTPS), и ничего при HTTPS->HTTP",
            "Строгая политика CORS",
            "Запрет кросс-доменов",
            "Ошибка сервера"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "96. Можно ли комбинировать CSRF токен и SameSite Cookie?",
        answers: [
            "Да, это рекомендуемая 'Defense in Depth'. SameSite защищает от большинства атак, Токен - от байпасов SameSite и старых браузеров",
            "Нет, они конфликтуют",
            "Нет смысла",
            "Только в Linux"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "97. Как работает 'Form Action Hijacking'?",
        answers: [
            "Если атакующий может инжектить код в форму, он меняет `action` URL на свой сервер, перехватывая введенные пользователем данные (включая CSRF токен)",
            "Кража формы",
            "Удаление формы",
            "Закрытие формы"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "98. Что такое `Access-Control-Max-Age`?",
        answers: [
            "Максимальный возраст пользователя",
            "Время в секундах, на которое браузер может кешировать ответ Pre-flight (OPTIONS), чтобы не слать его каждый раз",
            "Время жизни куки",
            "Время сессии"
        ],
        correctAnswerIndex: 1
    },
    {
        question: "99. Чем опасен `Access-Control-Allow-Origin: *` для внутренней сети?",
        answers: [
            "Если внутренний ресурс доступен из браузера сотрудника и имеет `*`, любой внешний сайт может сканировать/читать данные внутренней сети через браузер жертвы",
            "Ничем",
            "Это ускоряет сеть",
            "Это стандарт интранета"
        ],
        correctAnswerIndex: 0
    },
    {
        question: "100. Можно ли защитить статический сайт от CSRF?",
        answers: [
            "Статические сайты обычно не имеют сессий и не меняют состояние, поэтому CSRF к ним неприменим",
            "Да, добавить токен",
            "Да, использовать HTTPS",
            "Нет"
        ],
        correctAnswerIndex: 0
    }
];
